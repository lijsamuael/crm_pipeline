import{P as U,cp as I,l as O,cA as Q,bC as ee,y as $,z as J,G as te,f as d,g as T,w as k,b as D,A as V,d as g,n as q,c as b,t as M,u as r,ad as R,B as L,S as A,T as P,L as E,bY as ae,bZ as se,r as G,F as K,b_ as le,K as W,M as X,b6 as re,b$ as oe,b7 as Z,X as ne,e as ue}from"./index-a094f868.js";const De=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function H(u,_){return U(`${u}-${_+1}-01`)}function Le(u,_,o){const s=H(u,_).startOf("week"),l=H(u,_).endOf("month").endOf("week"),c=[];let a=s;for(;a.isBefore(l)||a.isSame(l);){const m=a.month()===_,h=U(o);c.push({date:a,key:a.format("YYYY-MM-DD"),inMonth:m,isToday:a.isSame(I().format("YYYY-MM-DD"),"day"),isSelected:h.isValid()&&a.isSame(h,"day")}),a=a.add(1,"day")}const w=[];for(let m=0;m<c.length;m+=7)w.push(c.slice(m,m+7));return w}function Ye(u){return!u||u.toString()==="Invalid Date"?"":U(u).set("hour",0).set("minute",0).set("second",0).set("millisecond",0).format("YYYY-MM-DD")}const ie={class:"w-full"},de=["onClick"],ce={key:0,class:"flex text-base leading-5 items-center truncate"},fe={class:"truncate"},me={key:1,class:"absolute text-ink-gray-4 text-left truncate w-full pr-7"},pe={class:"relative mt-1 rounded-lg bg-surface-modal text-base shadow-2xl"},ye={class:"relative px-1.5 pt-1.5"},be={key:0,class:"truncate bg-surface-modal px-2.5 py-1.5 text-sm font-medium text-ink-gray-5"},ge={class:"flex-1 truncate text-ink-gray-7"},he={key:0,class:"my-1.5 rounded-md px-2.5 py-1.5 text-base text-ink-gray-5"},ve={key:0,class:"border-t border-outline-gray-modals p-1.5"},xe={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"sm"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},placement:{type:String,default:"bottom-start"}},emits:["update:modelValue","update:query","change"],setup(u,{expose:_,emit:o}){const s=u,l=o,c=O(""),a=O(!1),w=O(null),m=Q(),h=ee(),Y=$(()=>"value"in m),S=$({get(){return Y.value?m.value:s.modelValue},set(t){c.value="",t&&(a.value=!1),l(Y.value?"change":"update:modelValue",t)}});function j(){a.value=!1}const e=$(()=>{var n;return!s.options||s.options.length==0?[]:((n=s.options[0])!=null&&n.group?s.options:[{group:"",items:s.options}]).map((i,f)=>({key:f,group:i.group,hideLabel:i.hideLabel||!1,items:s.filterable?v(i.items):i.items})).filter(i=>i.items.length>0)});function v(t){return c.value?t.filter(n=>[n.label,n.value].some(f=>(f||"").toString().toLowerCase().includes(c.value.toLowerCase()))):t}function y(t){if(typeof t=="string"){let i=e.value.flatMap(f=>f.items).find(f=>f.value===t);return(i==null?void 0:i.label)||t}return t==null?void 0:t.label}J(c,t=>{l("update:query",t)}),J(a,t=>{t&&te(()=>{w.value.el.focus()})});const p=$(()=>s.disabled?"text-ink-gray-5":"text-ink-gray-8"),x=$(()=>{let t={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[s.size],n={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[s.size],i=s.disabled?"disabled":s.variant,f={subtle:"border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",outline:"border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",disabled:["border bg-surface-menu-bar placeholder-ink-gray-3",s.variant==="outline"?"border-outline-gray-2":"border-transparent"]}[i];return[t,n,f,p.value,"transition-colors w-full"]});return _({query:c}),(t,n)=>(d(),T(r(oe),{modelValue:S.value,"onUpdate:modelValue":n[3]||(n[3]=i=>S.value=i),nullable:""},{default:k(({open:i})=>[D(r(re),{class:"w-full",show:a.value,"onUpdate:show":n[2]||(n[2]=f=>a.value=f),placement:u.placement},{target:k(({open:f,togglePopover:z})=>[V(t.$slots,"target",A(P({open:f,togglePopover:z,isOpen:a.value,selectedValue:S.value,displayValue:y})),()=>[g("div",ie,[g("button",{class:q(["relative flex h-7 w-full items-center justify-between gap-2 rounded px-2 py-1 transition-colors",x.value]),onClick:()=>!u.disabled&&z()},[S.value?(d(),b("div",ce,[V(t.$slots,"prefix"),g("span",fe,M(y(S.value)),1)])):(d(),b("div",me,M(u.placeholder||""),1)),u.disabled?L("",!0):(d(),T(r(R),{key:2,name:"chevron-down",class:"absolute h-4 w-4 text-ink-gray-5 right-2","aria-hidden":"true"}))],10,de)])])]),body:k(({isOpen:f})=>{var z;return[E(g("div",null,[g("div",pe,[g("div",ye,[D(r(ae),{ref_key:"search",ref:w,class:"form-input w-full focus:bg-surface-gray-3 hover:bg-surface-gray-4 text-ink-gray-8",type:"text",onChange:n[0]||(n[0]=C=>{c.value=C.target.value}),value:c.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),g("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:n[1]||(n[1]=C=>S.value=null)},[D(r(R),{name:"x",class:"w-4 text-ink-gray-8"})])]),D(r(se),{class:"my-1 max-h-[12rem] overflow-y-auto p-1.5 pt-0",static:""},{default:k(()=>[(d(!0),b(K,null,G(e.value,C=>E((d(),b("div",{class:"mt-1.5",key:C.key},[C.group&&!C.hideLabel?(d(),b("div",be,M(C.group),1)):L("",!0),(d(!0),b(K,null,G(C.items,B=>(d(),T(r(le),{as:"template",key:B.value,value:B},{default:k(({active:N,selected:F})=>[g("li",{class:q(["flex cursor-pointer items-center rounded px-2.5 py-1.5 text-base",{"bg-surface-gray-3":N}])},[V(t.$slots,"item-prefix",W({ref_for:!0},{active:N,selected:F,option:B})),V(t.$slots,"item-label",W({ref_for:!0},{active:N,selected:F,option:B}),()=>[g("div",ge,M(B.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[X,C.items.length>0]])),128)),e.value.length==0?(d(),b("li",he," No results found ")):L("",!0)]),_:3}),r(h).footer?(d(),b("div",ve,[V(t.$slots,"footer",A(P({value:(z=w.value)==null?void 0:z.el._value,close:j})))])):L("",!0)])],512),[[X,f]])]}),_:3},8,["show","placement"])]),_:3},8,["modelValue"]))}},ke={class:"space-y-1.5 p-[2px] -m-[2px]"},_e={key:0,class:"flex flex-col gap-1"},we={class:"flex-1 font-semibold truncate text-ink-gray-7"},Ce={class:"flex-1 text-sm truncate text-ink-gray-5"},Ve={key:1,class:"flex-1 truncate text-ink-gray-7"},Se={key:0},$e={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:[Array,Object,String],default:[]},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(u,{emit:_}){const o=u,s=_,l=Q(),c=$(()=>"value"in l),a=$({get:()=>c.value?l.value:o.modelValue,set:e=>(e==null?void 0:e.value)&&s(c.value?"change":"update:modelValue",e==null?void 0:e.value)}),w=O(null),m=O("");Z(()=>{var e;return(e=w.value)==null?void 0:e.query},e=>{e=e||"",m.value!==e&&(m.value=e,Y(e))},{debounce:300,immediate:!0}),Z(()=>o.doctype,()=>Y(""),{debounce:300,immediate:!0});const h=ne({url:"frappe.desk.search.search_link",cache:[o.doctype,m.value,o.hideMe,o.filters],method:"POST",params:{txt:m.value,doctype:o.doctype,filters:o.filters},transform:e=>{let v=e.map(y=>({label:y.label||y.value,value:y.value,description:y.description}));return!o.hideMe&&o.doctype=="User"&&v.unshift({label:"@me",value:"@me"}),v}});function Y(e){var v,y,p;o.doctype&&((v=h.data)!=null&&v.length&&e===((y=h.params)==null?void 0:y.txt)&&o.doctype===((p=h.params)==null?void 0:p.doctype)||(h.update({params:{txt:e,doctype:o.doctype,filters:o.filters}}),h.reload()))}function S(e){s(c.value?"change":"update:modelValue",""),e()}const j=$(()=>[{sm:"text-xs",md:"text-base"}[l.size||"sm"],"text-ink-gray-5"]);return(e,v)=>{const y=ue("Button");return d(),b("div",ke,[r(l).label?(d(),b("label",{key:0,class:q(["block",j.value])},M(e.__(r(l).label)),3)):L("",!0),D(xe,{ref_key:"autocomplete",ref:w,options:r(h).data,modelValue:a.value,"onUpdate:modelValue":v[0]||(v[0]=p=>a.value=p),size:r(l).size||"sm",variant:r(l).variant,placeholder:r(l).placeholder,disabled:r(l).disabled,placement:r(l).placement,filterable:!1},{target:k(({open:p,togglePopover:x})=>[V(e.$slots,"target",A(P({open:p,togglePopover:x})))]),prefix:k(()=>[V(e.$slots,"prefix")]),"item-prefix":k(({active:p,selected:x,option:t})=>[V(e.$slots,"item-prefix",A(P({active:p,selected:x,option:t})))]),"item-label":k(({active:p,selected:x,option:t})=>[V(e.$slots,"item-label",A(P({active:p,selected:x,option:t})),()=>[t.description?(d(),b("div",_e,[g("div",we,M(t.label),1),g("div",Ce,M(t.description),1)])):(d(),b("div",Ve,M(t.label),1))])]),footer:k(({value:p,close:x})=>[r(l).onCreate?(d(),b("div",Se,[D(y,{variant:"ghost",class:"w-full !justify-start",label:e.__("Create New"),iconLeft:"plus",onClick:()=>r(l).onCreate(p,x)},null,8,["label","onClick"])])):L("",!0),g("div",null,[D(y,{variant:"ghost",class:"w-full !justify-start",label:e.__("Clear"),iconLeft:"x",onClick:()=>S(x)},null,8,["label","onClick"])])]),_:3},8,["options","modelValue","size","variant","placeholder","disabled","placement"])])}}},ze=$e;export{ze as L,xe as _,H as a,Ye as b,Le as g,De as m};
//# sourceMappingURL=Link-3cfde2ee.js.map
