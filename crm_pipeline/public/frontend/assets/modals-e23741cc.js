import{l as I,a as q,v as pe,bo as $,j as K,a2 as ee,bs as Pe,bq as he,y as k,bm as H,I as le,z as ge,bj as Q,bt as De,F as ne,bi as me,aD as be,k as Y,bQ as ce,bI as J,bu as T,by as Z,bH as Ae,bv as Oe,bw as z,bx as R,G as oe,f as S,g as M,w as D,c as A,r as ye,u as P,A as O,K as G,d as B,n as F,a6 as Te,B as j,aB as xe,t as re,N as Re,O as Ee,b as L,S as te,T as ae,e as we,L as _e,M as Ie,bB as Me,a3 as Be,a4 as Fe,a5 as Le,aS as Ne,Y as je,aM as fe,a1 as de,V as Ve,cA as ze,aN as qe,m as Se,aP as Ke,aR as N,c1 as Ge,aQ as He,aL as Ue,X as We}from"./index-a094f868.js";import{g as Ce}from"./global-c1d3e1d5.js";import{b as se,P as Qe,Q as Ye}from"./index-2d68a6a0.js";import{s as Xe,a as Ze}from"./DragVerticalIcon-12e66a71.js";function ve(e,a){if(e)return e;let u=a??"button";if(typeof u=="string"&&u.toLowerCase()==="button")return"button"}function Je(e,a){let u=I(ve(e.value.type,e.value.as));return q(()=>{u.value=ve(e.value.type,e.value.as)}),pe(()=>{var d;u.value||$(a)&&$(a)instanceof HTMLButtonElement&&!((d=$(a))!=null&&d.hasAttribute("type"))&&(u.value="button")}),u}let et=K({props:{onFocus:{type:Function,required:!0}},setup(e){let a=I(!0);return()=>a.value?ee(he,{as:"button",type:"button",features:Pe.Focusable,onFocus(u){u.preventDefault();let d,h=50;function i(){var v;if(h--<=0){d&&cancelAnimationFrame(d);return}if((v=e.onFocus)!=null&&v.call(e)){a.value=!1,cancelAnimationFrame(d);return}d=requestAnimationFrame(i)}d=requestAnimationFrame(i)}}):null}});var tt=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(tt||{}),at=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(at||{});let $e=Symbol("TabsContext");function X(e){let a=Y($e,null);if(a===null){let u=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(u,X),u}return a}let ue=Symbol("TabsSSRContext"),nt=K({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:a,attrs:u,emit:d}){var h;let i=I((h=e.selectedIndex)!=null?h:e.defaultIndex),v=I([]),c=I([]),b=k(()=>e.selectedIndex!==null),_=k(()=>b.value?e.selectedIndex:i.value);function m(s){var p;let l=H(n.tabs.value,$),t=H(n.panels.value,$),o=l.filter(r=>{var f;return!((f=$(r))!=null&&f.hasAttribute("disabled"))});if(s<0||s>l.length-1){let r=J(i.value===null?0:Math.sign(s-i.value),{[-1]:()=>1,0:()=>J(Math.sign(s),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),f=J(r,{0:()=>l.indexOf(o[0]),1:()=>l.indexOf(o[o.length-1])});f!==-1&&(i.value=f),n.tabs.value=l,n.panels.value=t}else{let r=l.slice(0,s),f=[...l.slice(s),...r].find(C=>o.includes(C));if(!f)return;let w=(p=l.indexOf(f))!=null?p:n.selectedIndex.value;w===-1&&(w=n.selectedIndex.value),i.value=w,n.tabs.value=l,n.panels.value=t}}let n={selectedIndex:k(()=>{var s,p;return(p=(s=i.value)!=null?s:e.defaultIndex)!=null?p:null}),orientation:k(()=>e.vertical?"vertical":"horizontal"),activation:k(()=>e.manual?"manual":"auto"),tabs:v,panels:c,setSelectedIndex(s){_.value!==s&&d("change",s),b.value||m(s)},registerTab(s){var p;if(v.value.includes(s))return;let l=v.value[i.value];if(v.value.push(s),v.value=H(v.value,$),!b.value){let t=(p=v.value.indexOf(l))!=null?p:i.value;t!==-1&&(i.value=t)}},unregisterTab(s){let p=v.value.indexOf(s);p!==-1&&v.value.splice(p,1)},registerPanel(s){c.value.includes(s)||(c.value.push(s),c.value=H(c.value,$))},unregisterPanel(s){let p=c.value.indexOf(s);p!==-1&&c.value.splice(p,1)}};le($e,n);let g=I({tabs:[],panels:[]}),y=I(!1);q(()=>{y.value=!0}),le(ue,k(()=>y.value?null:g.value));let x=k(()=>e.selectedIndex);return q(()=>{ge([x],()=>{var s;return m((s=e.selectedIndex)!=null?s:e.defaultIndex)},{immediate:!0})}),pe(()=>{if(!b.value||_.value==null||n.tabs.value.length<=0)return;let s=H(n.tabs.value,$);s.some((p,l)=>$(n.tabs.value[l])!==$(p))&&n.setSelectedIndex(s.findIndex(p=>$(p)===$(n.tabs.value[_.value])))}),()=>{let s={selectedIndex:i.value};return ee(ne,[v.value.length<=0&&ee(et,{onFocus:()=>{for(let p of v.value){let l=$(p);if((l==null?void 0:l.tabIndex)===0)return l.focus(),!0}return!1}}),Q({theirProps:{...u,...De(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:s,slots:a,attrs:u,name:"TabGroup"})])}}}),rt=K({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:a,slots:u}){let d=X("TabList");return()=>{let h={selectedIndex:d.selectedIndex.value},i={role:"tablist","aria-orientation":d.orientation.value};return Q({ourProps:i,theirProps:e,slot:h,attrs:a,slots:u,name:"TabList"})}}}),st=K({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(e,{attrs:a,slots:u,expose:d}){var h;let i=(h=e.id)!=null?h:`headlessui-tabs-tab-${me()}`,v=X("Tab"),c=I(null);d({el:c,$el:c}),q(()=>v.registerTab(c)),be(()=>v.unregisterTab(c));let b=Y(ue),_=k(()=>{if(b.value){let t=b.value.tabs.indexOf(i);return t===-1?b.value.tabs.push(i)-1:t}return-1}),m=k(()=>{let t=v.tabs.value.indexOf(c);return t===-1?_.value:t}),n=k(()=>m.value===v.selectedIndex.value);function g(t){var o;let r=t();if(r===Z.Success&&v.activation.value==="auto"){let f=(o=Oe(c))==null?void 0:o.activeElement,w=v.tabs.value.findIndex(C=>$(C)===f);w!==-1&&v.setSelectedIndex(w)}return r}function y(t){let o=v.tabs.value.map(r=>$(r)).filter(Boolean);if(t.key===T.Space||t.key===T.Enter){t.preventDefault(),t.stopPropagation(),v.setSelectedIndex(m.value);return}switch(t.key){case T.Home:case T.PageUp:return t.preventDefault(),t.stopPropagation(),g(()=>z(o,R.First));case T.End:case T.PageDown:return t.preventDefault(),t.stopPropagation(),g(()=>z(o,R.Last))}if(g(()=>J(v.orientation.value,{vertical(){return t.key===T.ArrowUp?z(o,R.Previous|R.WrapAround):t.key===T.ArrowDown?z(o,R.Next|R.WrapAround):Z.Error},horizontal(){return t.key===T.ArrowLeft?z(o,R.Previous|R.WrapAround):t.key===T.ArrowRight?z(o,R.Next|R.WrapAround):Z.Error}}))===Z.Success)return t.preventDefault()}let x=I(!1);function s(){var t;x.value||(x.value=!0,!e.disabled&&((t=$(c))==null||t.focus({preventScroll:!0}),v.setSelectedIndex(m.value),Ae(()=>{x.value=!1})))}function p(t){t.preventDefault()}let l=Je(k(()=>({as:e.as,type:a.type})),c);return()=>{var t,o;let r={selected:n.value,disabled:(t=e.disabled)!=null?t:!1},{...f}=e,w={ref:c,onKeydown:y,onMousedown:p,onClick:s,id:i,role:"tab",type:l.value,"aria-controls":(o=$(v.panels.value[m.value]))==null?void 0:o.id,"aria-selected":n.value,tabIndex:n.value?0:-1,disabled:e.disabled?!0:void 0};return Q({ourProps:w,theirProps:f,slot:r,attrs:a,slots:u,name:"Tab"})}}}),lt=K({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:a,attrs:u}){let d=X("TabPanels");return()=>{let h={selectedIndex:d.selectedIndex.value};return Q({theirProps:e,ourProps:{},slot:h,attrs:u,slots:a,name:"TabPanels"})}}}),ot=K({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(e,{attrs:a,slots:u,expose:d}){var h;let i=(h=e.id)!=null?h:`headlessui-tabs-panel-${me()}`,v=X("TabPanel"),c=I(null);d({el:c,$el:c}),q(()=>v.registerPanel(c)),be(()=>v.unregisterPanel(c));let b=Y(ue),_=k(()=>{if(b.value){let g=b.value.panels.indexOf(i);return g===-1?b.value.panels.push(i)-1:g}return-1}),m=k(()=>{let g=v.panels.value.indexOf(c);return g===-1?_.value:g}),n=k(()=>m.value===v.selectedIndex.value);return()=>{var g;let y={selected:n.value},{tabIndex:x,...s}=e,p={ref:c,id:i,role:"tabpanel","aria-labelledby":(g=$(v.tabs.value[m.value]))==null?void 0:g.id,tabIndex:n.value?x:-1};return!n.value&&e.unmount&&!e.static?ee(he,{as:"span","aria-hidden":!0,...p}):Q({ourProps:p,theirProps:s,slot:y,attrs:a,slots:u,features:ce.Static|ce.RenderStrategy,visible:n.value,name:"TabPanel"})}}});const ut={__name:"TabList",setup(e){const a=Y("tab"),u=I([]),d=I(null),h=k(()=>{var c;return(c=a.value.tabs.value)==null?void 0:c.length}),i=I("");function v(c){c>=h.value&&(c=h.value-1);const b=u.value[c].el;a.value.vertical.value?(d.value.style.height=`${b.offsetHeight}px`,d.value.style.top=`${b.offsetTop}px`):(d.value.style.width=`${b.offsetWidth}px`,d.value.style.left=`${b.offsetLeft}px`)}return ge(()=>a.value.tabIndex.value,c=>{c>=h.value&&(a.value.tabIndex.value=h.value-1),i.value="transition-all duration-300 ease-in-out",oe(()=>v(c))}),q(()=>{oe(()=>v(a.value.tabIndex.value)),setTimeout(()=>v(a.value.tabIndex.value),100)}),(c,b)=>(S(),M(P(rt),{class:F(["relative flex",P(a).vertical?"flex-col border-r overflow-y-auto":"gap-7.5 border-b overflow-x-auto items-center px-5"])},{default:D(()=>[(S(!0),A(ne,null,ye(P(a).tabs,(_,m)=>(S(),M(P(st),{ref_for:!0,ref_key:"tabRef",ref:u,as:"template",key:m,class:"focus:outline-none focus:transition-none"},{default:D(({selected:n})=>[O(c.$slots,"default",G({ref_for:!0},{tab:_,selected:n}),()=>[B("button",{class:F(["flex items-center gap-1.5 text-base text-ink-gray-5 duration-300 ease-in-out hover:text-ink-gray-9",[n?"text-ink-gray-9":"",P(a).vertical?"py-2.5 px-4 border-r border-transparent hover:border-outline-gray-3":"py-3 border-b border-transparent hover:border-outline-gray-3"]])},[_.icon?(S(),M(Te(_.icon),{key:0,class:"size-4"})):j("",!0),xe(" "+re(_.label),1)],2)])]),_:2},1024))),128)),B("div",{ref_key:"indicator",ref:d,class:F(["tab-indicator absolute bg-surface-gray-7",[P(a).vertical?"right-0 w-px":"bottom-0 h-px",i.value]])},null,2)]),_:3},8,["class"]))}},it={__name:"TabPanel",setup(e){const a=Y("tab");return(u,d)=>(S(),M(P(lt),{class:"flex flex-1 overflow-hidden"},{default:D(()=>[(S(!0),A(ne,null,ye(P(a).tabs,(h,i)=>(S(),M(P(ot),{class:"flex flex-1 flex-col overflow-y-auto focus:outline-none",key:i},{default:D(()=>[O(u.$slots,"default",G({ref_for:!0},{tab:h}))]),_:2},1024))),128))]),_:3}))}},It={__name:"Tabs",props:Re({as:{type:String,default:"template"},tabs:{type:Array,required:!0},vertical:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const a=e,u=Ee(e,"modelValue");return le("tab",k(()=>({tabIndex:u,tabs:a.tabs,vertical:a.vertical}))),(d,h)=>(S(),M(P(nt),G(e.as!=="template"?{as:e.as,class:["flex flex-1 overflow-hidden",e.vertical?"":"flex-col "]}:{},{defaultIndex:u.value,selectedIndex:u.value,onChange:h[0]||(h[0]=i=>u.value=i)}),{default:D(()=>[O(d.$slots,"default",{},()=>[L(ut,null,{default:D(({tab:i,selected:v})=>[O(d.$slots,"tab-item",te(ae({tab:i,selected:v})))]),_:3}),L(it,null,{default:D(({tab:i})=>[O(d.$slots,"tab-panel",te(ae({tab:i})))]),_:3})])]),_:3},16,["defaultIndex","selectedIndex"]))}},ct={inheritAttrs:!1},St=Object.assign(ct,{__name:"Section",props:{label:{type:String,default:""},hideLabel:{type:Boolean,default:!1},opened:{type:Boolean,default:!0},collapsible:{type:Boolean,default:!0},collapseIconPosition:{type:String,default:"left"},labelClass:{type:[String,Object,Array],default:""},headerClass:{type:[String,Object,Array],default:""}},setup(e){const a=e,u=I(a.hideLabel),d=I(a.opened);function h(){d.value=!d.value}function i(){d.value=!0}function v(){d.value=!1}return(c,b)=>{const _=we("FeatherIcon");return S(),A("div",null,[O(c.$slots,"header",te(ae({opened:d.value,hide:u.value,open:i,close:v,toggle:h})),()=>[u.value?j("",!0):(S(),A("div",{key:0,class:F(["section-header flex items-center justify-between",e.headerClass])},[B("div",{class:F(["flex text-ink-gray-9 max-w-fit cursor-pointer items-center gap-2 text-base",e.labelClass]),onClick:b[0]||(b[0]=m=>e.collapsible&&h())},[e.collapsible&&e.collapseIconPosition==="left"?(S(),M(_,{key:0,name:"chevron-right",class:F(["h-4 transition-all duration-300 ease-in-out",{"rotate-90":d.value}])},null,8,["class"])):j("",!0),B("span",null,re(c.__(e.label)||c.__("Untitled")),1),e.collapsible&&e.collapseIconPosition==="right"?(S(),M(_,{key:1,name:"chevron-right",class:F(["h-4 transition-all duration-300 ease-in-out",{"rotate-90":d.value}])},null,8,["class"])):j("",!0)],2),O(c.$slots,"actions")],2))]),L(Me,{"enter-active-class":"duration-300 ease-in","leave-active-class":"duration-300 ease-[cubic-bezier(0, 1, 0.5, 1)]","enter-to-class":"max-h-[200px] overflow-hidden","leave-from-class":"max-h-[200px] overflow-hidden","enter-from-class":"max-h-0 overflow-hidden","leave-to-class":"max-h-0 overflow-hidden"},{default:D(()=>[_e(B("div",G({class:"columns"},c.$attrs),[O(c.$slots,"default",te(ae({opened:d.value,open:i,close:v,toggle:h})))],16),[[Ie,d.value]])]),_:3})])}}}),ft={key:0},dt={key:1},vt={key:1},pt={key:2},ht={__name:"KeyboardShortcut",props:{meta:Boolean,ctrl:Boolean,shift:Boolean,alt:Boolean,shortcut:String,bg:Boolean},setup(e){const a=navigator.userAgent.includes("Mac");return(u,d)=>(S(),A("div",{class:F(["inline-flex items-center gap-0.5 text-sm",{"bg-surface-gray-2 rounded-sm text-ink-gray-5 py-0.5 px-1":e.bg,"text-ink-gray-4":!e.bg}])},[e.ctrl||e.meta?(S(),A("span",ft,[P(a)?(S(),M(P(Be),{key:0,class:"w-3 h-3"})):(S(),A("span",dt,"Ctrl"))])):j("",!0),e.shift?(S(),A("span",vt,[L(P(Fe),{class:"w-3 h-3"})])):j("",!0),e.alt?(S(),A("span",pt,[L(P(Le),{class:"w-3 h-3"})])):j("",!0),O(u.$slots,"default")],2))}},gt={class:"rounded bg-surface-gray-7 py-1.5 px-2 text-xs text-ink-white shadow-xl"},mt={class:"flex items-center gap-1"},Ct={__name:"Password",props:{modelValue:{type:[String,Number],default:""},value:{type:[String,Number],default:""}},setup(e){const a=e,u=I(!1),d=k(()=>{let h=a.modelValue||a.value;return!(h!=null&&h.includes("*"))});return(h,i)=>{const v=we("FeatherIcon");return S(),M(P(Ve),G({type:u.value?"text":"password",value:e.modelValue||e.value},h.$attrs,{onKeydown:[i[1]||(i[1]=fe(de(c=>u.value=!u.value,["meta","prevent"]),["i"])),i[2]||(i[2]=fe(de(c=>u.value=!u.value,["ctrl","prevent"]),["i"]))]}),Ne({suffix:D(()=>[L(P(je),null,{body:D(()=>[B("div",gt,[B("span",mt,[xe(re(u.value?h.__("Hide Password"):h.__("Show Password"))+" ",1),L(ht,{bg:"",ctrl:"",class:"!bg-surface-gray-5 !text-ink-gray-2 px-1"},{default:D(()=>[...i[3]||(i[3]=[B("span",{class:"font-mono leading-none tracking-widest"},"+I",-1)])]),_:1})])])]),default:D(()=>[B("div",null,[_e(L(v,{name:u.value?"eye-off":"eye",class:"h-3 cursor-pointer mr-1",onClick:i[0]||(i[0]=c=>u.value=!u.value)},null,8,["name"]),[[Ie,d.value]])])]),_:1})]),_:2},[h.$slots.prefix?{name:"prefix",fn:D(()=>[O(h.$slots,"prefix")]),key:"0"}:void 0]),1040,["type","value"])}}},$t={__name:"FormattedInput",props:{value:{type:[String,Number],default:""},formattedValue:{type:[String,Number],default:""}},setup(e){const a=e,u=ze(),d=I(!1),h=I(null);function i(){d.value=!0,oe(()=>{var b;h.value&&((b=h.value.el)==null||b.select())})}const v=k(()=>d.value?a.value:a.formattedValue||a.value),c=k(()=>[{sm:"text-xs",md:"text-base"}[u.size||"sm"],"text-ink-gray-5"]);return(b,_)=>(S(),A(ne,null,[L(P(qe),G({ref_key:"inputRef",ref:h,value:v.value,onFocus:i,onBlur:_[0]||(_[0]=m=>d.value=!1)},b.$attrs),null,16,["value"]),O(b.$slots,"description",{},()=>[P(u).description?(S(),A("p",{key:0,class:F(["mt-1.5",c.value])},re(P(u).description),3)):j("",!0)])],64))}},U=Se({});function bt(e,a="Form"){const u=Ke({doctype:"CRM Form Script",cache:["Form Scripts",e,a],fields:["name","dt","view","script"],filters:{view:a,dt:e,enabled:1},onSuccess:m=>{for(let n of m)U[e]||(U[e]={}),U[e][n.name]=n||{}},onError:m=>{console.error(`Error loading CRM Form Scripts for ${e} (view: ${a}):`,m)}});!U[e]&&!u.loading&&u.fetch();async function d(m,n={}){await u.list.promise;let g=U[e];if(!g||Object.keys(g).length===0)return null;const{$dialog:y,$socket:x}=Ce();return n.createDialog=y,n.toast=N,n.socket=x,n.router=Ge,n.call=He,n.throwError=s=>{throw N.error(s||__("An error occurred")),new Error(s||__("An error occurred"))},h(g,m,n)}function h(m,n,g){var s;const y=[];let x=null;for(let p in m){let l=(s=m[p])==null?void 0:s.script;if(l)try{const t=c(l);if(!t)continue;t.forEach(o=>{const r=b(l,o,g);if(!r)return;let f=null,w=e.replace(/\s+/g,""),{doctypeMeta:C}=se(e),ie=o!==w;if(ie){if(!y.length){console.error(__("⚠️ No class found for doctype: {0}, it is mandatory to have a class for the parent doctype. it can be empty, but it should be present.",[e]));return}f=y[x]}else x=y.length||0;const ke=i(r,C,n,f,ie);y.push(ke)})}catch(t){console.error(__("Failed to load form controller: {0}",[t]))}}return y}function i(m,n,g,y=null,x=!1){g.actions=g.actions||[],g.statuses=g.statuses||[];let s=new m;s._originalDocumentContext=g,s._isChildDoctype=x;for(const l in g)g.hasOwnProperty(l)&&(s[l]=g[l]);s.getMeta=async l=>(n[l]||await se(l),n[l]);const p=()=>g.doc;return x?(s.doc=_(p,y,s),y._childInstances||(y._childInstances=[]),y._childInstances.push(s)):s.doc=_(p,s),s}function v(m){typeof m.prototype.getRow!="function"&&(m.prototype.getRow=function(n,g){var s,p;g=g||this.currentRowIdx;let y=null;if(this instanceof Array){const{getFields:l}=se(this.doc.doctype);let o=l().find(r=>r.fieldname===n);y=(s=o==null?void 0:o.options)==null?void 0:s.replace(/\s+/g,""),!g&&y&&(g=(p=this.find(r=>r.constructor.name===y))==null?void 0:p.currentRowIdx)}if(!this.doc[n])return console.warn(__("⚠️ No data found for parent field: {0}",[n])),null;const x=this.doc[n].find(l=>l.idx===g);return x?(x.parent=x.parent||this.doc.name,this instanceof Array&&y?_(x,this.find(l=>l.constructor.name===y)):_(x,this)):(console.warn(__("⚠️ No row found for idx: {0} in parent field: {1}",[g,n])),null)}),Object.prototype.hasOwnProperty.call(m.prototype,"actions")||Object.defineProperty(m.prototype,"actions",{configurable:!0,enumerable:!0,get(){return this._originalDocumentContext?this._originalDocumentContext.actions:(console.warn("CRM Script: _originalDocumentContext not found on instance for actions getter."),[])},set(n){if(!this._originalDocumentContext){console.warn("CRM Script: _originalDocumentContext not found on instance for actions setter.");return}if(!Array.isArray(n)){console.warn('CRM Script: "actions" property must be an array. Value was not set.',n),this._originalDocumentContext.actions=[];return}this._originalDocumentContext.actions=n}}),Object.prototype.hasOwnProperty.call(m.prototype,"statuses")||Object.defineProperty(m.prototype,"statuses",{configurable:!0,enumerable:!0,get(){return this._originalDocumentContext?this._originalDocumentContext.statuses:(console.warn("CRM Script: _originalDocumentContext not found on instance for statuses getter."),[])},set(n){if(!this._originalDocumentContext){console.warn("CRM Script: _originalDocumentContext not found on instance for statuses setter.");return}if(!Array.isArray(n)){console.warn('CRM Script: "statuses" property must be an array. Value was not set.',n),this._originalDocumentContext.statuses=[];return}this._originalDocumentContext.statuses=n}})}function c(m){return[...m.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").matchAll(/class\s+([A-Za-z0-9_]+)/g)].map(g=>g[1])||[]}function b(m,n,g={}){const y=Object.keys(g),x=Object.values(g),s=`
		${m}
		return ${n};
	`,p=new Function(...y,s)(...x);return v(p),p}function _(m,n,g=null){const y=typeof m=="function",x=()=>y?m():m;return new Proxy({},{get(s,p){const l=x();if(l)return p==="trigger"?(l&&"trigger"in l&&console.warn(__('⚠️ Avoid using "trigger" as a field name — it conflicts with the built-in trigger() method.')),(t,...o)=>{const r=n[t];if(typeof r=="function")return r.apply(n,o);console.warn(__('⚠️ Method "{0}" not found in class.',[t]))}):p==="getRow"?n.getRow.bind(g||n._childInstances||n):l[p]},set(s,p,l){const t=x();return t?(t[p]=l,!0):!1},has(s,p){const l=x();return l?p in l:!1},ownKeys(s){const p=x();return p?Reflect.ownKeys(p):[]},getOwnPropertyDescriptor(s,p){const l=x();if(l)return Reflect.getOwnPropertyDescriptor(l,p)}})}return{scripts:u,setupScript:d,setupFormController:i}}const E={},V={},W={};function kt(e,a){const{setupScript:u,scripts:d}=bt(e);E[e]=E[e]||{};const h=I("");E[e][a||""]||(a?E[e][a]=Ue({doctype:e,name:a,onSuccess:async()=>await i(),onError:t=>{h.value=t,t.exc_type==="DoesNotExistError"&&N.error(__(t.messages[0]||"Document does not exist")),t.exc_type==="PermissionError"&&N.error(__(t.messages[0]||"You do not have permission to access this document"))},setValue:{onSuccess:()=>{_(),N.success(__("Document updated successfully"))},onError:t=>{var o,r;if(m(),t.exc_type=="MandatoryError"){const f=t.messages.map(w=>{let C=w.split(": ");return C[C.length-1].trim()}).join(", ");N.error(__("Mandatory field error: {0}",[f]));return}(o=t.messages)==null||o.forEach(f=>{N.error(f)}),((r=t.messages)==null?void 0:r.length)===0&&N.error(__("An error occurred while updating the document")),console.error(t)}}}):(E[e][""]=Se({doc:{}}),i())),W[e]=W[e]||{},W[e][a||""]||(W[e][a||""]=We({url:"crm.api.doc.get_assigned_users",cache:`assignees:${e}:${a}`,auto:!!a,params:{doctype:e,name:a},transform:t=>Qe(t)}));async function i(){if(V[e]&&typeof V[e][a||""]=="object")return;V[e]||(V[e]={}),V[e][a||""]={};const{makeCall:t}=Ce();let o={};o.crm={makePhoneCall:t,openSettings:w=>{Xe.value=!0,Ze.value=w}};const r=await u(E[e][a||""],o);if(!r||r.length===0)return;const f={};for(const w of r){const C=w.constructor.name;f[C]||(f[C]=[]),f[C].push(w)}V[e][a||""]=f,c()}function v(t=null){var w;const r=((t==null?void 0:t.doctype)||e).replace(/\s+/g,""),f=(w=V[e])==null?void 0:w[a||""];return typeof f=="object"&&f!==null&&!Array.isArray(f)?f[r]||[]:[]}async function c(){await l(async function(){var o,r,f;await(((o=this.onLoad)==null?void 0:o.call(this))||((r=this.on_load)==null?void 0:r.call(this))||((f=this.onload)==null?void 0:f.call(this)))})}async function b(){const t=Array.from(arguments);await l(async function(){var r,f;await(((r=this.onBeforeCreate)==null?void 0:r.call(this,...t))||((f=this.on_before_create)==null?void 0:f.call(this,...t)))})}async function _(){await l(async function(){var o,r;await(((o=this.onSave)==null?void 0:o.call(this))||((r=this.on_save)==null?void 0:r.call(this)))})}async function m(){await l(async function(){var o,r;await(((o=this.onError)==null?void 0:o.call(this))||((r=this.on_error)==null?void 0:r.call(this)))})}async function n(){await l(async function(){var o;await((o=this.refresh)==null?void 0:o.call(this))})}async function g(t,o,r){let f=null;r?(f=r[t],r[t]=o):(f=E[e][a||""].doc[t],E[e][a||""].doc[t]=o);const w=async function(){var C;this.value=o,this.oldValue=f,r&&(this.currentRowIdx=r.idx),await((C=this[t])==null?void 0:C.call(this))};try{await l(w,r)}catch(C){throw r?r[t]=f:E[e][a||""].doc[t]=f,console.error(w),C}}async function y(t){await l(async function(){var r;this.currentRowIdx=t.idx,this.value=t,await((r=this[t.parentfield+"_add"])==null?void 0:r.call(this))},t)}async function x(t,o){await l(async function(){var f;if(t.size===1){const w=Array.from(t)[0];this.currentRowIdx=o.find(C=>C.name===w).idx}else delete this.currentRowIdx;this.selectedRows=Array.from(t),this.rows=o,await((f=this[o[0].parentfield+"_remove"])==null?void 0:f.call(this))},o[0])}async function s(){const t=Array.from(arguments);await l(async function(){var r,f;await(((r=this.onCreateLead)==null?void 0:r.call(this,...t))||((f=this.on_create_lead)==null?void 0:f.call(this,...t)))})}async function p(){const t=Array.from(arguments);await l(async function(){var r,f;await(((r=this.convertToDeal)==null?void 0:r.call(this,...t))||((f=this.convert_to_deal)==null?void 0:f.call(this,...t)))})}async function l(t,o=null){const r=v(o);if(!r.length)return;const f=r.map(w=>async()=>await t.call(w));await Ye(f)}return{document:E[e][a||""],assignees:W[e][a||""],scripts:d,error:h,getControllers:v,triggerOnLoad:c,triggerOnBeforeCreate:b,triggerOnSave:_,triggerOnError:m,triggerOnRefresh:n,triggerOnChange:g,triggerOnRowAdd:y,triggerOnRowRemove:x,setupFormScript:i,triggerOnCreateLead:s,triggerConvertToDeal:p}}const Pt=I(!1),Dt=I({}),At=I(!1),Ot=I({}),Tt=I(!1),Rt=I(!1);export{It as _,Ot as a,St as b,Pt as c,ut as d,it as e,$t as f,Ct as g,Rt as h,Tt as i,Dt as q,At as s,kt as u};
//# sourceMappingURL=modals-e23741cc.js.map
