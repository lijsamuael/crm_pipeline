import{N as $,O as K,y as b,e as q,f as i,c as r,g as y,w as u,d as n,b as s,n as M,u as c,F as V,r as R,b6 as G,t as k,a6 as H,K as j,A as x,S as z,T as A,B as g,a1 as J}from"./index-a094f868.js";import{_ as Q}from"./Link-3cfde2ee.js";import{I as E}from"./IndicatorIcon-466bb833.js";import{A as F,B as U,D as W,C as L}from"./index-2d68a6a0.js";import{D as S}from"./DragVerticalIcon-12e66a71.js";const X={class:"flex overflow-x-auto h-full"},Y={key:0,class:"flex flex-col gap-2.5 min-w-72 w-72 hover:bg-surface-gray-2 rounded-lg p-2.5"},Z={class:"flex gap-2 items-center group justify-between"},ee={class:"flex items-center text-base"},te={class:"flex flex-col gap-3 px-3 py-2.5 min-w-40 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},le={class:"flex gap-1"},oe={class:"flex flex-row-reverse"},ae={class:"text-ink-gray-9"},ne={class:"flex"},se={class:"overflow-y-auto flex flex-col gap-2 h-full"},ie={class:"h-5 flex items-center"},re={key:0},ue={key:1,class:"text-ink-gray-4"},ce={class:"flex flex-col gap-3.5"},me={key:0,class:"truncate"},de={class:"flex gap-2 items-center justify-between"},pe={key:0,class:"flex items-center justify-center"},fe={key:1,class:"shrink-0 min-w-64"},be={__name:"KanbanView",props:$({options:{type:Object,default:()=>({getRoute:null,onClick:null,onNewClick:null})}},{modelValue:{},modelModifiers:{}}),emits:$(["update","loadMore"],["update:modelValue"]),setup(m,{emit:I}){const C=I,_=K(m,"modelValue"),h=b(()=>{var e,l;return(l=(e=_.value)==null?void 0:e.data)==null?void 0:l.title_field}),p=b(()=>{var l,a;return!((a=(l=_.value)==null?void 0:l.data)!=null&&a.data)||_.value.data.view_type!="kanban"?[]:_.value.data.data}),w=b(()=>p.value.filter(e=>e.column.delete).map(e=>({label:e.column.name,value:e.column.name})));function O(e){return[{group:__("Options"),hideLabel:!0,items:[{label:__("Delete"),icon:"trash-2",onClick:()=>{e.column.delete=!0,f()}}]}]}function P(e){let l=p.value.find(a=>a.column.name==e.value);l.column.delete=!1,f()}function f(e){var N,B,D;let l=(N=e==null?void 0:e.to)==null?void 0:N.dataset.column,a=(B=e==null?void 0:e.from)==null?void 0:B.dataset.column,o=(D=e==null?void 0:e.item)==null?void 0:D.dataset.name,t=[];p.value.forEach(v=>{v.column.order=v.data.map(T=>T.name),v.column.page_length&&delete v.column.page_length,t.push(v.column)});let d={kanban_columns:t};l!=a&&(d={item:o,to:l,kanban_columns:t}),C("update",d)}return(e,l)=>{const a=q("Button");return i(),r("div",X,[p.value?(i(),y(c(S),{key:0,list:p.value,"item-key":"column",onEnd:f,delay:c(L)()?200:0,class:"flex sm:mx-2.5 mx-2 pb-3.5"},{item:u(({element:o})=>[o.column.delete?g("",!0):(i(),r("div",Y,[n("div",Z,[n("div",ee,[s(c(G),null,{target:u(({togglePopover:t})=>[s(a,{variant:"ghost",size:"sm",class:"hover:!bg-surface-gray-2",onClick:t},{default:u(()=>[s(E,{class:M(c(F)(o.column.color))},null,8,["class"])]),_:2},1032,["onClick"])]),body:u(()=>[n("div",te,[n("div",le,[(i(!0),r(V,null,R(c(U),t=>(i(),y(a,{variant:"ghost",key:t,onClick:()=>o.column.color=t},{default:u(()=>[s(E,{class:M(c(F)(t))},null,8,["class"])]),_:2},1032,["onClick"]))),128))]),n("div",oe,[s(a,{variant:"solid",label:e.__("Apply"),onClick:f},null,8,["label"])])])]),_:2},1024),n("div",ae,k(o.column.name),1)]),n("div",ne,[s(c(W),{options:O(o)},{default:u(()=>[s(a,{class:"opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition-opacity",icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"]),s(a,{icon:"plus",variant:"ghost",onClick:t=>m.options.onNewClick(o)},null,8,["onClick"])])]),n("div",se,[s(c(S),{list:o.data,group:"fields","item-key":"name",class:"flex flex-col gap-3.5 flex-1",onEnd:f,delay:c(L)()?200:0,"data-column":o.column.name},{item:u(({element:t})=>[(i(),y(H(m.options.getRoute?"router-link":"div"),j({class:"pt-3 px-3.5 pb-2.5 rounded-lg border bg-surface-white text-base flex flex-col text-ink-gray-9","data-name":t.name},{to:m.options.getRoute?m.options.getRoute(t):void 0,onClick:m.options.onClick?()=>m.options.onClick(t):void 0}),{default:u(()=>[x(e.$slots,"title",z(A({fields:t,titleField:h.value,itemName:t.name})),()=>[n("div",ie,[t[h.value]?(i(),r("div",re,k(t[h.value]),1)):(i(),r("div",ue,k(e.__("No Title")),1))])]),l[3]||(l[3]=n("div",{class:"border-b h-px my-2.5"},null,-1)),n("div",ce,[(i(!0),r(V,null,R(o.fields,d=>x(e.$slots,"fields",j({key:d,ref_for:!0},{fields:t,fieldName:d,itemName:t.name}),()=>[t[d]?(i(),r("div",me,k(t[d]),1)):g("",!0)])),128))]),l[4]||(l[4]=n("div",{class:"border-b h-px mt-2.5 mb-2"},null,-1)),x(e.$slots,"actions",z(A({itemName:t.name})),()=>[n("div",de,[l[2]||(l[2]=n("div",null,null,-1)),s(a,{icon:"plus",variant:"ghost",onClick:l[0]||(l[0]=J(()=>{},["stop","prevent"]))})])])]),_:2},1040,["data-name"]))]),_:2},1032,["list","delay","data-column"]),o.column.count<o.column.all_count?(i(),r("div",pe,[s(a,{label:e.__("Load More"),onClick:t=>C("loadMore",o.column.name)},null,8,["label","onClick"])])):g("",!0)])]))]),_:3},8,["list","delay"])):g("",!0),w.value.length?(i(),r("div",fe,[s(Q,{value:"",options:w.value,onChange:l[1]||(l[1]=o=>P(o))},{target:u(({togglePopover:o})=>[s(a,{class:"w-full mt-2.5 mb-1 mr-5",label:e.__("Add Column"),iconLeft:"plus",onClick:t=>o()},null,8,["label","onClick"])]),_:1},8,["options"])])):g("",!0)])}}};export{be as _};
//# sourceMappingURL=KanbanView-02bf94c0.js.map
