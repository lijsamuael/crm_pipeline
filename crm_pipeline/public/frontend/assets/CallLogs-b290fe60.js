import{_ as W}from"./ViewBreadcrumbs-f07dae54.js";import{_ as I}from"./CustomActions-d3cf25f1.js";import{P as T}from"./PhoneIcon-70b3a745.js";import{L as E}from"./LayoutHeader-027ebcdc.js";import{_ as H}from"./ViewControls-c5479b53.js";import{N as D,O as R,y as x,a0 as O,z as j,l as c,e as h,f as u,c as p,b as n,w as m,u as v,F as B,r as q,g as L,n as N,B as _,Y as J,d as A,t as z,a1 as K,K as X,a as Y,X as G}from"./index-a094f868.js";import{H as S,_ as Q}from"./ListBulkActions-d30e952b.js";import{_ as Z,a as ee,b as le,c as oe,d as te,e as ae}from"./DeleteLinkedDocModal-25cd8320.js";import{a as se,D as ne}from"./index-2d68a6a0.js";import{_ as ie}from"./ListFooter-8058fa68.js";import{g as ue,C as re,_ as de}from"./CallLogModal-447b1e6f.js";import"./Icon-5431cc70.js";import"./DragVerticalIcon-12e66a71.js";import"./EditIcon-d7d50f24.js";import"./Link-3cfde2ee.js";import"./FadedScrollableDiv-0eedb39b.js";import"./IconPicker-1152affd.js";import"./PinIcon-5c436e1e.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-8c23e9ea.js";import"./DetailsIcon-848d2598.js";import"./settings-6524f74f.js";import"./global-c1d3e1d5.js";import"./pageMeta-ccf84976.js";import"./TextEditor.vue_vue_type_script_setup_true_lang-e2f7307d.js";import"./TabButtons-66363a13.js";import"./description-ce5058e0.js";import"./ArrowUpRightIcon-9ddf39c9.js";import"./ContactsIcon-ef708308.js";import"./LeadsIcon-bb4322a7.js";import"./DealsIcon-4613d91f.js";import"./CalendarIcon-230645ec.js";import"./NoteModal-848b61de.js";import"./helpCenter-6244f2ec.js";import"./TaskIcon-78f92ad5.js";import"./TaskModal-03afb2a1.js";import"./modals-e23741cc.js";import"./FieldLayout-9e608d31.js";import"./IndicatorIcon-466bb833.js";const me={key:0},pe={key:1},ce=["onClick"],fe={key:1,class:"truncate text-base"},ve={key:2},ge={key:3},Ce=["onClick"],ke={__name:"CallLogsListView",props:D({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:D(["showCallLog","loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(r,{expose:V,emit:g}){const o=g,k=R(r,"modelValue"),y=R(r,"list"),b=x(()=>{var a,s;return!!((s=(a=y.value.params)==null?void 0:a.filters)!=null&&s._liked_by)}),{user:f}=O();function M(a){if(a)return JSON.parse(a).includes(f)}j(k,(a,s)=>{a!==s&&o("updatePageCount",a)});const w=c(null);return V({customListActions:x(()=>{var a;return(a=w.value)==null?void 0:a.customListActions})}),(a,s)=>{const U=h("Button"),F=h("FeatherIcon"),d=h("Badge"),l=h("FormControl");return u(),p(B,null,[n(v(ae),X({columns:r.columns,rows:r.rows,options:{onRowClick:t=>o("showCallLog",t.name),selectable:r.options.selectable,showTooltip:r.options.showTooltip,resizeColumn:r.options.resizeColumn},"row-key":"name"},a.$attrs,{"onUpdate:selections":s[2]||(s[2]=t=>o("selectionsChanged",t))}),{default:m(()=>[n(v(Z),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:s[1]||(s[1]=t=>o("columnWidthUpdated"))},{default:m(()=>[(u(!0),p(B,null,q(r.columns,t=>(u(),L(v(ee),{key:t.key,item:t,onColumnWidthUpdated:e=>o("columnWidthUpdated",t)},{default:m(()=>[t.key=="_liked_by"?(u(),L(U,{key:0,variant:"ghosted",class:N(["!h-4",b.value?"fill-red-500":"fill-white"]),onClick:s[0]||(s[0]=()=>o("applyLikeFilter"))},{default:m(()=>[n(S,{class:"h-4 w-4"})]),_:1},8,["class"])):_("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),n(le,{class:"mx-3 sm:mx-5",rows:r.rows,doctype:"CRM Call Log"},{default:m(({idx:t,column:e,item:i})=>[n(v(oe),{item:i,align:e.align},{prefix:m(()=>[["caller","receiver"].includes(e.key)?(u(),p("div",me,[i.label?(u(),L(v(se),{key:0,class:"flex items-center",image:i.image,label:i.label,size:"sm"},null,8,["image","label"])):_("",!0)])):["type","duration"].includes(e.key)?(u(),p("div",pe,[n(F,{name:i.icon,class:"h-3 w-3"},null,8,["name"])])):_("",!0)]),default:m(({label:$})=>[["modified","creation"].includes(e.key)?(u(),p("div",{key:0,class:"truncate text-base",onClick:C=>o("applyFilter",{event:C,idx:t,column:e,item:i,firstColumn:r.columns[0]})},[n(v(J),{text:i.label},{default:m(()=>[A("div",null,z(i.timeAgo),1)]),_:2},1032,["text"])],8,ce)):e.key==="status"?(u(),p("div",fe,[n(d,{variant:"subtle",theme:i.color,size:"md",label:a.__(i.label),onClick:C=>o("applyFilter",{event:C,idx:t,column:e,item:i,firstColumn:r.columns[0]})},null,8,["theme","label","onClick"])])):e.type==="Check"?(u(),p("div",ve,[n(l,{type:"checkbox",modelValue:i,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):e.key==="_liked_by"?(u(),p("div",ge,[e.key=="_liked_by"?(u(),L(U,{key:0,variant:"ghosted",class:N(M(i)?"fill-red-500":"fill-white"),onClick:K(()=>o("likeDoc",{name:a.row.name,liked:M(i)}),["stop","prevent"])},{default:m(()=>[n(S,{class:"h-4 w-4"})]),_:1},8,["class","onClick"])):_("",!0)])):(u(),p("div",{key:4,class:"truncate text-base",onClick:C=>o("applyFilter",{event:C,idx:t,column:e,item:i,firstColumn:r.columns[0]})},z($),9,Ce))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),n(v(te),null,{actions:m(({selections:t,unselectAll:e})=>[n(v(ne),{options:w.value.bulkActions(t,e)},{default:m(()=>[n(U,{icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"])]),_:1})]),_:1},16,["columns","rows","options"]),n(v(ie),{class:"border-t sm:px-5 px-3 py-2",modelValue:k.value,"onUpdate:modelValue":s[3]||(s[3]=t=>k.value=t),options:{rowCount:r.options.rowCount,totalCount:r.options.totalCount},onLoadMore:s[4]||(s[4]=t=>o("loadMore"))},null,8,["modelValue","options"]),n(Q,{ref_key:"listBulkActionsRef",ref:w,modelValue:y.value,"onUpdate:modelValue":s[5]||(s[5]=t=>y.value=t),doctype:"CRM Call Log",options:{hideEdit:!0,hideAssign:!0}},null,8,["modelValue"])],64)}}},ye={key:1,class:"flex h-full items-center justify-center"},we={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},sl={__name:"CallLogs",setup(r){const V=c(null),g=c(!1),o=c({}),k=c(1),y=c(1),b=c(20),f=c(null),M=x(()=>{var d,l,t;return!((l=(d=o.value)==null?void 0:d.data)!=null&&l.data)||!["list","group_by"].includes(o.value.data.view_type)?[]:(t=o.value)==null?void 0:t.data.data.map(e=>{var $;let i={};return($=o.value)==null||$.data.rows.forEach(C=>{var P;i[C]=ue(C,e,(P=o.value)==null?void 0:P.data.columns)}),i})}),w=c(!1),a=c({});function s(d){w.value=!0,a.value=G({url:"crm.fcrm.doctype.crm_call_log.crm_call_log.get_call_log",params:{name:d},cache:["call_log",d],auto:!0})}function U(){a.value={},g.value=!0}const F=()=>{const d=new URLSearchParams(window.location.search),l=d.get("open");l&&(s(l),d.delete("open"),window.history.replaceState(null,"",window.location.pathname))};return Y(()=>{F()}),(d,l)=>{const t=h("Button");return u(),p(B,null,[n(E,null,{"left-header":m(()=>[n(W,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),routeName:"Call Logs"},null,8,["modelValue"])]),"right-header":m(()=>{var e;return[(e=V.value)!=null&&e.customListActions?(u(),L(I,{key:0,actions:V.value.customListActions},null,8,["actions"])):_("",!0),n(t,{variant:"solid",label:d.__("Create"),iconLeft:"plus",onClick:U},null,8,["label"])]}),_:1}),n(H,{ref_key:"viewControls",ref:f,modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value=e),loadMore:k.value,"onUpdate:loadMore":l[2]||(l[2]=e=>k.value=e),resizeColumn:y.value,"onUpdate:resizeColumn":l[3]||(l[3]=e=>y.value=e),updatedPageCount:b.value,"onUpdate:updatedPageCount":l[4]||(l[4]=e=>b.value=e),doctype:"CRM Call Log"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),o.value.data&&M.value.length?(u(),L(ke,{key:0,ref_key:"callLogsListView",ref:V,modelValue:o.value.data.page_length_count,"onUpdate:modelValue":l[5]||(l[5]=e=>o.value.data.page_length_count=e),list:o.value,"onUpdate:list":l[6]||(l[6]=e=>o.value=e),rows:M.value,columns:o.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:o.value.data.row_count,totalCount:o.value.data.total_count},onShowCallLog:s,onLoadMore:l[7]||(l[7]=()=>k.value++),onColumnWidthUpdated:l[8]||(l[8]=()=>y.value++),onUpdatePageCount:l[9]||(l[9]=e=>b.value=e),onApplyFilter:l[10]||(l[10]=e=>f.value.applyFilter(e)),onApplyLikeFilter:l[11]||(l[11]=e=>f.value.applyLikeFilter(e)),onLikeDoc:l[12]||(l[12]=e=>f.value.likeDoc(e)),onSelectionsChanged:l[13]||(l[13]=e=>f.value.updateSelections(e))},null,8,["modelValue","list","rows","columns","options"])):o.value.data?(u(),p("div",ye,[A("div",we,[n(T,{class:"h-10 w-10"}),A("span",null,z(d.__("No {0} Found",[d.__("Logs")])),1)])])):_("",!0),n(re,{modelValue:w.value,"onUpdate:modelValue":l[14]||(l[14]=e=>w.value=e),callLogModal:g.value,"onUpdate:callLogModal":l[15]||(l[15]=e=>g.value=e),callLog:a.value,"onUpdate:callLog":l[16]||(l[16]=e=>a.value=e)},null,8,["modelValue","callLogModal","callLog"]),g.value?(u(),L(de,{key:2,modelValue:g.value,"onUpdate:modelValue":l[17]||(l[17]=e=>g.value=e),data:a.value.data,options:{afterInsert:()=>o.value.reload()}},null,8,["modelValue","data","options"])):_("",!0)],64)}}};export{sl as default};
//# sourceMappingURL=CallLogs-b290fe60.js.map
