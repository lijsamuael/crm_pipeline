import{N as M,O as q,y as b,e as G,f as r,c as u,g as y,w as c,d as n,b as s,n as V,u as m,F as E,r as R,b5 as H,t as k,a6 as J,K as j,A as x,S as z,T as A,B as g,a1 as Q}from"./index-c721fff4.js";import{_ as U}from"./Link-65fe6c07.js";import{I as F}from"./IndicatorIcon-41e40190.js";import{A as C,B as L,D as W,C as S}from"./index-d994a7bf.js";import{D as I}from"./DragVerticalIcon-79b45f6b.js";const X={class:"flex overflow-x-auto h-full"},Y={key:0,class:"flex flex-col gap-2.5 min-w-72 w-72 hover:bg-surface-gray-2 rounded-lg p-2.5"},Z={class:"flex gap-2 items-center group justify-between"},ee={class:"flex items-center text-base"},te={class:"flex flex-col gap-3 px-3 py-2.5 min-w-40 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},oe={class:"flex gap-1"},le={class:"flex flex-row-reverse"},ae={class:"text-ink-gray-9"},ne={class:"flex"},se={class:"overflow-y-auto flex flex-col gap-2 h-full"},ie={class:"h-5 flex items-center"},re={key:0},ue={key:1,class:"text-ink-gray-4"},ce={class:"flex flex-col gap-3.5"},me={key:0,class:"truncate"},de={class:"flex gap-2 items-center justify-between"},fe={key:0,class:"flex items-center justify-center"},pe={key:1,class:"shrink-0 min-w-64"},be={__name:"KanbanView",props:M({options:{type:Object,default:()=>({getRoute:null,onClick:null,onNewClick:null})}},{modelValue:{},modelModifiers:{}}),emits:M(["update","loadMore"],["update:modelValue"]),setup(d,{emit:O}){const w=O,_=q(d,"modelValue"),h=b(()=>{var e,l;return(l=(e=_.value)==null?void 0:e.data)==null?void 0:l.title_field}),f=b(()=>{var a,o;if(!((o=(a=_.value)==null?void 0:a.data)!=null&&o.data)||_.value.data.view_type!="kanban")return[];let e=_.value.data.data;return e.some(t=>{var i;return(i=t.column)==null?void 0:i.color})||e.forEach((t,i)=>{t.column.color=C[i%C.length]}),e}),N=b(()=>f.value.filter(e=>e.column.delete).map(e=>({label:e.column.name,value:e.column.name})));function P(e){return[{group:__("Options"),hideLabel:!0,items:[{label:__("Delete"),icon:"trash-2",onClick:()=>{e.column.delete=!0,p()}}]}]}function T(e){let l=f.value.find(a=>a.column.name==e.value);l.column.delete=!1,p()}function p(e){var B,D,$;let l=(B=e==null?void 0:e.to)==null?void 0:B.dataset.column,a=(D=e==null?void 0:e.from)==null?void 0:D.dataset.column,o=($=e==null?void 0:e.item)==null?void 0:$.dataset.name,t=[];f.value.forEach(v=>{v.column.order=v.data.map(K=>K.name),v.column.page_length&&delete v.column.page_length,t.push(v.column)});let i={kanban_columns:t};l!=a&&(i={item:o,to:l,kanban_columns:t}),w("update",i)}return(e,l)=>{const a=G("Button");return r(),u("div",X,[f.value?(r(),y(m(I),{key:0,list:f.value,"item-key":"column",onEnd:p,delay:m(S)()?200:0,class:"flex sm:mx-2.5 mx-2 pb-3.5"},{item:c(({element:o})=>[o.column.delete?g("",!0):(r(),u("div",Y,[n("div",Z,[n("div",ee,[s(m(H),null,{target:c(({togglePopover:t})=>[s(a,{variant:"ghost",size:"sm",class:"hover:!bg-surface-gray-2",onClick:t},{default:c(()=>[s(F,{class:V(m(L)(o.column.color))},null,8,["class"])]),_:2},1032,["onClick"])]),body:c(()=>[n("div",te,[n("div",oe,[(r(!0),u(E,null,R(m(C),t=>(r(),y(a,{variant:"ghost",key:t,onClick:()=>o.column.color=t},{default:c(()=>[s(F,{class:V(m(L)(t))},null,8,["class"])]),_:2},1032,["onClick"]))),128))]),n("div",le,[s(a,{variant:"solid",label:e.__("Apply"),onClick:p},null,8,["label"])])])]),_:2},1024),n("div",ae,k(o.column.name),1)]),n("div",ne,[s(m(W),{options:P(o)},{default:c(()=>[s(a,{class:"opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition-opacity",icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"]),s(a,{icon:"plus",variant:"ghost",onClick:t=>d.options.onNewClick(o)},null,8,["onClick"])])]),n("div",se,[s(m(I),{list:o.data,group:"fields","item-key":"name",class:"flex flex-col gap-3.5 flex-1",onEnd:p,delay:m(S)()?200:0,"data-column":o.column.name},{item:c(({element:t})=>[(r(),y(J(d.options.getRoute?"router-link":"div"),j({class:"pt-3 px-3.5 pb-2.5 rounded-lg border bg-surface-white text-base flex flex-col text-ink-gray-9","data-name":t.name},{to:d.options.getRoute?d.options.getRoute(t):void 0,onClick:d.options.onClick?()=>d.options.onClick(t):void 0}),{default:c(()=>[x(e.$slots,"title",z(A({fields:t,titleField:h.value,itemName:t.name})),()=>[n("div",ie,[t[h.value]?(r(),u("div",re,k(t[h.value]),1)):(r(),u("div",ue,k(e.__("No Title")),1))])]),l[3]||(l[3]=n("div",{class:"border-b h-px my-2.5"},null,-1)),n("div",ce,[(r(!0),u(E,null,R(o.fields,i=>x(e.$slots,"fields",j({key:i,ref_for:!0},{fields:t,fieldName:i,itemName:t.name}),()=>[t[i]?(r(),u("div",me,k(t[i]),1)):g("",!0)])),128))]),l[4]||(l[4]=n("div",{class:"border-b h-px mt-2.5 mb-2"},null,-1)),x(e.$slots,"actions",z(A({itemName:t.name})),()=>[n("div",de,[l[2]||(l[2]=n("div",null,null,-1)),s(a,{icon:"plus",variant:"ghost",onClick:l[0]||(l[0]=Q(()=>{},["stop","prevent"]))})])])]),_:2},1040,["data-name"]))]),_:2},1032,["list","delay","data-column"]),o.column.count<o.column.all_count?(r(),u("div",fe,[s(a,{label:e.__("Load More"),onClick:t=>w("loadMore",o.column.name)},null,8,["label","onClick"])])):g("",!0)])]))]),_:3},8,["list","delay"])):g("",!0),N.value.length?(r(),u("div",pe,[s(U,{value:"",options:N.value,onChange:l[1]||(l[1]=o=>T(o))},{target:c(({togglePopover:o})=>[s(a,{class:"w-full mt-2.5 mb-1 mr-5",label:e.__("Add Column"),iconLeft:"plus",onClick:t=>o()},null,8,["label","onClick"])]),_:1},8,["options"])])):g("",!0)])}}};export{be as _};
//# sourceMappingURL=KanbanView-448a2492.js.map
