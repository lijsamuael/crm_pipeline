{"version":3,"file":"MobileNotification-c9b437e3.js","sources":["../../../../frontend/src/pages/MobileNotification.vue"],"sourcesContent":["<template>\n  <LayoutHeader>\n    <template #left-header>\n      <Breadcrumbs\n        :items=\"[\n          { label: __('Notifications'), route: { name: 'Notifications' } },\n        ]\"\n      />\n    </template>\n    <template #right-header>\n      <Button\n        :tooltip=\"__('Mark all as read')\"\n        :label=\"__('Mark all as read')\"\n        :iconLeft=\"MarkAsDoneIcon\"\n        @click=\"() => mark_as_read.reload()\"\n      />\n    </template>\n  </LayoutHeader>\n  <div class=\"flex flex-col overflow-hidden text-ink-gray-9\">\n    <div\n      v-if=\"notifications.data?.length\"\n      class=\"divide-y divide-outline-gray-1 overflow-y-auto text-base\"\n    >\n      <RouterLink\n        v-for=\"n in notifications.data\"\n        :key=\"n.comment\"\n        :to=\"getRoute(n)\"\n        class=\"flex cursor-pointer items-start gap-3 px-2.5 py-3 hover:bg-surface-gray-2\"\n        @click=\"mark_doc_as_read(n.comment || n.notification_type_doc)\"\n      >\n        <div class=\"mt-1 flex items-center gap-2.5\">\n          <div\n            class=\"size-[5px] rounded-full\"\n            :class=\"[n.read ? 'bg-transparent' : 'bg-surface-gray-7']\"\n          />\n          <WhatsAppIcon v-if=\"n.type == 'WhatsApp'\" class=\"size-7\" />\n          <UserAvatar v-else :user=\"n.from_user.name\" size=\"lg\" />\n        </div>\n        <div>\n          <div v-if=\"n.notification_text\" v-html=\"n.notification_text\" />\n          <div v-else class=\"mb-2 space-x-1 leading-5 text-ink-gray-5\">\n            <span class=\"font-medium text-ink-gray-9\">\n              {{ n.from_user.full_name }}\n            </span>\n            <span>\n              {{ __('mentioned you in {0}', [n.reference_doctype]) }}\n            </span>\n            <span class=\"font-medium text-ink-gray-9\">\n              {{ n.reference_name }}\n            </span>\n          </div>\n          <div class=\"text-sm text-ink-gray-5\">\n            {{ __(timeAgo(n.creation)) }}\n          </div>\n        </div>\n      </RouterLink>\n    </div>\n    <div v-else class=\"flex flex-1 flex-col items-center justify-center gap-2\">\n      <NotificationsIcon class=\"h-20 w-20 text-ink-gray-2\" />\n      <div class=\"text-lg font-medium text-ink-gray-4\">\n        {{ __('No new notifications') }}\n      </div>\n    </div>\n  </div>\n</template>\n<script setup>\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport WhatsAppIcon from '@/components/Icons/WhatsAppIcon.vue'\nimport MarkAsDoneIcon from '@/components/Icons/MarkAsDoneIcon.vue'\nimport NotificationsIcon from '@/components/Icons/NotificationsIcon.vue'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { notifications, notificationsStore } from '@/stores/notifications'\nimport { globalStore } from '@/stores/global'\nimport { timeAgo } from '@/utils'\nimport { Breadcrumbs, Tooltip } from 'frappe-ui'\nimport { onMounted, onBeforeUnmount } from 'vue'\n\nconst { $socket } = globalStore()\nconst { mark_as_read, mark_doc_as_read } = notificationsStore()\n\nonBeforeUnmount(() => {\n  $socket.off('crm_notification')\n})\n\nonMounted(() => {\n  $socket.on('crm_notification', () => {\n    notifications.reload()\n  })\n})\n\nfunction getRoute(notification) {\n  let params = {\n    leadId: notification.reference_name,\n  }\n  if (notification.route_name === 'Deal') {\n    params = {\n      dealId: notification.reference_name,\n    }\n  }\n  return {\n    name: notification.route_name,\n    params: params,\n    hash: '#' + notification.comment || notification.notification_type_doc,\n  }\n}\n</script>\n"],"names":["$socket","globalStore","mark_as_read","mark_doc_as_read","notificationsStore","onBeforeUnmount","onMounted","notifications","getRoute","notification","params","_createVNode","LayoutHeader","_unref","Breadcrumbs","__","_component_Button","MarkAsDoneIcon","_cache","_createElementVNode","_hoisted_1","_openBlock","_createElementBlock","_hoisted_2","_Fragment","_renderList","n","_createBlock","_component_RouterLink","$event","_hoisted_3","_normalizeClass","WhatsAppIcon","UserAvatar","_hoisted_5","_hoisted_6","_toDisplayString","_hoisted_7","_hoisted_8","timeAgo","_hoisted_9","NotificationsIcon","_hoisted_10"],"mappings":"4gCA6EA,KAAM,CAAE,QAAAA,CAAS,EAAGC,EAAY,EAC1B,CAAE,aAAAC,EAAc,iBAAAC,CAAkB,EAAGC,EAAmB,EAE9DC,EAAgB,IAAM,CACpBL,EAAQ,IAAI,kBAAkB,CAChC,CAAC,EAEDM,EAAU,IAAM,CACdN,EAAQ,GAAG,mBAAoB,IAAM,CACnCO,EAAc,OAAO,CACzB,CAAG,CACH,CAAC,EAED,SAASC,EAASC,EAAc,CAC9B,IAAIC,EAAS,CACX,OAAQD,EAAa,cACvB,EACA,OAAIA,EAAa,aAAe,SAC9BC,EAAS,CACP,OAAQD,EAAa,cACvB,GAEK,CACL,KAAMA,EAAa,WACnB,OAAQC,EACR,KAAM,IAAMD,EAAa,SAAWA,EAAa,qBACnD,CACF,gFAvGEE,EAgBeC,EAAA,KAAA,CAfF,gBACT,IAIE,CAJFD,EAIEE,EAAAC,CAAA,EAAA,CAHC,MAAK,QAAuBC,EAAE,GAAA,eAAA,EAAA,MAAA,CAAA,KAAA,gBAAA,wBAKxB,iBACT,IAKE,CALFJ,EAKEK,EAAA,CAJC,QAASD,EAAE,GAAA,kBAAA,EACX,MAAOA,EAAE,GAAA,kBAAA,EACT,SAAUE,EACV,QAAKC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,IAAQL,EAAYX,CAAA,EAAC,+CAIjCiB,EA6CM,MA7CNC,EA6CM,EA3CIP,EAAAA,EAAaN,CAAA,EAAC,OAAdM,MAAAA,EAAoB,QAD5BQ,IAAAC,EAqCM,MArCNC,EAqCM,EAjCJF,EAAA,EAAA,EAAAC,EAgCaE,EA/BC,KAAAC,EAAAZ,EAAAN,CAAA,EAAc,KAAnBmB,QADTC,EAgCaC,EAAA,CA9BV,IAAKF,EAAE,QACP,GAAIlB,EAASkB,CAAC,EACf,MAAM,4EACL,QAAKG,GAAEhB,KAAiBa,EAAE,SAAWA,EAAE,qBAAqB,cAE7D,IAOM,CAPNP,EAOM,MAPNW,EAOM,CANJX,EAGE,MAAA,CAFA,MAAMY,EAAA,CAAA,0BACG,CAAAL,EAAE,KAAI,iBAAA,mBAAA,CAAA,CAAA,WAEGA,EAAE,MAAI,gBAA1BC,EAA2DK,EAAA,OAAjB,MAAM,iBAChDL,EAAwDM,EAAA,OAApC,KAAMP,EAAE,UAAU,KAAM,KAAK,0BAEnDP,EAgBM,MAAA,KAAA,CAfOO,EAAE,uBAAbJ,EAA+D,MAAA,OAA/B,UAAQI,EAAE,+BAC1CL,IAAAC,EAUM,MAVNY,EAUM,CATJf,EAEO,OAFPgB,EAEOC,EADFV,EAAE,UAAU,SAAS,EAAA,CAAA,EAE1BP,EAEO,OADFJ,KAAAA,EAAAA,EAAAA,GAA4B,uBAAA,CAAAW,EAAE,iBAAiB,CAAA,CAAA,EAAA,CAAA,EAEpDP,EAEO,OAFPkB,EACKD,EAAAV,EAAE,cAAc,EAAA,CAAA,KAGvBP,EAEM,MAFNmB,EACKvB,EAAAA,EAAAA,GAAGF,EAAO0B,CAAA,EAACb,EAAE,QAAQ,CAAA,CAAA,EAAA,CAAA,8CAKhCL,IAAAC,EAKM,MALNkB,EAKM,CAJJ7B,EAAuD8B,EAAA,CAApC,MAAM,2BAA2B,CAAA,EACpDtB,EAEM,MAFNuB,EAEMN,EADDrB,EAAE,GAAA,sBAAA,CAAA,EAAA,CAAA"}