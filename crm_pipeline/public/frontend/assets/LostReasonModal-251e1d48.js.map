{"version":3,"file":"LostReasonModal-251e1d48.js","sources":["../../../../frontend/src/components/Modals/LostReasonModal.vue"],"sourcesContent":["<template>\n  <Dialog\n    v-model=\"show\"\n    :options=\"{ title: __('Lost reason') }\"\n    @close=\"cancel\"\n  >\n    <template #body-content>\n      <div class=\"-mt-3 mb-4 text-p-base text-ink-gray-7\">\n        {{ __('Please provide a reason for marking this deal as lost') }}\n      </div>\n      <div class=\"flex flex-col gap-3\">\n        <div>\n          <div class=\"mb-2 text-sm text-ink-gray-5\">\n            {{ __('Lost reason') }}\n            <span class=\"text-ink-red-2\">*</span>\n          </div>\n          <Link\n            class=\"form-control flex-1 truncate\"\n            :value=\"lostReason\"\n            doctype=\"CRM Lost Reason\"\n            @change=\"(v) => (lostReason = v)\"\n            :onCreate=\"onCreate\"\n          />\n        </div>\n        <div>\n          <div class=\"mb-2 text-sm text-ink-gray-5\">\n            {{ __('Lost notes') }}\n            <span v-if=\"lostReason == 'Other'\" class=\"text-ink-red-2\">*</span>\n          </div>\n          <FormControl\n            class=\"form-control flex-1 truncate\"\n            type=\"textarea\"\n            :value=\"lostNotes\"\n            @change=\"(e) => (lostNotes = e.target.value)\"\n          />\n        </div>\n      </div>\n    </template>\n    <template #actions>\n      <div class=\"flex justify-between items-center gap-2\">\n        <div><ErrorMessage :message=\"error\" /></div>\n        <div class=\"flex gap-2\">\n          <Button :label=\"__('Cancel')\" @click=\"cancel\" />\n          <Button variant=\"solid\" :label=\"__('Save')\" @click=\"save\" />\n        </div>\n      </div>\n    </template>\n  </Dialog>\n</template>\n<script setup>\nimport Link from '@/components/Controls/Link.vue'\nimport { createDocument } from '@/composables/document'\nimport { Dialog } from 'frappe-ui'\nimport { ref } from 'vue'\n\nconst props = defineProps({\n  deal: {\n    type: Object,\n    required: true,\n  },\n})\n\nconst show = defineModel()\n\nconst lostReason = ref(props.deal.doc.lost_reason || '')\nconst lostNotes = ref(props.deal.doc.lost_notes || '')\nconst error = ref('')\n\nfunction cancel() {\n  show.value = false\n  error.value = ''\n  lostReason.value = ''\n  lostNotes.value = ''\n  props.deal.doc.status = props.deal.originalDoc.status\n}\n\nfunction save() {\n  if (!lostReason.value) {\n    error.value = __('Lost reason is required')\n    return\n  }\n  if (lostReason.value === 'Other' && !lostNotes.value) {\n    error.value = __('Lost notes are required when lost reason is \"Other\"')\n    return\n  }\n\n  error.value = ''\n  show.value = false\n\n  props.deal.doc.lost_reason = lostReason.value\n  props.deal.doc.lost_notes = lostNotes.value\n  props.deal.save.submit()\n}\n\nfunction onCreate(value, close) {\n  createDocument('CRM Lost Reason', value, close)\n}\n</script>\n"],"names":["props","__props","show","_useModel","lostReason","ref","lostNotes","error","cancel","save","onCreate","value","close","createDocument","_createBlock","_unref","Dialog","$event","__","_createElementVNode","_hoisted_1","_toDisplayString","_hoisted_2","_hoisted_3","_cache","_createVNode","Link","v","_hoisted_4","_createElementBlock","_hoisted_5","_component_FormControl","e","_hoisted_6","_component_ErrorMessage","_hoisted_7","_component_Button"],"mappings":"0nBAuDA,MAAMA,EAAQC,EAORC,EAAOC,EAAYF,EAAA,YAAA,EAEnBG,EAAaC,EAAIL,EAAM,KAAK,IAAI,aAAe,EAAE,EACjDM,EAAYD,EAAIL,EAAM,KAAK,IAAI,YAAc,EAAE,EAC/CO,EAAQF,EAAI,EAAE,EAEpB,SAASG,GAAS,CAChBN,EAAK,MAAQ,GACbK,EAAM,MAAQ,GACdH,EAAW,MAAQ,GACnBE,EAAU,MAAQ,GAClBN,EAAM,KAAK,IAAI,OAASA,EAAM,KAAK,YAAY,MACjD,CAEA,SAASS,GAAO,CACd,GAAI,CAACL,EAAW,MAAO,CACrBG,EAAM,MAAQ,GAAG,yBAAyB,EAC1C,MACF,CACA,GAAIH,EAAW,QAAU,SAAW,CAACE,EAAU,MAAO,CACpDC,EAAM,MAAQ,GAAG,qDAAqD,EACtE,MACF,CAEAA,EAAM,MAAQ,GACdL,EAAK,MAAQ,GAEbF,EAAM,KAAK,IAAI,YAAcI,EAAW,MACxCJ,EAAM,KAAK,IAAI,WAAaM,EAAU,MACtCN,EAAM,KAAK,KAAK,OAAO,CACzB,CAEA,SAASU,EAASC,EAAOC,EAAO,CAC9BC,EAAe,kBAAmBF,EAAOC,CAAK,CAChD,qFA/FEE,EA8CSC,EAAAC,CAAA,EAAA,YA7CEd,EAAI,2CAAJA,EAAI,MAAAe,GACZ,eAAkBC,EAAE,GAAA,aAAA,CAAA,EACpB,QAAOV,IAEG,iBACT,IAEM,CAFNW,EAEM,MAFNC,EAEMC,EADDH,EAAE,GAAA,uDAAA,CAAA,EAAA,CAAA,EAEPC,EA0BM,MA1BNG,EA0BM,CAzBJH,EAYM,MAAA,KAAA,CAXJA,EAGM,MAHNI,EAGM,CAFDL,EAAAA,EAAAA,EAAAA,mBAAoB,IACvB,CAAA,EAAAM,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,EAAqC,OAA/B,CAAA,MAAM,gBAAgB,EAAC,IAAC,EAAA,KAEhCM,EAMEC,EAAA,CALA,MAAM,+BACL,MAAOtB,EAAU,MAClB,QAAQ,kBACP,SAASoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAOvB,EAAA,MAAauB,GAC7B,SAAUjB,uBAGfS,EAWM,MAAA,KAAA,CAVJA,EAGM,MAHNS,EAGM,CAFDV,EAAAA,EAAAA,EAAAA,kBAAmB,IACtB,CAAA,EAAYd,EAAU,OAAA,aAAtByB,EAAkE,OAAlEC,EAA0D,GAAC,cAE7DL,EAKEM,EAAA,CAJA,MAAM,+BACN,KAAK,WACJ,MAAOzB,EAAS,MAChB,SAAMkB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGQ,GAAO1B,EAAA,MAAY0B,EAAE,OAAO,gCAKnC,UACT,IAMM,CANNb,EAMM,MANNc,EAMM,CALJd,EAA4C,MAAA,KAAA,CAAvCM,EAAiCS,EAAA,CAAlB,QAAS3B,EAAK,KAAA,EAAA,KAAA,EAAA,CAAA,SAAA,CAAA,IAClCY,EAGM,MAHNgB,EAGM,CAFJV,EAAgDW,EAAA,CAAvC,MAAOlB,EAAE,GAAA,QAAA,EAAa,QAAOV,qBACtCiB,EAA4DW,EAAA,CAApD,QAAQ,QAAS,MAAOlB,EAAE,GAAA,MAAA,EAAW,QAAOT"}