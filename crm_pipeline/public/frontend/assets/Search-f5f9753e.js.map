{"version":3,"file":"Search-f5f9753e.js","sources":["../../../../frontend/src/pages/Search.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-white\">\n    <div class=\"mx-auto w-full max-w-3xl pt-24 px-4\">\n      <div class=\"rounded-lg border border-gray-200 bg-white shadow-sm\">\n        <div class=\"px-6 py-5\">\n          <h1 class=\"text-center text-lg font-semibold text-gray-800 mb-3\">\n            Organization Search\n          </h1>\n\n          <!-- Search input -->\n          <div class=\"flex items-center gap-3\">\n            <input\n              v-model=\"query\"\n              @keydown.enter=\"searchNow\"\n              type=\"text\"\n              placeholder=\"Search CRM organizations...\"\n              class=\"flex-1 rounded-md border border-gray-200 px-4 py-2 text-sm shadow-sm focus:outline-none focus:ring-1 focus:ring-slate-300\"\n            />\n            <button\n              @click=\"searchNow\"\n              class=\"inline-flex items-center gap-2 rounded-md bg-black px-3 py-2 text-sm font-medium text-white hover:opacity-95\"\n            >\n              Search\n            </button>\n          </div>\n\n          <!-- Results -->\n          <div class=\"mt-4\">\n            <div v-if=\"loading\" class=\"text-center text-gray-500\">Searching...</div>\n\n            <div v-else-if=\"!loading && searched && results.length === 0\"\n              class=\"mt-3 rounded-md bg-amber-50 p-4 text-amber-800\">\n              <div class=\"font-medium mb-2\">No organizations found. Try:</div>\n              <ul class=\"list-disc pl-5 space-y-1 text-sm\">\n                <li>Check spelling</li>\n                <li>Use fewer words</li>\n                <li>Try a different search term</li>\n              </ul>\n            </div>\n\n            <div v-else-if=\"results.length\" class=\"mt-3 space-y-3\">\n              <div\n                v-for=\"org in results\"\n                :key=\"org.name\"\n                class=\"rounded-md border border-gray-100 bg-white px-4 py-3 hover:bg-slate-50\"\n              >\n                <div class=\"text-sm font-bold text-gray-800\">\n                  {{ org.organization_name || org.name }}\n                </div>\n                <div class=\"text-xs text-gray-500 mt-0.5\">ID: {{ org.name }}</div>\n                <div class=\"text-xs text-gray-500 mt-0.5\">\n                  Owner: {{ org.custom_organization_owner || \"Not Assigned\" }}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div> <!-- inner -->\n      </div> <!-- card -->\n    </div> <!-- container -->\n  </div>\n</template>\n\n\n<script setup>\nimport { ref, watch } from 'vue'\n\nconst query = ref('')\nconst results = ref([])\nconst loading = ref(false)\nconst searched = ref(false)\nconst error = ref(null)\n\nlet debounceTimer = null\nconst DEBOUNCE_MS = 300\n\n// Link helper\nfunction orgLink(org) {\n  const base = window.location.origin\n  const orgName = encodeURIComponent(org.organization_name || org.name)\n  return `${base}/crm/organizations/${orgName}`\n}\n\nasync function searchNow() {\n  const q = (query.value || '').trim()\n  searched.value = true\n  results.value = []\n  error.value = null\n\n  if (!q) return\n\n  loading.value = true\n  try {\n    const base = window.location.origin\n    const params = new URLSearchParams()\n    params.append('search_query', q)\n\n    // Call your API: crm_override.app\n    const url = `${base}/api/method/crm_override.api.search_organizations_external?${params.toString()}`\n    const resp = await fetch(url, {\n      method: 'GET',\n      credentials: 'include',\n      headers: { Accept: 'application/json' },\n    })\n\n    if (!resp.ok) throw new Error(`${resp.status} ${resp.statusText}`)\n\n    const json = await resp.json()\n    // âœ… Adjusted: results are under json.message.data\n    results.value = (json.message?.data || []).map(org => ({\n      name: org.name,\n      organization_name: org.organization_name,\n      custom_organization_owner: org.custom_organization_owner || 'N/A'\n    }))\n  } catch (err) {\n    console.error('Search error:', err)\n    error.value = err.message || String(err)\n  } finally {\n    loading.value = false\n  }\n}\n\n// Debounced search while typing\nwatch(\n  () => query.value,\n  (val) => {\n    if (debounceTimer) clearTimeout(debounceTimer)\n    if (!val || !val.trim()) {\n      results.value = []\n      searched.value = false\n      return\n    }\n    debounceTimer = setTimeout(() => {\n      searchNow()\n    }, DEBOUNCE_MS)\n  }\n)\n</script>\n\n\n<style scoped>\ninput::placeholder {\n  color: #9aa0a6;\n}\n</style>\n"],"names":["DEBOUNCE_MS","query","ref","results","loading","searched","error","debounceTimer","searchNow","q","base","params","url","resp","json","_a","org","err","watch","val","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_cache","_hoisted_5","$event","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_Fragment","_renderList","_hoisted_10","_toDisplayString","_hoisted_11","_hoisted_12"],"mappings":"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"}