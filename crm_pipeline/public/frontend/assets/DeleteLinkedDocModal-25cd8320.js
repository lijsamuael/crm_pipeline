import{k as A,f as n,c as v,A as b,d as f,t as C,u as l,g,K as z,ah as F,B as $,l as V,y as S,aZ as ye,S as T,T as U,n as D,a1 as E,bA as I,F as L,r as M,C as G,a6 as B,b as k,w as R,Y as ge,_ as he,aB as ue,bB as _e,bC as ke,m as be,z as N,I as xe,b3 as $e,o as Re,a as Ce,e as H,N as Se,O as Le,aK as De,X as Ae,aS as je,aQ as ie}from"./index-a094f868.js";const ze={class:"flex h-full w-full flex-col items-center justify-center text-base"},Te={class:"text-xl font-medium text-ink-gray-8 mt-6"},Me={class:"mt-1 text-base text-ink-gray-5"},Ve={__name:"ListEmptyState",setup(a){const s=A("list");return(e,o)=>(n(),v("div",ze,[b(e.$slots,"default",{},()=>[f("div",Te,C(l(s).options.emptyState.title),1),f("div",Me,C(l(s).options.emptyState.description),1),l(s).options.emptyState.button?(n(),g(l(F),z({key:0},l(s).options.emptyState.button,{class:"mt-4"}),null,16)):$("",!0)])]))}};function ce(a,s=!0){let e=s?"14px ":"",o=a.map(r=>{let i=r.width||1;return typeof i=="number"?i+"fr":i}).join(" ");return e+o}const P={left:"justify-start",start:"justify-start",center:"justify-center",middle:"justify-center",right:"justify-end",end:"justify-end"},Ue={class:"truncate"},de={__name:"ListHeaderItem",props:{item:{type:Object,required:!0},debounce:{type:Number,default:1e3}},emits:["columnWidthUpdated"],setup(a,{emit:s}){const e=a,o=s,r=V(null),i=V(null),d=S(()=>{if(typeof e.item.width=="string"){const m=parseInt(e.item.width);if(e.item.width.includes("rem"))return m*16;if(e.item.width.includes("px"))return m}return i.value.offsetWidth}),u=m=>{const y=m.clientX,h=d.value,x=c=>{document.body.classList.add("select-none"),document.body.classList.add("cursor-col-resize"),r.value.style.backgroundColor="rgb(199 199 199)";let w=h+(c.clientX-y);e.item.width=`${w<50?50:w}px`,_(e.item.width)},t=()=>{document.body.classList.remove("select-none"),document.body.classList.remove("cursor-col-resize"),r.value.style.backgroundColor="",window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",t)};window.addEventListener("mousemove",x),window.addEventListener("mouseup",t)},_=ye(m=>{e.item.width=m,o("columnWidthUpdated")},e.debounce),p=A("list");return(m,y)=>(n(),v("div",{ref_key:"columnRef",ref:i,class:D(["group relative flex items-center",a.item.align?l(P)[a.item.align]:"justify-between"])},[f("div",{class:D(["flex items-center space-x-2 truncate text-sm text-ink-gray-5",m.$attrs.class])},[b(m.$slots,"prefix",T(U({item:a.item}))),b(m.$slots,"default",{},()=>[f("div",Ue,C(a.item.label),1)]),b(m.$slots,"suffix",T(U({item:a.item})))],2),l(p).options.resizeColumn?b(m.$slots,"resizer",T(z({key:0},{item:a.item})),()=>[f("div",{class:"flex h-4 absolute -right-2 w-2 cursor-col-resize justify-center",onMousedown:u},[f("div",{ref_key:"resizer",ref:r,class:"h-full w-[2px] rounded-full transition-all duration-300 ease-in-out group-hover:bg-gray-400"},null,512)],32)]):$("",!0)],2))}},me={__name:"ListHeader",emits:["columnWidthUpdated"],setup(a,{emit:s}){const e=s,o=A("list");return(r,i)=>(n(),v("div",{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2",style:G({gridTemplateColumns:l(ce)(l(o).columns,l(o).options.selectable)})},[l(o).options.selectable?(n(),g(I,{key:0,class:"cursor-pointer duration-300",modelValue:l(o).allRowsSelected,onClick:E(l(o).toggleAllRows,["stop"])},null,8,["modelValue","onClick"])):$("",!0),b(r.$slots,"default",{},()=>[(n(!0),v(L,null,M(l(o).columns,d=>(n(),g(de,{key:d.key,item:d,onColumnWidthUpdated:u=>e("columnWidthUpdated",d)},null,8,["item","onColumnWidthUpdated"]))),128))])],4))}},We={class:"truncate text-base"},fe={__name:"ListRowItem",props:{column:{type:Object,default:{}},row:{type:Object,default:{}},item:{type:[String,Number,Object],default:""},align:{type:String,default:"left"}},setup(a){const s=a,e=S(()=>{var d,u;return(d=s.column)!=null&&d.getLabel?(u=s.column)==null?void 0:u.getLabel({row:s.row}):r(s.item).label||""}),o=S(()=>i.value.options.showTooltip?s.column.getTooltip?s.column.getTooltip(s.row):r(s.item).label:"");function r(d){return d&&typeof d=="object"?d:{label:d}}const i=A("list");return(d,u)=>(n(),v("div",{class:D(["flex items-center space-x-2",l(P)[a.align]])},[b(d.$slots,"prefix",{},()=>[a.column.prefix?(n(),g(B(typeof a.column.prefix=="function"?a.column.prefix({row:a.row}):a.column.prefix),{key:0})):$("",!0)]),k(l(ge),T(U(l(i).options.showTooltip?{text:o.value}:{text:""})),{default:R(()=>[b(d.$slots,"default",T(U({label:e.value})),()=>[f("div",We,C(e.value),1)])]),_:3},16),b(d.$slots,"suffix")],2))}},K={__name:"ListRow",props:{row:{type:Object,required:!0}},setup(a){const s=a,e=A("list"),o=S(()=>{var m;return(m=e.value.rows)!=null&&m.length?e.value.rows[e.value.rows.length-1][e.value.rowKey]===s.row[e.value.rowKey]:!1}),r=S(()=>e.value.selections.has(s.row[e.value.rowKey])),i=S(()=>e.value.options.enableActive&&e.value.activeRow.value===s.row.name),d=S(()=>e.value.options.getRowRoute||e.value.options.onRowClick),u=S(()=>typeof e.value.options.rowHeight=="number"?`${e.value.options.rowHeight}px`:e.value.options.rowHeight),_=S(()=>{var h,x,t;if(!r.value)return"rounded";const m=[...e.value.selections];let y=(h=e.value.rows[0])!=null&&h.group?e.value.rows.map(c=>c.rows):[e.value.rows];for(let c of y){let w=c.findIndex(j=>j==s.row);if(w===-1)continue;let W=!m.includes((x=c[w+1])==null?void 0:x.name),O=!m.includes((t=c[w-1])==null?void 0:t.name);return(W?"rounded-b ":"")+(O?"rounded-t":"")}}),p=(m,y)=>{e.value.options.onRowClick&&e.value.options.onRowClick(m,y),e.value.activeRow.value===m.name?e.value.activeRow.value=null:e.value.activeRow.value=m.name};return(m,y)=>(n(),g(B(l(e).options.getRowRoute?"router-link":"div"),z({class:[[_.value,r.value||i.value?"bg-surface-gray-2":"",d.value?"cursor-pointer":"",d.value?r.value||i.value?"hover:bg-surface-gray-3":"hover:bg-surface-menu-bar":""],"flex flex-col transition-all duration-300 ease-in-out"]},{to:l(e).options.getRowRoute?l(e).options.getRowRoute(a.row):void 0,onClick:h=>p(a.row,h)}),{default:R(()=>[(n(),g(B(l(e).options.getRowRoute?"template":"button"),{class:"[all:unset] hover:[all:unset]"},{default:R(()=>{var h,x;return[f("div",{class:"grid items-center space-x-4 px-2",style:G({height:u.value,gridTemplateColumns:l(ce)(l(e).columns,l(e).options.selectable)})},[l(e).options.selectable?(n(),v("div",{key:0,class:"w-fit pr-2 py-3 flex",onClick:y[1]||(y[1]=E(()=>{},["stop","prevent"])),onDblclick:y[2]||(y[2]=E(()=>{},["stop"]))},[k(I,{modelValue:r.value,class:"cursor-pointer duration-300",onClick:y[0]||(y[0]=E(t=>l(e).toggleRow(a.row[l(e).rowKey]),["stop"]))},null,8,["modelValue"])],32)):$("",!0),(n(!0),v(L,null,M(l(e).columns,(t,c)=>(n(),v("div",{key:t.key,class:D([l(P)[t.align],c==0?"text-ink-gray-9":"text-ink-gray-7"])},[b(m.$slots,"default",z({ref_for:!0},{idx:c,column:t,item:a.row[t.key],isActive:i.value}),()=>[l(e).slots.cell?(n(),g(B(l(e).slots.cell),z({key:0,ref_for:!0},{column:t,row:a.row,item:a.row[t.key],align:t.align}),null,16)):(n(),g(fe,{key:1,column:t,row:a.row,item:a.row[t.key],align:t.align},null,8,["column","row","item","align"]))])],2))),128))],4),o.value?$("",!0):(n(),v("div",{key:0,class:D(["h-px border-t",_.value==="rounded"||(x=(h=_.value)==null?void 0:h.includes)!=null&&x.call(h,"rounded-b")?"mx-2 border-outline-gray-1":"border-t-[--surface-gray-2]"])},null,2))]}),_:3}))]),_:3},16,["class"]))}},Be={class:"h-full overflow-y-auto"},pe={__name:"ListRows",setup(a){const s=A("list");return(e,o)=>(n(),v("div",Be,[b(e.$slots,"default",{},()=>[(n(!0),v(L,null,M(l(s).rows,r=>(n(),g(K,{key:r[l(s).rowKey],row:r},null,8,["row"]))),128))])]))}},Oe={},qe={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16"};function Ee(a,s){return n(),v("svg",qe,[...s[0]||(s[0]=[f("path",{fill:"currentColor",d:"M4.293 5.28h7.413a.5.5 0 0 1 .41.787l-3.707 5.295a.5.5 0 0 1-.82 0L3.884 6.067a.5.5 0 0 1 .41-.787Z"},null,-1)])])}const Ke=he(Oe,[["render",Ee]]),Fe={class:"flex items-center"},Ne={class:"w-full py-1.5 pr-2"},He={key:1,class:"text-base font-medium leading-6"},ve={__name:"ListGroupHeader",props:{group:{type:Object,required:!0}},setup(a){const s=a,e=A("list");function o(){s.group.collapsed==null&&(s.group.collapsed=!1),s.group.collapsed=!s.group.collapsed}return(r,i)=>(n(),v(L,null,[f("div",Fe,[f("button",{onClick:o,class:"ml-[3px] mr-[11px] rounded p-1 hover:bg-surface-gray-2"},[k(Ke,{class:D(["h-4 w-4 text-ink-gray-6 transition-transform duration-200",[a.group.collapsed?"-rotate-90":""]])},null,8,["class"])]),b(r.$slots,"default",{},()=>[f("div",Ne,[l(e).slots["group-header"]?(n(),g(B(l(e).slots["group-header"]),T(z({key:0},{group:a.group})),null,16)):(n(),v("span",He,C(a.group.group),1))])])]),i[0]||(i[0]=f("div",{class:"mx-2 h-px border-t border-outline-gray-modals"},null,-1))],64))}},Ie={key:0,class:"mb-5 mt-2"},we={__name:"ListGroupRows",props:{group:{type:Object,required:!0}},setup(a){const s=A("list");return(e,o)=>a.group.collapsed?$("",!0):(n(),v("div",Ie,[b(e.$slots,"default",{},()=>[(n(!0),v(L,null,M(a.group.rows,r=>(n(),g(K,{key:r[l(s).rowKey],row:r},null,8,["row"]))),128))])]))}},Ge={class:"h-full overflow-y-auto"},Pe={__name:"ListGroups",setup(a){const s=A("list");return(e,o)=>(n(),v("div",Ge,[(n(!0),v(L,null,M(l(s).rows,r=>(n(),v("div",{key:r.group},[b(e.$slots,"default",{},()=>[k(ve,{group:r},{default:R(()=>[e.$slots["group-header"]?b(e.$slots,"group-header",z({key:0,ref_for:!0},{group:r})):$("",!0)]),_:2},1032,["group"]),k(we,{group:r},null,8,["group"])])]))),128))]))}},Xe={key:0,class:"absolute inset-x-0 bottom-6 mx-auto w-max text-base"},Ze={class:"flex flex-1 justify-between border-r border-outline-gray-2 text-ink-gray-9"},Qe={class:"flex items-center space-x-3"},Ye={class:"mr-3"},Je={class:"flex items-center space-x-1"},et=Object.assign({inheritAttrs:!1},{__name:"ListSelectBanner",setup(a){const s=A("list");let e=S(()=>s.value.options.selectionText(s.value.selections.size));return(o,r)=>(n(),g(_e,{"enter-active-class":"duration-300 ease-out","enter-from-class":"transform opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-300 ease-in","leave-from-class":"opacity-100","leave-to-class":"transform opacity-0"},{default:R(()=>[l(s).selections.size?(n(),v("div",Xe,[f("div",{class:D(["flex min-w-[596px] items-center space-x-3 rounded-lg bg-surface-white px-4 py-2 shadow-2xl",o.$attrs.class])},[b(o.$slots,"default",T(U({selections:l(s).selections,allRowsSelected:l(s).allRowsSelected,selectAll:()=>l(s).toggleAllRows(!0),unselectAll:()=>l(s).toggleAllRows(!1)})),()=>[f("div",Ze,[f("div",Qe,[k(I,{modelValue:!0,disabled:!0,class:"text-ink-gray-9"}),f("div",null,C(l(e)),1)]),f("div",Ye,[b(o.$slots,"actions",T(U({selections:l(s).selections,allRowsSelected:l(s).allRowsSelected,selectAll:()=>l(s).toggleAllRows(!0),unselectAll:()=>l(s).toggleAllRows(!1)})))])]),f("div",Je,[k(l(F),{class:D(["w- text-ink-gray-7",l(s).allRowsSelected?"cursor-not-allowed":""]),disabled:l(s).allRowsSelected,variant:"ghost",onClick:r[0]||(r[0]=i=>l(s).toggleAllRows(!0))},{default:R(()=>[...r[2]||(r[2]=[ue(" Select all ",-1)])]),_:1},8,["disabled","class"]),k(l(F),{icon:"x",variant:"ghost",onClick:r[1]||(r[1]=i=>l(s).toggleAllRows(!1))})])])],2)])):$("",!0)]),_:3}))}}),tt={class:"relative flex w-full flex-1 flex-col overflow-x-auto"},st=Object.assign({inheritAttrs:!1},{__name:"ListView",props:{columns:{type:Array,default:[]},rows:{type:Array,default:[]},rowKey:{type:String,required:!0},options:{type:Object,default:()=>({getRowRoute:null,onRowClick:null,showTooltip:!0,selectable:!0,resizeColumn:!1,rowHeight:40,emptyState:{title:"No Data",description:"No data available"}})}},emits:["update:selections","update:active-row"],setup(a,{expose:s,emit:e}){const o=a,r=ke();let i=be(new Set),d=V(null);const u=e;N(i,t=>{i.size&&(d.value=null),u("update:selections",t)}),N(d,t=>{u("update:active-row",t)});let _=S(()=>{function t(w){return w===void 0?!0:w}function c(w){return w===void 0?!1:w}return{getRowRoute:o.options.getRowRoute||null,onRowClick:o.options.onRowClick||null,showTooltip:t(o.options.showTooltip),selectionText:o.options.selectionText||(w=>w===1?"1 row selected":`${w} rows selected`),enableActive:c(o.options.enableActive),selectable:t(o.options.selectable),resizeColumn:c(o.options.resizeColumn),rowHeight:o.options.rowHeight||40,emptyState:o.options.emptyState}});const p=S(()=>o.rows.length?y.value?i.size===o.rows.reduce((t,c)=>t+c.rows.length,0):i.size===o.rows.length:!1),m=S(()=>_.value.selectable);let y=S(()=>o.rows.every(t=>t.group&&t.rows&&Array.isArray(t.rows)));function h(t){i.delete(t)||i.add(t)}function x(t){if(!t||p.value){i.clear();return}if(y.value){o.rows.forEach(c=>{c.rows.forEach(w=>i.add(w[o.rowKey]))});return}o.rows.forEach(c=>i.add(c[o.rowKey]))}return xe("list",S(()=>({rowKey:o.rowKey,rows:o.rows,columns:o.columns,options:_.value,selections:i,activeRow:d,allRowsSelected:p.value,slots:r,toggleRow:h,toggleAllRows:x}))),s({selections:i,allRowsSelected:p,toggleRow:h,toggleAllRows:x}),(t,c)=>(n(),v("div",tt,[f("div",{class:D(["flex w-max min-w-full flex-col overflow-y-hidden",t.$attrs.class]),style:G(t.$attrs.style)},[b(t.$slots,"default",T(U({showGroupedRows:l(y),selectable:m.value})),()=>[k(me),o.rows.length?(n(),v(L,{key:0},[l(y)?(n(),g(Pe,{key:0})):(n(),g(pe,{key:1}))],64)):(n(),g(Ve,{key:1})),m.value?(n(),g(et,{key:2})):$("",!0)])],6)]))}}),ot={key:0,class:"mx-3 mt-2 h-full overflow-y-auto sm:mx-5"},lt={class:"my-2 flex items-center gap-2 text-base font-medium text-ink-gray-8"},nt={class:"flex items-center gap-1"},rt={key:1,class:"text-ink-gray-4"},at={key:2},it={__name:"ListRows",props:{rows:{type:Array,required:!0},doctype:{type:String,default:"CRM Lead"}},setup(a){const s=a,e=V(s.rows);N(()=>s.rows,u=>e.value=u);let o=S(()=>s.rows.every(u=>u.group&&u.rows&&Array.isArray(u.rows)));const r=$e(`scrollPosition${s.doctype}`,0),i=V(null),d=()=>{i.value&&(r.value=i.value.$el.scrollTop)};return Re(()=>{i.value&&i.value.$el.removeEventListener("scroll",d)}),Ce(()=>{i.value&&(i.value.$el.addEventListener("scroll",d),i.value.$el.scrollTop=r.value)}),(u,_)=>l(o)?(n(),v("div",ot,[(n(!0),v(L,null,M(e.value,p=>(n(),v("div",{key:p.group},[k(l(ve),{group:p},{default:R(()=>[f("div",lt,[f("div",null,C(u.__(p.label))+" -",1),f("div",nt,[p.icon?(n(),g(B(p.icon),{key:0})):$("",!0),p.group==" "?(n(),v("div",rt,C(u.__("Empty")),1)):(n(),v("div",at,C(p.group),1))])])]),_:2},1032,["group"]),k(l(we),{group:p},{default:R(()=>[(n(!0),v(L,null,M(p.rows,m=>(n(),g(l(K),{key:m.name,row:m},{default:R(({idx:y,column:h,item:x})=>[b(u.$slots,"default",z({ref_for:!0},{idx:y,column:h,item:x,row:m}))]),_:2},1032,["row"]))),128))]),_:2},1032,["group"])]))),128))])):(n(),g(l(pe),{key:1,ref_key:"scrollContainer",ref:i,class:"mx-3 sm:mx-5",onScroll:d},{default:R(()=>[(n(!0),v(L,null,M(e.value,p=>(n(),g(l(K),{key:p.name,row:p},{default:R(({idx:m,column:y,item:h})=>[b(u.$slots,"default",z({ref_for:!0},{idx:m,column:y,item:h,row:p}))]),_:2},1032,["row"]))),128))]),_:3},512))}},ut={class:"*:mx-0 *:sm:mx-0"},ct={key:0,class:"truncate text-base flex gap-2 w-full"},dt={class:"max-w-[90%] truncate"},mt={key:1,class:"truncate text-base flex gap-2"},ft={__name:"LinkedDocsListView",props:{rows:{type:Array,required:!0},columns:{type:Array,required:!0},linkedDocsResource:{type:Object,required:!0},unlinkLinkedDoc:{type:Function,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},emits:["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],setup(a,{emit:s}){const e=s,o=V(null),r=d=>{let u="",_="",p=!1;switch(d.reference_doctype){case"CRM Lead":u="leads",_=d.reference_docname;break;case"CRM Call Log":u="call-logs",_=`view?open=${d.reference_docname}`;break;case"CRM Task":u="tasks",_=`view?open=${d.reference_docname}`;break;case"Contact":u="contacts",_=d.reference_docname;break;case"CRM Organization":u="organizations",_=d.reference_docname;break;case"CRM Notification":u="crm-notification",_=d.reference_docname,p=!0;break;case"FCRM Note":u="notes",_=`view?open=${d.reference_docname}`;break}let m="/crm";p&&(m="/app"),window.open(`${m}/${u}/${_}`)},i=d=>d.replace(/^(CRM|FCRM)\s*/,"");return(d,u)=>{const _=H("FeatherIcon");return n(),g(l(st),{class:D(d.$attrs.class),columns:a.columns,rows:a.rows,options:{selectable:!0,showTooltip:!0,resizeColumn:!0},"row-key":"reference_docname","onUpdate:selections":u[1]||(u[1]=p=>e("selectionsChanged",p)),ref_key:"listViewRef",ref:o},{default:R(()=>[k(l(me),{onColumnWidthUpdated:u[0]||(u[0]=p=>e("columnWidthUpdated"))},{default:R(()=>[(n(!0),v(L,null,M(a.columns,p=>(n(),g(l(de),{key:p.key,item:p,onColumnWidthUpdated:m=>e("columnWidthUpdated",p)},null,8,["item","onColumnWidthUpdated"]))),128))]),_:1}),f("div",ut,[k(it,{rows:a.rows},{default:R(({idx:p,column:m,item:y,row:h})=>[k(l(fe),{item:y,onClick:x=>o.value.toggleRow(h.reference_docname),class:"!w-full"},{default:R(({label:x})=>[m.key==="title"?(n(),v("div",ct,[f("span",dt,C(x),1),k(_,{name:"external-link",class:"h-4 w-4 cursor-pointer",onClick:E(t=>r(h),["stop"])},null,8,["onClick"])])):$("",!0),m.key==="reference_doctype"?(n(),v("span",mt,C(i(h.reference_doctype)),1)):$("",!0)]),_:2},1032,["item","onClick"])]),_:1},8,["rows"])])]),_:1},8,["class","columns","rows"])}}},pt={class:"bg-surface-modal px-4 pb-6 pt-5 sm:px-6"},vt={class:"mb-6 flex items-center justify-between"},wt={class:"text-2xl leading-6 text-ink-gray-9 font-semibold"},yt={class:"flex items-center gap-1"},gt={key:0},ht={class:"text-ink-gray-5 text-base"},_t={key:1,class:"text-ink-gray-5 text-base"},kt={class:"px-4 pb-7 pt-0 sm:px-6"},bt={class:"flex flex-row-reverse gap-2"},xt={class:"bg-surface-modal px-4 pb-6 pt-5 sm:px-6"},$t={class:"mb-6 flex items-center justify-between"},Rt={class:"text-2xl leading-6 text-ink-gray-9 font-semibold"},Ct={class:"flex items-center gap-1"},St={class:"text-ink-gray-5 text-base"},Lt={class:"flex justify-end gap-2 mt-6"},At={__name:"DeleteLinkedDocModal",props:Se({name:{type:String,required:!0},doctype:{type:String,required:!0},docname:{type:String,required:!0},reload:{type:Function}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const s=Le(a,"modelValue"),e=De(),o=a,r=V({selections:[],updateSelections:t=>{r.value.selections=Array.from(t||[])}}),i=V({show:!1,title:""}),d=Ae({url:"crm.api.doc.get_linked_docs_of_document",params:{doctype:o.doctype,docname:o.docname},auto:!0,validate(t){if(!(t!=null&&t.doctype)||!(t!=null&&t.docname))return!1}}),u=S(()=>{var t;return((t=d.data)==null?void 0:t.map(c=>({id:c.reference_docname,...c})))||[]}),_=()=>{i.value.show=!1,r.value.updateSelections([])},p=t=>{let c=[];r.value.selections.length>0?Array.from(r.value.selections).forEach(w=>{const W=u.value.find(O=>O.id==w);c.push({doctype:W.reference_doctype,docname:W.reference_docname})}):c=u.value.map(w=>({doctype:w.reference_doctype,docname:w.reference_docname})),ie("crm.api.doc.remove_linked_doc_reference",{items:c,remove_contact:o.doctype=="Contact",delete:t.delete}).then(()=>{d.reload(),i.value={show:!1,title:""}})},m=()=>{const t=r.value.selections.length==0?"all":r.value.selections.length;i.value={show:!0,title:__("Delete linked item"),message:__("Are you sure you want to delete {0} linked item(s)?",[t]),delete:!0}},y=()=>{const t=r.value.selections.length==0?"all":r.value.selections.length;i.value={show:!0,title:__("Unlink linked item"),message:__("Are you sure you want to unlink {0} linked item(s)?",[t]),delete:!1}},h=()=>{p({reference_doctype:o.doctype,reference_docname:o.docname,delete:i.value.delete}),r.value.updateSelections([])},x=async()=>{var t;await ie("frappe.client.delete",{doctype:o.doctype,name:o.docname}),e.push({name:o.name}),(t=o==null?void 0:o.reload)==null||t.call(o)};return(t,c)=>{const w=H("Button"),W=ft,O=H("Dialog");return n(),g(O,{modelValue:s.value,"onUpdate:modelValue":c[8]||(c[8]=j=>s.value=j),options:{size:"xl"}},je({_:2},[i.value.show?void 0:{name:"body",fn:R(()=>{var j,X,Z,Q,Y,J,ee,te,se,oe,le,ne,re,ae;return[f("div",pt,[f("div",vt,[f("div",null,[f("h3",wt,C(((j=u.value)==null?void 0:j.length)==0?t.__("Delete"):t.__("Delete or unlink linked documents")),1)]),f("div",yt,[k(w,{variant:"ghost",icon:"x",onClick:c[0]||(c[0]=q=>s.value=!1)})])]),f("div",null,[((X=u.value)==null?void 0:X.length)>0?(n(),v("div",gt,[f("span",ht,C(t.__("Delete or unlink these linked documents before deleting this document")),1),k(W,{class:"mt-4",rows:u.value,columns:[{label:"Document",key:"title",width:"19rem"},{label:"Master",key:"reference_doctype",width:"12rem"}],onSelectionsChanged:c[1]||(c[1]=q=>r.value.updateSelections(q)),linkedDocsResource:l(d),unlinkLinkedDoc:p},null,8,["rows","linkedDocsResource"])])):$("",!0),((Z=u.value)==null?void 0:Z.length)==0?(n(),v("div",_t,C(t.__("Are you sure you want to delete {0} - {1}?",[o.doctype,o.docname])),1)):$("",!0)])]),f("div",kt,[f("div",bt,[((Q=u.value)==null?void 0:Q.length)>0?(n(),g(w,{key:0,label:((J=(Y=r.value)==null?void 0:Y.selections)==null?void 0:J.length)==0?t.__("Delete all"):t.__("Delete {0} item(s)",[(te=(ee=r.value)==null?void 0:ee.selections)==null?void 0:te.length]),theme:"red",variant:"solid","icon-left":"trash-2",onClick:c[2]||(c[2]=q=>m())},null,8,["label"])):$("",!0),((se=u.value)==null?void 0:se.length)>0?(n(),g(w,{key:1,label:((le=(oe=r.value)==null?void 0:oe.selections)==null?void 0:le.length)==0?t.__("Unlink all"):t.__("Unlink {0} item(s)",[(re=(ne=r.value)==null?void 0:ne.selections)==null?void 0:re.length]),variant:"subtle",theme:"gray","icon-left":"unlock",onClick:c[3]||(c[3]=q=>y())},null,8,["label"])):$("",!0),((ae=u.value)==null?void 0:ae.length)==0?(n(),g(w,{key:2,variant:"solid","icon-left":"trash-2",label:t.__("Delete"),loading:t.isDealCreating,onClick:c[4]||(c[4]=q=>x()),theme:"red"},null,8,["label","loading"])):$("",!0)])])]}),key:"0"},i.value.show?{name:"body",fn:R(()=>[f("div",xt,[f("div",$t,[f("div",null,[f("h3",Rt,C(i.value.title),1)]),f("div",Ct,[k(w,{variant:"ghost",icon:"x",onClick:c[5]||(c[5]=j=>s.value=!1)})])]),f("div",St,C(i.value.message),1),f("div",Lt,[k(w,{variant:"ghost",onClick:c[6]||(c[6]=j=>_())},{default:R(()=>[ue(C(t.__("Cancel")),1)]),_:1}),k(w,{variant:"solid",label:i.value.title,onClick:c[7]||(c[7]=j=>h()),theme:"red"},null,8,["label"])])])]),key:"1"}:void 0]),1032,["modelValue"])}}};export{me as _,de as a,it as b,fe as c,et as d,st as e,At as f};
//# sourceMappingURL=DeleteLinkedDocModal-25cd8320.js.map
