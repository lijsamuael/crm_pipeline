import{n as Tt,p as Je,b as _t,c as Mt,v as Ge,_ as Et}from"./event-c2e587ab.js";import{D as $t,e as St,v as Vt,_ as At}from"./index-2d68a6a0.js";import{j as dt,y as R,e as Ae,f as t,c as m,d as o,F as J,r as se,b as k,u as a,a3 as Qe,a4 as et,a5 as tt,g as U,a6 as Le,t as Z,B as H,A as je,K as Ne,a7 as Lt,a8 as Ft,a9 as Ht,aa as It,ab as Yt,ac as Bt,_ as $e,a1 as re,ad as _e,ae as jt,l as O,m as We,k as Ce,w as K,V as Te,C as De,af as Me,ag as ct,ah as ke,W as Pt,ai as vt,aj as qe,a as He,o as ft,z as Ee,ak as Ye,al as Ot,am as zt,an as Rt,ao as Ut,ap as Nt,aq as Wt,ar as qt,as as be,n as ie,at as Zt,au as ce,av as ze,aw as Pe,ax as mt,ay as pt,P as de,Y as yt,az as gt,aA as ht,aB as Re,aC as Kt,aD as Xt,I as Ue,aE as Jt,aF as Ke,aG as Gt,aH as Qt,G as en,aI as nt,S as at,T as lt,aJ as tn,N as ot,aK as nn,O as st,aL as an,a2 as ln,aM as on,aN as sn,aO as rn,a0 as un,aP as dn,aQ as cn}from"./index-a094f868.js";import{A as vn}from"./ArrowUpRightIcon-9ddf39c9.js";import{L as fn}from"./LeadsIcon-bb4322a7.js";import{D as mn}from"./DealsIcon-4613d91f.js";import{L as rt}from"./Link-3cfde2ee.js";import{_ as Xe,E as pn,a as it}from"./EditIcon-d7d50f24.js";import{g as Dt}from"./global-c1d3e1d5.js";import{_ as yn}from"./TextEditor.vue_vue_type_script_setup_true_lang-e2f7307d.js";import{_ as gn}from"./ViewBreadcrumbs-f07dae54.js";import{L as hn}from"./LayoutHeader-027ebcdc.js";import{T as xt}from"./TabButtons-66363a13.js";import"./ComboboxViewport-87bc0927.js";import"./Icon-5431cc70.js";import"./description-ce5058e0.js";const Dn=["aria-label"],xn={key:0},wn={key:1},bn={key:2},kn={key:3},Cn={key:1,class:"font-mono leading-none tracking-wide uppercase text-[10px]"},Tn={key:4,class:"font-mono text-[10px] leading-none opacity-60","aria-hidden":"true"},_n={key:0},Mn={key:1,class:"font-mono text-[10px] leading-none"},En={key:1},$n={key:2},Sn={key:0,class:"inline-flex items-center gap-1 ml-1"},Vn=["aria-label"],ut=dt({name:"KeyboardShortcut",__name:"KeyboardShortcut",props:{meta:{type:Boolean},ctrl:{type:Boolean},shift:{type:Boolean},alt:{type:Boolean},shortcut:{},bg:{type:Boolean},combo:{},showPlus:{type:Boolean,default:!0},altCombos:{default:()=>[]},useIcons:{type:Boolean,default:!0}},setup(r){const u=R(()=>{var $;if(typeof navigator>"u")return!1;const c=(($=navigator.userAgentData)==null?void 0:$.platform)||navigator.platform||"";return/Mac|iPod|iPhone|iPad/i.test(c)?!0:/Mac OS X|Macintosh|iPhone|iPad|iPod/i.test(navigator.userAgent)}),h=r,n=R(()=>h.showPlus),y=R(()=>h.bg?"bg-surface-gray-2 rounded-sm text-ink-gray-5 py-0.5 px-1":"text-ink-gray-4");function j(c){if(!c)return[];const $={mod:u.value?"cmd":"ctrl",command:"cmd",cmd:"cmd","⌘":"cmd",control:"ctrl",ctrl:"ctrl",option:"alt",opt:"alt",alt:"alt","⌥":"alt",shift:"shift","⇧":"shift",meta:u.value?"cmd":"win",win:"win",windows:"win"},D={esc:"Esc",escape:"Esc",enter:"↵",return:"↵",space:"Space"," ":"Space",tab:"Tab",backspace:"⌫",delete:"⌦",del:"⌦",up:"↑",arrowup:"↑",down:"↓",arrowdown:"↓",left:"←",arrowleft:"←",right:"→",arrowright:"→",pageup:"PgUp",pagedown:"PgDn",home:"Home",end:"End"},i=c.split("+").map(S=>S.trim()).filter(Boolean).map(S=>{const C=S.toLowerCase(),w=$[C]||"key";let _=S;return w!=="key"?w==="cmd"?_="⌘":w==="shift"?_="⇧":w==="alt"?_="⌥":w==="ctrl"?_="Ctrl":w==="win"&&(_="Win"):D[C]?_=D[C]:/^[a-z]$/.test(C)?_=C.toUpperCase():/^f\d{1,2}$/i.test(S)&&(_=S.toUpperCase()),{raw:S,type:w,display:_}});return f(i)}function f(c){const $=c.some(i=>i.display==="⌫"),D=c.some(i=>i.display==="⌦");return $&&D?u.value?c.filter(i=>i.display!=="⌦"):c.filter(i=>i.display!=="⌦"):c}const s=R(()=>j(h.combo)),E=R(()=>{if(!s.value.length)return;const c={"⌘":"Command","⇧":"Shift","⌥":"Option",Ctrl:"Control",Win:"Windows","↵":"Enter","⌫":"Backspace","⌦":"Delete","↑":"Up Arrow","↓":"Down Arrow","←":"Left Arrow","→":"Right Arrow"};return"Shortcut "+s.value.map(D=>c[D.display]||D.display).join(" + ")}),M={"↑":Lt,"↓":Ft,"←":Ht,"→":It,"↵":Yt,"⌫":Bt};function e(c){return!h.useIcons||["cmd","shift","alt"].includes(c.type)?null:M[c.display]||null}return(c,$)=>{const D=Ae("KeyboardShortcut",!0);return t(),m(J,null,[o("div",Ne({class:["inline-flex items-center gap-0.5 text-sm",y.value],"aria-label":E.value,role:"note"},c.$attrs),[s.value.length?(t(!0),m(J,{key:0},se(s.value,(i,S)=>(t(),m(J,{key:S+"-"+i.raw},[i.type==="cmd"?(t(),m("span",xn,[k(a(Qe),{class:"w-3 h-3","aria-label":"Command"})])):i.type==="shift"?(t(),m("span",wn,[k(a(et),{class:"w-3 h-3","aria-label":"Shift"})])):i.type==="alt"?(t(),m("span",bn,[k(a(tt),{class:"w-3 h-3","aria-label":"Option"})])):(t(),m("span",kn,[e(i)?(t(),U(Le(e(i)),{key:0,class:"w-3 h-3","aria-label":i.display},null,8,["aria-label"])):(t(),m("span",Cn,Z(i.display),1))])),S<s.value.length-1&&n.value?(t(),m("span",Tn,"+")):H("",!0)],64))),128)):(t(),m(J,{key:1},[r.ctrl||r.meta?(t(),m("span",_n,[u.value?(t(),U(a(Qe),{key:0,class:"w-3 h-3","aria-label":"Command"})):(t(),m("span",Mn,"Ctrl"))])):H("",!0),r.shift?(t(),m("span",En,[k(a(et),{class:"w-3 h-3","aria-label":"Shift"})])):H("",!0),r.alt?(t(),m("span",$n,[k(a(tt),{class:"w-3 h-3","aria-label":"Option"})])):H("",!0),je(c.$slots,"default")],64))],16,Dn),r.altCombos&&r.altCombos.length?(t(),m("span",Sn,[(t(!0),m(J,null,se(r.altCombos,(i,S)=>(t(),m("div",{key:"alt-"+S+i,class:"inline-flex items-center gap-0.5 text-sm bg-surface-gray-2 rounded-sm text-ink-gray-5 py-0.5 px-1","aria-label":"Alternative shortcut "+i},[k(D,{combo:i,"show-plus":n.value},null,8,["combo","show-plus"])],8,Vn))),128))])):H("",!0)],64)}}}),An={},Ln={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Fn(r,u){return t(),m("svg",Ln,[...u[0]||(u[0]=[o("path",{d:"M8 6C9.10457 6 10 6.89543 10 8C10 9.10457 9.10457 10 8 10C6.89543 10 6 9.10457 6 8C6 6.89543 6.89543 6 8 6ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"currentColor"},null,-1)])])}const Hn=$e(An,[["render",Fn]]),In={},Yn={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Bn(r,u){return t(),m("svg",Yn,[...u[0]||(u[0]=[o("path",{d:"M3 6C4.10457 6 5 6.89543 5 8C5 9.10457 4.10457 10 3 10C1.89543 10 1 9.10457 1 8C1 6.89543 1.89543 6 3 6ZM8 6C9.10457 6 10 6.89543 10 8C10 9.10457 9.10457 10 8 10C6.89543 10 6 9.10457 6 8C6 6.89543 6.89543 6 8 6ZM13 6C14.1046 6 15 6.89543 15 8C15 9.10457 14.1046 10 13 10C11.8954 10 11 9.10457 11 8C11 6.89543 11.8954 6 13 6ZM13 7C12.4477 7 12 7.44772 12 8C12 8.55228 12.4477 9 13 9C13.5523 9 14 8.55228 14 8C14 7.44772 13.5523 7 13 7ZM3 7C2.44772 7 2 7.44772 2 8C2 8.55228 2.44772 9 3 9C3.55228 9 4 8.55228 4 8C4 7.44772 3.55228 7 3 7ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"currentColor"},null,-1)])])}const jn=$e(In,[["render",Bn]]),Pn={},On={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function zn(r,u){return t(),m("svg",On,[...u[0]||(u[0]=[o("path",{d:"M5 9C6.10457 9 7 9.89543 7 11C7 12.1046 6.10457 13 5 13C3.89543 13 3 12.1046 3 11C3 9.89543 3.89543 9 5 9ZM11 9C12.1046 9 13 9.89543 13 11C13 12.1046 12.1046 13 11 13C9.89543 13 9 12.1046 9 11C9 9.89543 9.89543 9 11 9ZM5 10C4.44772 10 4 10.4477 4 11C4 11.5523 4.44772 12 5 12C5.55228 12 6 11.5523 6 11C6 10.4477 5.55228 10 5 10ZM11 10C10.4477 10 10 10.4477 10 11C10 11.5523 10.4477 12 11 12C11.5523 12 12 11.5523 12 11C12 10.4477 11.5523 10 11 10ZM5 3C6.10457 3 7 3.89543 7 5C7 6.10457 6.10457 7 5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3ZM11 3C12.1046 3 13 3.89543 13 5C13 6.10457 12.1046 7 11 7C9.89543 7 9 6.10457 9 5C9 3.89543 9.89543 3 11 3ZM5 4C4.44772 4 4 4.44772 4 5C4 5.55228 4.44772 6 5 6C5.55228 6 6 5.55228 6 5C6 4.44772 5.55228 4 5 4ZM11 4C10.4477 4 10 4.44772 10 5C10 5.55228 10.4477 6 11 6C11.5523 6 12 5.55228 12 5C12 4.44772 11.5523 4 11 4Z",fill:"currentColor"},null,-1)])])}const Rn=$e(Pn,[["render",zn]]),Un={class:"flex flex-row-reverse gap-2"},Nn={class:"flex flex-col gap-5"},Wn={class:"flex justify-between text-xl font-semibold"},qn={class:"flex flex-col gap-4"},Zn={class:"flex items-center gap-2"},Kn={class:"text-sm font-normal"},Xn={key:0,class:"flex items-center gap-2"},Jn={class:"text-sm font-normal"},Gn={key:1,class:"flex items-center gap-2"},Qn={class:"text-sm font-normal"},ea={key:2,class:"flex items-center gap-2"},ta={class:"text-sm font-normal"},na={__name:"EventModalContent",props:{calendarEvent:{type:Object,required:!0},date:{type:Date,required:!0},isEditMode:{type:Boolean}},emits:["close","edit","delete"],setup(r,{emit:u}){return(h,n)=>(t(),m("div",{class:"w-80 rounded bg-surface-modal text-ink-gray-8 p-4 shadow",onClick:n[3]||(n[3]=re(()=>{},["stop"]))},[o("div",Un,[o("span",{class:"cursor-pointer",onClick:n[0]||(n[0]=re(y=>h.$emit("close"),["stop"]))},[k(_e,{name:"x",class:"h-4 w-4"})]),r.isEditMode?(t(),m("span",{key:0,class:"cursor-pointer",onClick:n[1]||(n[1]=re(y=>h.$emit("edit"),["stop"]))},[k(_e,{name:"edit-2",class:"h-4 w-4"})])):H("",!0),r.isEditMode?(t(),m("span",{key:1,class:"cursor-pointer",onClick:n[2]||(n[2]=re(y=>h.$emit("delete"),["stop"]))},[k(_e,{name:"trash-2",class:"h-4 w-4"})])):H("",!0)]),o("div",Nn,[o("div",Wn,[o("span",null,Z(r.calendarEvent.title||"New Event"),1)]),o("div",qn,[o("div",Zn,[k(_e,{name:"calendar",class:"h-4 w-4"}),o("span",Kn,Z(a(jt)(r.date)),1)]),r.calendarEvent.participant?(t(),m("div",Xn,[k(_e,{name:"user",class:"h-4 w-4"}),o("span",Jn,Z(r.calendarEvent.participant),1)])):H("",!0),r.calendarEvent.fromTime&&r.calendarEvent.toTime?(t(),m("div",Gn,[k(_e,{name:"clock",class:"h-4 w-4"}),o("span",Qn,Z(r.calendarEvent.fromTime)+" - "+Z(r.calendarEvent.toTime),1)])):H("",!0),r.calendarEvent.venue?(t(),m("div",ea,[k(_e,{name:"map-pin",class:"h-4 w-4"}),o("span",ta,Z(r.calendarEvent.venue),1)])):H("",!0)])])]))}},aa={class:"grid grid-cols-1 gap-4"},la={class:"flex flex-row-reverse gap-2"},wt={__name:"NewEventModal",props:{event:{type:Object}},setup(r){var $,D,i,S,C,w,_,te,A,ne,G,X;const u=O(!1),h=r,n=We({title:(($=h.event)==null?void 0:$.title)||"",date:((D=h.event)==null?void 0:D.date)||"",participant:((i=h.event)==null?void 0:i.participant)||"",fromDateTime:((S=h.event)==null?void 0:S.fromDateTime)||"",toDateTime:((C=h.event)==null?void 0:C.toDateTime)||"",fromDate:((w=h.event)==null?void 0:w.fromDate)||"",toDate:((_=h.event)==null?void 0:_.toDate)||"",fromTime:((te=h.event)==null?void 0:te.fromTime)||"",toTime:((A=h.event)==null?void 0:A.toTime)||"",venue:((ne=h.event)==null?void 0:ne.venue)||"",color:((G=h.event)==null?void 0:G.color)||"green",id:"",isFullDay:((X=h.event)==null?void 0:X.isFullDay)||!1}),y=R(()=>n.title!==h.event.title||n.date!==h.event.date||n.participant!==h.event.participant||n.fromDate!==h.event.fromDate||n.toDate!==h.event.toDate||n.fromTime!==h.event.fromTime||n.toTime!==h.event.toTime||n.venue!==h.event.venue||n.color!==h.event.color||n.isFullDay!==h.event.isFullDay),j=Object.keys(Me),f=O("");function s(){n.date?!n.fromTime&&!n.isFullDay?f.value="Start Time is required":!n.toTime&&!n.isFullDay?f.value="End Time is required":f.value="":f.value="Date is required",n.hasOwnProperty("fromTime")&&n.hasOwnProperty("toTime")&&E()}function E(){vt(n.fromTime,n.toTime)<=0&&(f.value="Start time must be less than End Time")}const M=Ce("calendarActions");function e(ve){if(s(),!f.value){if(!y.value){ve();return}if(c(),h.event.hasOwnProperty("id"))n.id=h.event.id,M.updateEventState(n);else{const Y="#"+Math.random().toString(36).substring(3,9);n.id=Y,M.createNewEvent(n)}ve()}}function c(){n.isFullDay?(n.fromTime="",n.toTime=""):(n.fromTime=qe(n.fromTime),n.toTime=qe(n.toTime))}return(ve,Y)=>(t(),U(a(Pt),{modelValue:u.value,"onUpdate:modelValue":Y[11]||(Y[11]=V=>u.value=V),options:{title:h.event.hasOwnProperty("id")?"Edit Event":"New Event",actions:[{label:"Submit",variant:"solid"}]},class:"z-50"},{"body-content":K(()=>[o("div",null,[o("div",aa,[k(a(Te),{type:"Input",modelValue:n.title,"onUpdate:modelValue":Y[0]||(Y[0]=V=>n.title=V),label:"Title",placeholder:"Meet with John Doe"},null,8,["modelValue"]),k(a(Te),{type:"Date",modelValue:n.date,"onUpdate:modelValue":Y[1]||(Y[1]=V=>n.date=V),label:"Date",required:"true",onBlur:Y[2]||(Y[2]=V=>s())},null,8,["modelValue"]),k(a(Te),{type:"Input",modelValue:n.participant,"onUpdate:modelValue":Y[3]||(Y[3]=V=>n.participant=V),label:"Person",placeholder:"John Doe"},null,8,["modelValue"]),n.isFullDay?H("",!0):(t(),U(a(Te),{key:0,type:"time",modelValue:n.fromTime,"onUpdate:modelValue":Y[4]||(Y[4]=V=>n.fromTime=V),label:"Start Time",onBlur:Y[5]||(Y[5]=V=>s())},null,8,["modelValue"])),n.isFullDay?H("",!0):(t(),U(a(Te),{key:1,type:"time",modelValue:n.toTime,"onUpdate:modelValue":Y[6]||(Y[6]=V=>n.toTime=V),label:"End Time",onBlur:Y[7]||(Y[7]=V=>s())},null,8,["modelValue"])),k(a(Te),{type:"Input",modelValue:n.venue,"onUpdate:modelValue":Y[8]||(Y[8]=V=>n.venue=V),label:"Venue",placeholder:"Frappe, Neelkanth Business Park"},null,8,["modelValue"]),k(a(Te),{type:"select",modelValue:n.color,"onUpdate:modelValue":Y[9]||(Y[9]=V=>n.color=V),options:a(j),label:"Color",class:"form-control prefix"},{prefix:K(()=>{var V;return[o("div",{class:"h-5 w-5 rounded-full shadow-md",style:De({backgroundColor:(V=a(Me)[n==null?void 0:n.color])==null?void 0:V.color})},null,4)]}),_:1},8,["modelValue","options"]),k(a(Te),{type:"checkbox",label:"Full Day Event?",modelValue:n.isFullDay,"onUpdate:modelValue":Y[10]||(Y[10]=V=>n.isFullDay=V)},null,8,["modelValue"]),f.value?(t(),U(a(ct),{key:2,message:f.value},null,8,["message"])):H("",!0)])])]),actions:K(({close:V})=>[o("div",la,[k(a(ke),{class:"w-full",variant:"solid",onClick:P=>e(V),label:"Submit"},null,8,["onClick"])])]),_:1},8,["modelValue","options"]))}},oa={class:"relative flex h-full select-none items-start gap-2 overflow-hidden"},sa={key:0},ra={class:"flex w-fit flex-col gap-0.5 overflow-hidden"},ia={class:"relative flex h-full select-none items-start gap-2 overflow-hidden"},ua={key:0},da={class:"flex w-fit flex-col text-start overflow-hidden whitespace-nowrap"},ca={class:"text-sm font-medium truncate"},va=40,fa=32.5,ma={__name:"CalendarEvent",props:{event:{type:Object,required:!0},date:{type:Date,required:!0}},setup(r){const u=r,h=Ce("activeView"),n=Ce("config"),y=Ce("calendarActions");He(()=>{document.addEventListener("click",j)}),ft(()=>{document.removeEventListener("click",j)});function j(v){ne.value&&ne.value.contains(v.target)||A.value&&A.value.contains(v.target)||me()}const f=O(u.event),s=We({...u.event});Ee(()=>u.event,v=>{s.fromTime=v.fromTime,s.toTime=v.toTime,s.fromDate=v.fromDate,s.toDate=v.toDate,s.fromDateTime=v.fromDate+" "+v.fromTime,s.toDateTime=v.toDate+" "+v.toTime,f.value=v},{deep:!0});const E=n.eventIcons,M=n.hourHeight/60,e=M*15,c=We({xAxis:0,yAxis:0}),$=R(()=>{if(u.event.isFullDay)return{transform:`translate(${c.xAxis}px, ${c.yAxis}px)`,zIndex:V.value?100:u.event.idx+1};let L=vt(f.value.fromTime,f.value.toTime)*M;L<va&&(L=fa),L+="px";let x=Ye(f.value.fromTime)*M,W=f.value.hallNumber,ee=Y.value||V.value?"100%":`${93-W*20}%`,ae=Y.value||V.value?"0":`${W*20}%`,oe=Y.value||V.value?100:(u.event.idx||1)*W+1;return{height:L,top:x+"px",zIndex:oe,left:ae,width:ee,transform:`translate(${c.xAxis}px, ${c.yAxis}px)`}}),D=R(()=>{let v=u.event.color||"green";return v=C(v),{"--bg":v.bg,"--text":v.text,"--subtext":v.subtext,"--text-active":v.textActive,"--subtext-active":v.subtextActive,"--bg-hover":v.bgHover,"--bg-active":v.bgActive}}),i=R(()=>{let v=u.event.color||"green";return v=C(v),{"--border":v.border,"--border-active":v.borderActive}}),S=()=>{const v=document.documentElement.getAttribute("data-theme");return v||(document.documentElement.classList.contains("htw-dark")?"dark":"light")};function C(v){let L=S()==="dark"?Ot:Me;if(!(v!=null&&v.startsWith("#")))return L[v]||L.green;for(const x of Object.values(L))if(x.color===v)return x;return L.green}const w=O(null),_=O(null),te=R(()=>{if(h.value==="Month")return;if(u.event.isFullDay)return"line-clamp-1";if(!A.value||!w.value||!_.value||!u.event.fromTime&&!u.event.toTime)return;const v=A.value.clientHeight,L=_.value.offsetHeight,x=v-L-8,W=getComputedStyle(w.value),ee=parseFloat(W.lineHeight),ae=Math.max(1,Math.floor(x/ee));return`line-clamp-${Math.min(ae,6)}`}),A=O(null),ne=O(null),{floatingStyles:G}=zt(A,ne,{placement:h.value==="Day"?"top":"right",middleware:[Rt(10),Ut(),Nt()],whileElementsMounted:Wt}),X=O(!1),ve=O(null),Y=O(!1),V=O(!1),P=O(!1);function l(v){let L=parseFloat(v)/M+Ye(f.value.fromTime);return L=Math.floor(L),L>1440&&(L=1440),ze(L)}const g=O(!1);function N(v){Y.value=!0,V.value=!1;let L=f.value.toTime;window.addEventListener("mousemove",x),window.addEventListener("mouseup",W,{once:!0});function x(ee){g.value=!0;let ae=ee.clientY-A.value.getBoundingClientRect().top;A.value.style.height=Math.round(ae/e)*e+"px",A.value.style.width="100%",s.toTime=l(A.value.style.height),f.value.toTime=l(A.value.style.height)}function W(){Y.value=!1,L!==f.value.toTime&&y.updateEventState(f.value),window.removeEventListener("mousemove",x)}}function z(v){v.preventDefault();let L=v.clientY;const x=A.value.getBoundingClientRect();if(Y.value)return;window.addEventListener("mousemove",W),window.addEventListener("mouseup",ee);function W(ae){V.value=!0,g.value=!0,A.value&&(me(),A.value.style.cursor="grabbing",h.value==="Week"&&B(ae.clientX,x),u.event.isFullDay||we(ae.clientY,L,x),f.value.fromTime!==s.fromTime||f.value.toTime!==s.toTime?P.value=!0:P.value=!1)}function ee(ae){ae.preventDefault(),V.value=!1,A.value&&(A.value.style.cursor="pointer",f.value.isFullDay&&h.value==="Week"&&(A.value.style.width="90%"),f.value.date!==s.date&&(P.value=!0),P.value&&(f.value.date=s.date,f.value.fromDate=s.date,f.value.toDate=s.date,f.value.fromDateTime=s.date+" "+s.fromTime,f.value.toDateTime=s.date+" "+s.toTime,f.value.fromTime=s.fromTime,f.value.toTime=s.toTime,y.updateEventState(f.value),P.value=!1,c.xAxis=0,c.yAxis=0),window.removeEventListener("mousemove",W),window.removeEventListener("mouseup",ee))}}function I(v,L=0){return new Date(v.getFullYear(),v.getMonth(),v.getDate()+L)}function B(v,L){const x=new Date(A.value.parentNode.getAttribute("data-date-attr"));u.event.isFullDay&&(A.value.style.width="100%");let W=A.value.clientWidth,ee=Math.floor((v-L.left)/W);const ae=x.getDay(),oe=6-x.getDay();ee=ge(ee,ae,oe);let d=Math.ceil(ee*W);c.xAxis=d,s.date=ce(I(x,ee))}function ge(v,L,x){return v<-L?v=-L:v>x&&(v=x),v}function we(v,L,x){let W=v-L,ee=A.value.parentNode.getBoundingClientRect().top,ae=A.value.parentNode.getBoundingClientRect().bottom;v<ee&&(W=ee-x.top),v>ae&&(W=ae-x.bottom),W=Math.round(W/e)*e,c.yAxis=W,s.fromTime=ze(Ye(f.value.fromTime)+Math.round(W/M)),s.toTime=ze(Ye(f.value.toTime)+Math.round(W/M)),fe()}function fe(){s.fromTime<"00:00:00"&&(s.fromTime="00:00:00"),s.fromTime>"24:00:00"&&(s.fromTime="24:00:00"),s.toTime<"00:00:00"&&(s.toTime="00:00:00"),s.toTime>"24:00:00"&&(s.toTime="24:00:00")}const pe=()=>X.value=!X.value,me=()=>X.value=!1;function p(v){(v.key==="Delete"||v.key==="Backspace")&&(X.value=!1,Se())}Ee(()=>X.value,v=>{if(v){if(!n.isEditMode||!n.enableShortcuts)return;document.addEventListener("keydown",p,{once:!0})}});let b=null;function Q(v){if(g.value){g.value=!1;return}v.detail===1&&(b=setTimeout(()=>{y.props.onClick?y.props.onClick({e:v,calendarEvent:f.value}):pe()},200))}const ue=O(!1);function xe(v=null){if(v&&(v.cancelBubble=!0),clearTimeout(b),y.props.onDblClick){y.props.onDblClick({e:v,calendarEvent:f.value});return}n.isEditMode&&(me(),ue.value=!0)}function Se(){y.deleteEvent(f.value.id),me()}const Ve=R(()=>{try{const v=f.value.toDate||f.value.date||f.value.fromDate||u.event.toDate||u.event.date||u.event.fromDate;if(!v)return!1;let L="00:00:00";return f.value.isFullDay||u.event.isFullDay?L="23:59:59":f.value.toTime&&(L=f.value.toTime),new Date(`${v}T${L}`.replace(" ","T")).getTime()<new Date().getTime()}catch{return!1}});return(v,L)=>{var x,W,ee,ae;return t(),m(J,null,[a(h)!=="Month"?(t(),m("div",Ne({key:0,class:"event min-h-6 mx-px shadow rounded transition-all duration-75 shrink-0",ref_key:"eventRef",ref:A},v.$attrs,{class:[X.value&&"!z-20 drop-shadow-xl",a(be)==(((x=u.event)==null?void 0:x.id)||((W=u.event)==null?void 0:W.name))&&"active"],style:[$.value,D.value],onDblclick:L[0]||(L[0]=re(oe=>xe(oe),["prevent"])),onClick:L[1]||(L[1]=re(oe=>Q(oe),["prevent"]))},qt({mousedown:a(n).isEditMode&&z},!0)),[o("div",{class:ie(["flex gap-1.5 h-full p-[5px]",Ve.value&&"past"])},[u.event.fromTime?(t(),m("div",{key:0,class:"event-border h-full w-[2px] rounded shrink-0",style:De(i.value)},null,4)):H("",!0),o("div",oa,[a(n).showIcon&&a(E)[u.event.type]?(t(),m("div",sa,[a(E)[u.event.type]?(t(),U(Le(a(E)[u.event.type]),{key:0,class:"h-4 w-4"})):H("",!0)])):H("",!0),o("div",ra,[o("p",{ref_key:"eventTitleRef",ref:w,class:ie(["text-sm font-medium event-title",te.value])},Z(u.event.title||"(No title)"),3),u.event.isFullDay?H("",!0):(t(),m("p",{key:0,ref_key:"eventTimeRef",ref:_,class:"text-xs font-normal event-subtitle"},Z(a(Zt)(s.fromTime,s.toTime,a(n).timeFormat)),513))])])],2),a(n).isEditMode&&!r.event.isFullDay?(t(),m("div",{key:0,class:"absolute -bottom-1 h-3 w-full cursor-ns-resize",ref_key:"resize",ref:ve,onMousedown:N},null,544)):H("",!0)],16)):(t(),m("div",Ne({key:1,class:["event flex gap-1.5 min-h-6 mx-px rounded p-[5px] transition-all duration-75",[a(be)==(((ee=u.event)==null?void 0:ee.id)||((ae=u.event)==null?void 0:ae.name))&&"active",Ve.value&&"past"]],ref_key:"eventRef",ref:A},v.$attrs,{onDblclick:L[2]||(L[2]=re(oe=>xe(oe),["prevent"])),onClick:L[3]||(L[3]=re(oe=>Q(oe),["stop"])),style:D.value}),[u.event.fromTime?(t(),m("div",{key:0,class:"event-border w-[2px] rounded shrink-0",style:De(i.value)},null,4)):H("",!0),o("div",ia,[a(n).showIcon&&a(E)[u.event.type]?(t(),m("div",ua,[a(E)[u.event.type]?(t(),U(Le(a(E)[u.event.type]),{key:0,class:"h-4 w-4 text-black"})):H("",!0)])):H("",!0),o("div",da,[o("p",ca,Z(u.event.title||"New Event"),1)])])],16)),X.value?(t(),m("div",{key:2,ref_key:"floating",ref:ne,style:De({...a(G),zIndex:100}),class:"rounded shadow-xl"},[k(na,{calendarEvent:f.value,date:r.date,isEditMode:a(n).isEditMode,onClose:me,onEdit:xe,onDelete:Se,class:"shadow-xl"},null,8,["calendarEvent","date","isEditMode"])],4)):H("",!0),k(wt,{modelValue:ue.value,"onUpdate:modelValue":L[4]||(L[4]=oe=>ue.value=oe),event:s},null,8,["modelValue","event"])],64)}}},Fe=$e(ma,[["__scopeId","data-v-93d3f327"]]),pa={__name:"ShowMoreCalendarEvent",props:{events:{type:Array,required:!0},date:{type:String,required:!0},totalEventsCount:{type:Number,required:!0}},emits:["showMoreEvents"],setup(r,{emit:u}){const h=u;return(n,y)=>(t(),m(J,null,[(t(!0),m(J,null,se(r.events.slice(0,2),j=>(t(),U(Fe,Ne({key:j.id,event:j,date:r.date,class:"mb-1 cursor-pointer"},{ref_for:!0},n.$attrs),null,16,["event","date"]))),128)),r.totalEventsCount>2?(t(),m("span",{key:0,class:"w-fit rounded-sm p-px px-2 mx-px text-base font-medium text-ink-gray-6 hover:cursor-pointer hover:bg-surface-gray-1",onClick:y[0]||(y[0]=j=>h("showMoreEvents"))},Z(r.totalEventsCount-2)+" more ",1)):H("",!0)],64))}},ya={class:"flex flex-1 flex-col overflow-scroll"},ga={class:"grid w-full grid-cols-7"},ha={class:"inline-flex items-center justify-center text-base text-ink-gray-6 h-8"},Da=["onDrop","onClick"],xa={class:"flex gap-0.5 w-full flex-col items-center text-xs text-right"},wa=["onClick"],ba={key:0,class:"flex w-full flex-col justify-between"},ka={key:1,class:"flex w-full flex-col justify-between"},Ca={__name:"CalendarMonthly",props:{events:{type:Object,required:!0},currentMonthDates:{type:Array,required:!0},currentMonth:{type:Number,required:!0},config:{type:Object}},emits:["setCurrentDate"],setup(r,{emit:u}){const h=r,n=u,y=R(()=>Pe(h.events,"Month").timedEvents.value),j=R(()=>h.currentMonthDates.length>35?1:2);function f($){return $.getMonth()===h.currentMonth}function s($){let D=!1;return $.getMonth()===h.currentMonth-1&&(D=!0),D}function E($){let D=!1;return $.getMonth()===h.currentMonth+1&&(D=!0),D}const M=Ce("calendarActions"),e=($,D)=>{D&&($.target.style.opacity="0.5",$.target.style.cursor="move",$.dataTransfer.dropEffect="move",$.dataTransfer.effectAllowed="move",$.dataTransfer.setData("calendarEventID",D))},c=($,D)=>{let i=$.dataTransfer.getData("calendarEventID");if(!i)return;$.target.style.cursor="default";let S=h.events.find(w=>w.id===i);if(ce(D)===S.date)return;let C=h.events.find(w=>w.id===i);C.date=ce(D),C.fromDate=C.date,C.toDate=C.date,C.fromDateTime=C.date+" "+C.fromTime,C.toDateTime=C.date+" "+C.toTime,M.updateEventState(C)};return($,D)=>(t(),m("div",ya,[o("div",ga,[(t(!0),m(J,null,se(a(mt),i=>(t(),m("span",ha,Z(i),1))),256))]),o("div",{class:ie(["grid w-full flex-1 grid-cols-7 border-outline-gray-1",[r.currentMonthDates.length>35?"grid-rows-6":"grid-rows-5",!r.config.noBorder&&"border-[0.5px]"]])},[(t(!0),m(J,null,se(r.currentMonthDates,(i,S)=>{var C;return t(),m("div",{class:ie(["overflow-y-auto",[r.config.noBorder?"border-l border-t border-0":"border-[0.5px]",r.config.noBorder&&S%7===0&&"border-l-0",a(pt)(i,r.config)&&"bg-surface-gray-1"]]),onDragover:D[4]||(D[4]=re(()=>{},["prevent"])),onDrageneter:D[5]||(D[5]=re(()=>{},["prevent"])),onDrop:w=>c(w,i),onClick:w=>a(M).handleCellClick(w,i)},[o("div",{class:ie(["flex justify-center font-normal",f(i)?"text-gray-700":"text-gray-200"])},[o("div",xa,[o("span",{class:ie(["z-10 w-full flex justify-between items-center",[i.toDateString()===new Date().toDateString()?"p-[3px] pb-0.5":"p-2"]])},[D[6]||(D[6]=o("div",null,null,-1)),o("div",{class:ie(["cursor-pointer",[i.toDateString()===new Date().toDateString()?"flex items-center justify-center bg-surface-gray-7 text-ink-white rounded size-[25px]":"bg-surface-white ",f(i)?"text-ink-gray-6":"text-ink-gray-4"]]),onClick:re(w=>f(i)?a(M).updateActiveView("Day",i):a(M).updateActiveView("Day",i,s(i),E(i)),["stop"])},Z(i.getDate()),11,wa)],2),((C=y.value[a(ce)(i)])==null?void 0:C.length)<=j.value?(t(),m("div",ba,[(t(!0),m(J,null,se(y.value[a(ce)(i)],w=>(t(),U(Fe,{event:w,date:i,class:"z-10 mb-2 cursor-pointer",key:w.id,draggable:r.config.isEditMode,onDragstart:_=>e(_,w.id),onDragend:D[0]||(D[0]=_=>_.target.style.opacity="1"),onDragover:D[1]||(D[1]=re(()=>{},["prevent"]))},null,8,["event","date","draggable","onDragstart"]))),128))])):(t(),m("div",ka,[y.value[a(ce)(i)]?(t(),U(pa,{key:0,class:"z-10 cursor-pointer",draggable:r.config.isEditMode,onDragstart:w=>e(w,y.value[a(ce)(i)][0].id),onDragend:D[2]||(D[2]=w=>w.target.style.opacity="1"),onDragover:D[3]||(D[3]=re(()=>{},["prevent"])),events:y.value[a(ce)(i)],date:i,totalEventsCount:y.value[a(ce)(i)].length,onShowMoreEvents:w=>n("setCurrentDate",i)},null,8,["draggable","onDragstart","events","date","totalEventsCount","onShowMoreEvents"])):H("",!0)]))])],2)],42,Da)}),256))],2)]))}},Ta={__name:"CalendarTimeMarker",props:{date:{type:[String,Date],required:!0}},setup(r){const n=Ce("config").hourHeight/60,y=R(()=>{let j=new Date,f=j.getHours(),s=j.getMinutes();return{top:(f*60+s)*n+"px"}});return(j,f)=>new Date(r.date).toDateString()===new Date().toDateString()?(t(),m("div",{key:0,class:"absolute top-20 z-10 w-full px-px",style:De(y.value)},[k(yt,{text:a(de)().format("ddd, MMM D, YYYY h:mm a")},{default:K(()=>[...f[0]||(f[0]=[o("div",{class:"current-time relative h-0.5 bg-[#E03636] rounded"},null,-1)])]),_:1},8,["text"])],4)):H("",!0)}},bt=$e(Ta,[["__scopeId","data-v-2ef223eb"]]),_a={class:"flex flex-1 flex-col overflow-y-auto"},Ma={class:"flex border-b-[1px]"},Ea={class:"grid w-full grid-cols-7"},$a=["onClick"],Sa={key:0,class:"inline-flex items-center justify-center bg-surface-gray-7 text-ink-white rounded size-[25px]"},Va={class:"flex justify-center items-start py-0.5 w-20 text-base text-ink-gray-6 text-center"},Aa={class:"grid w-full grid-cols-7 overflow-hidden"},La=["data-date-attr","onClick"],Fa={class:"flex"},Ha={class:"grid w-20 grid-cols-1"},Ia={class:"relative flex w-full flex-col"},Ya={class:"grid w-full grid-cols-7"},Ba=["data-date-attr"],ja=["data-time-attr","onClick"],Pa={__name:"CalendarWeekly",props:{events:{type:Object,required:!0},config:{type:Object},weeklyDates:{type:Array,required:!1}},setup(r){const u=r,h=O(null),n=O(!1),y=O(!0),j=u.config.hourHeight,f=j/60,s=u.config.timeFormat=="24h"?gt:ht,E=R(()=>Pe(u.events).timedEvents.value),M=R(()=>Pe(u.events).fullDayEvents.value),e=C=>new Date(C).toDateString()===new Date().toDateString(),c=R(()=>{let C=new Date,w=C.getHours(),_=C.getMinutes();return{top:(w*60+_)*f+"px"}}),$=Ce("calendarActions");function D(C,w){let _={},te=Object.keys(C);return w.forEach(A=>{A=ce(A),te.includes(A)&&(_[A]=C[A])}),_}function i(C){let w=[];return Object.values(C).forEach(te=>{w.push(te.length)}),Math.max(...w,1)}function S(C,w){let _=D(C,w);i(_)>3?n.value=!0:n.value=!1}return He(()=>{S(M.value,u.weeklyDates);const C=new Date().getHours(),w=u.config.scrollToHour||C;h.value.scrollBy(0,w*60*f-10)}),Ee(()=>M.value,C=>{S(C,u.weeklyDates)}),Ee(()=>u.weeklyDates,C=>{S(M.value,C)}),(C,w)=>(t(),m("div",_a,[o("div",Ma,[w[3]||(w[3]=o("div",{class:"w-20"},null,-1)),o("div",Ea,[(t(!0),m(J,null,se(r.weeklyDates,_=>(t(),m("span",{class:"relative flex items-center justify-center gap-1.5 h-8 text-center text-base text-ink-gray-7 cursor-pointer",onClick:te=>a($).updateActiveView("Day",_)},[Re(Z(e(_)?a(mt)[_.getDay()]:a(Kt)(_))+" ",1),e(_)?(t(),m("span",Sa,Z(_.getDate()),1)):H("",!0)],8,$a))),256))])]),o("div",{class:ie(["flex shrink-0 h-fit",[r.config.noBorder?"border-b-[1px]":"border-[1px] border-t-0"]])},[o("div",Va,[(t(),U(Le(n.value?a(ke):"div"),{class:ie({"!pl-1.5 pr-1 py-1 !gap-1":n.value}),variant:"ghost",iconRight:n.value?y.value?"chevron-down":"chevron-up":"",onClick:w[0]||(w[0]=_=>n.value&&(y.value=!y.value))},{default:K(()=>[...w[4]||(w[4]=[o("div",{class:"text-sm text-ink-gray-6 h-[29px] inline-flex items-center"}," All day ",-1)])]),_:1},8,["class","iconRight"]))]),o("div",Aa,[(t(!0),m(J,null,se(r.weeklyDates,(_,te)=>{var A,ne,G;return t(),m("div",{class:"cell flex flex-col gap-1 py-1 w-full cursor-pointer","data-date-attr":_,onClick:re(X=>{var ve;((ve=M.value[a(ce)(_)])==null?void 0:ve.length)>1&&(y.value=!1),a($).handleCellClick(X,_,"",!0)},["prevent"])},[(t(!0),m(J,null,se(!n.value||!y.value?M.value[a(ce)(_)]:(A=M.value[a(ce)(_)])==null?void 0:A.slice(0,2),(X,ve)=>(t(),U(Fe,{class:"w-[90%] cursor-pointer",event:{...X,idx:ve},key:X.id,date:_,onClick:w[1]||(w[1]=re(()=>{},["stop"]))},null,8,["event","date"]))),128)),n.value&&y.value&&((ne=M.value[a(ce)(_)])==null?void 0:ne.length)>2?(t(),U(a(ke),{key:0,label:((G=M.value[a(ce)(_)])==null?void 0:G.length)-2+" more",variant:"ghost",class:"w-fit text-sm !py-0.5 !h-5 !justify-start cursor-pointer",onClick:w[2]||(w[2]=re(X=>y.value=!1,["stop"]))},null,8,["label"])):H("",!0)],8,La)}),256))])],2),o("div",{class:ie(["relative flex h-full flex-col overflow-auto border-outline-gray-1",[r.config.noBorder?"":"border-b-[1px] border-l-[1px]"]]),ref_key:"gridRef",ref:h},[o("div",Fa,[o("div",Ha,[(t(),m(J,null,se(24,_=>o("span",{class:"flex items-end justify-center text-center text-sm font-normal text-ink-gray-5",style:De({height:`${a(j)}px`})},null,4)),64))]),o("div",Ia,[o("div",{class:"w-[calc(100%-4px)] h-px z-[2] left-0.5 mt-[0.5px] bg-[#F79596] absolute",style:De(c.value)},null,4),o("div",Ya,[(t(!0),m(J,null,se(r.weeklyDates,(_,te)=>(t(),m("div",{class:ie(["relative w-full border-outline-gray-1",[te===0&&"calendar-column border-l-[1px]",r.config.noBorder&&te===r.weeklyDates.length-1?"":"border-r-[1px]",a(pt)(_,r.config)&&"bg-surface-gray-1"]]),"data-date-attr":_},[(t(!0),m(J,null,se(a(s),(A,ne)=>(t(),m("div",{class:"cell relative flex cursor-pointer text-ink-gray-8",key:A,"data-time-attr":ne==0?"":A,onClick:re(G=>a($).handleCellClick(G,_,A),["prevent"])},[o("div",{class:ie(["border-outline-gray-1 w-full",ne!==a(s).length-1&&"border-b-[1px]"]),style:De({height:`${a(j)}px`})},null,6)],8,ja))),128)),(t(!0),m(J,null,se(E.value[a(ce)(_)],(A,ne)=>(t(),U(Fe,{class:"absolute mb-2 w-[90%] cursor-pointer",event:A,key:A.id,date:_},null,8,["event","date"]))),128)),k(bt,{date:_},null,8,["date"])],10,Ba))),256))])])])],2)]))}},Oa={class:"flex flex-col flex-1 overflow-y-auto"},za={class:"flex justify-center items-start pt-[3px] w-20 text-base text-ink-gray-6 text-center"},Ra=["data-date-attr"],Ua={class:"h-full overflow-hidden"},Na={class:"grid h-full w-20 grid-cols-1"},Wa={class:"grid h-full w-full grid-cols-1 pb-2"},qa=["data-time-attr","onClick"],Za={__name:"CalendarDaily",props:{events:{type:Object,required:!1},config:{type:Object},currentDate:{type:Object,required:!0}},setup(r){const u=r,h=R(()=>Pe(u.events).timedEvents.value),n=R(()=>Pe(u.events).fullDayEvents.value),y=O(null),j=u.config.hourHeight,f=j/60,s=O(!1),E=O(!0),M=R(()=>{var D;return((D=n.value)==null?void 0:D[ce(u.currentDate)])||[]});function e(){s.value=M.value.length>4,s.value||(E.value=!0)}Ee(M,e,{immediate:!0});const c=u.config.timeFormat=="24h"?gt:ht;He(()=>{const D=new Date().getHours(),i=u.config.scrollToHour||D;y.value.scrollBy(0,i*60*f-10)});const $=Ce("calendarActions");return(D,i)=>(t(),m("div",Oa,[o("div",{class:ie(["flex shrink-0 h-fit",[r.config.noBorder?"border-t-[1px]":"border-[1px] border-b-0"]])},[o("div",za,[(t(),U(Le(s.value?a(ke):"div"),{class:ie({"!pl-1.5 pr-1 py-1 !gap-1":s.value}),variant:"ghost",iconRight:s.value?E.value?"chevron-down":"chevron-up":"",onClick:i[0]||(i[0]=S=>s.value&&(E.value=!E.value))},{default:K(()=>[...i[4]||(i[4]=[o("div",{class:"text-sm text-ink-gray-6 h-7 inline-flex items-center"}," All day ",-1)])]),_:1},8,["class","iconRight"]))]),o("div",{class:"flex flex-wrap gap-1 py-1 w-full overflow-hidden","data-date-attr":r.currentDate,onClick:i[3]||(i[3]=re(S=>a($).handleCellClick(S,r.currentDate,"",!0),["prevent"]))},[(t(!0),m(J,null,se(!s.value||!E.value?M.value:M.value.slice(0,4),(S,C)=>(t(),U(Fe,{class:"w-[21%] cursor-pointer",event:{...S,idx:C},key:S.id,date:r.currentDate,onClick:i[1]||(i[1]=re(()=>{},["stop"]))},null,8,["event","date"]))),128)),s.value&&E.value&&M.value.length>4?(t(),U(a(ke),{key:0,label:M.value.length-4+" more",variant:"ghost",class:"w-fit text-sm !h-6 !justify-start cursor-pointer",onClick:i[2]||(i[2]=re(S=>E.value=!1,["stop"]))},null,8,["label"])):H("",!0)],8,Ra)],2),o("div",Ua,[o("div",{class:ie(["flex h-full w-full overflow-scroll border-outline-gray-1",[r.config.noBorder?"border-t-[1px]":"border-[1px] border-r-0"]]),ref_key:"gridRef",ref:y},[o("div",Na,[(t(),m(J,null,se(24,S=>o("span",{class:"flex h-[72px] items-end justify-center text-center text-sm font-normal text-ink-gray-5",style:De({height:`${a(j)}px`})},null,4)),64))]),o("div",Wa,[o("div",{class:ie(["calendar-column relative border-l-[1px] border-outline-gray-1",[r.config.noBorder?"":" border-r-[1px]"]])},[(t(!0),m(J,null,se(a(c),(S,C)=>(t(),m("div",{class:"relative flex text-ink-gray-8",key:S,"data-time-attr":C==0?"":S,onClick:w=>a($).handleCellClick(w,r.currentDate,S)},[o("div",{class:ie(["w-full border-outline-gray-1",C!==a(c).length-1&&"border-b-[1px]"]),style:De({height:`${a(j)}px`})},null,6)],8,qa))),128)),(t(!0),m(J,null,se(h.value[a(ce)(r.currentDate)],(S,C)=>(t(),U(Fe,{class:"absolute mb-2 cursor-pointer",event:S,key:S.id,date:r.currentDate},null,8,["event","date"]))),128)),k(bt,{date:r.currentDate},null,8,["date"])],2)])],2)])]))}};function Ka(){const r=O(!1),u=We({date:"",participant:"",fromDate:"",toDate:"",fromTime:"",toTime:"",venue:"",title:"",isFullDay:!1});function h(n,y,j,f,s="",E=!1){if(!f)return;if(j=y==="Week"?n.target.parentNode.parentNode.getAttribute("data-date-attr"):j,u.date=ce(new Date(j)),u.fromDate=j,u.toDate=j,u.isFullDay=E,y==="Month"){r.value=!0;return}let M=ze(Ye(s)+60).slice(0,-3);u.fromTime=s,u.toTime=M,r.value=!0}return{showEventModal:r,newEvent:u,openNewEventModal:h}}const Xa={class:"flex h-full flex-col overflow-hidden"},Ja={class:"mb-2 flex justify-between"},Ga={class:"flex items-center"},Qa={class:"flex gap-x-1"},el={__name:"Calendar",props:{events:{type:Object,required:!1,default:[]},config:{type:Object},onClick:{type:Function,required:!1},onDblClick:{type:Function,required:!1},onCellClick:{type:Function,required:!1}},emits:["create","update","delete"],setup(r,{expose:u,emit:h}){const n=r,y=h,f={...{scrollToHour:15,disableModes:[],defaultMode:"Month",isEditMode:!1,eventIcons:{},hourHeight:50,enableShortcuts:!0,showIcon:!0,timeFormat:"12h",weekends:["sunday"]},...n.config};let s=O(f.defaultMode);function E(d,T,F,q){s.value=d,d=="Day"&&T&&(B.value=W(T),F&&Q(),q&&b())}const M=O(de().format("YYYY-MM-DD"));function e(d=""){const T=de(d);M.value=T.format("YYYY-MM-DD"),oe(M.value)}function c(d,T){if(typeof d=="number"&&typeof T=="number"){const F=de(M.value).date();let q=de(`${d}-${String(T+1).padStart(2,"0")}-01`).date(F);q.month()!==T&&(q=q.startOf("month").month(T).endOf("month")),M.value=q.format("YYYY-MM-DD")}}He(()=>{f.enableShortcuts&&window.addEventListener("keydown",$)}),Xt(()=>{window.removeEventListener("keydown",$)});function $(d){d.target.tagName==="INPUT"||d.target.tagName==="TEXTAREA"||d.target.isContentEditable||(d.key.toLowerCase()==="m"&&(s.value="Month"),d.key.toLowerCase()==="w"&&(s.value="Week"),d.key.toLowerCase()==="d"&&(s.value="Day"),d.key.toLowerCase()==="t"&&oe(),d.key==="ArrowLeft"&&pe(),d.key==="ArrowRight"&&fe())}Ue("activeView",s),Ue("config",f);const D=R(()=>{var d;return((d=n.events)==null?void 0:d.map(T=>{const{fromDate:F,toDate:q,fromTime:le,toTime:ye,...he}=T,Oe=F,Ze=F+" "+le,Ie=q+" "+ye;return{...he,date:Oe,fromDateTime:Ze,toDateTime:Ie,fromDate:F,toDate:q,fromTime:le,toTime:ye}}))||[]}),i=O(D.value);Ee(()=>n.events,()=>S(),{deep:!0});function S(){i.value=D.value}i.value.forEach(d=>{!d.fromTime||!d.toTime||(d.fromTime=qe(d.fromTime),d.toTime=qe(d.toTime))});const{showEventModal:C,newEvent:w,openNewEventModal:_}=Ka();Ue("calendarActions",{createNewEvent:te,updateEventState:A,deleteEvent:ne,handleCellClick:X,updateActiveView:E,props:n});function te(d){i.value.push(d),d.fromDateTime=d.fromDate+" "+d.fromTime,d.toDateTime=d.toDate+" "+d.toTime,y("create",d)}function A(d){const T=d.id;let F=i.value.findIndex(q=>q.id===T);d.fromDateTime=d.fromDate+" "+d.fromTime,d.toDateTime=d.toDate+" "+d.toTime,i.value[F]=d,y("update",d)}function ne(d){const T=i.value.findIndex(F=>F.id===d);i.value.splice(T,1),y("delete",d)}function G(d){const{e:T,view:F,date:q,time:le,isFullDay:ye}=d,he=f.isEditMode;_(T,F,q,he,le,ye)}function X(d,T,F="",q=!1){const le={e:d,view:s.value,date:T,time:F,isFullDay:q};if(n.onCellClick){n.onCellClick(le);return}G(le)}let Y=[{label:"Day",value:"Day",iconLeft:Hn},{label:"Week",value:"Week",iconLeft:jn},{label:"Month",value:"Month",iconLeft:Rn}].filter(d=>!f.disableModes.includes(d.value)),V=O(new Date().getFullYear()),P=O(new Date().getMonth()),l=O(new Date),g=R(()=>Jt(P.value,V.value)),N=R(()=>{let d=[...g.value],T=[];for(;d.length;){let F=d.splice(0,7);T.push(F)}return T});function z(d){return N.value.findIndex(T=>T.find(F=>new Date(F).toLocaleDateString().split("T")[0]===new Date(d).toLocaleDateString().split("T")[0]))}let I=O(z(l.value)),B=O(g.value.findIndex(d=>new Date(d).toDateString()===l.value.toDateString())),ge=R(()=>g.value[B.value]);function we(d){s.value="Day",B.value=W(d),I.value=z(d)}function fe(){me[s.value](),c(V.value,P.value)}function pe(){p[s.value](),c(V.value,P.value)}const me={Month:b,Week:ue,Day:Se},p={Month:Q,Week:xe,Day:Ve};function b(){P.value++,P.value>11&&(P.value=0,V.value++),B.value=x(P.value,V.value),I.value=z(g.value[B.value])}function Q(){P.value===0?(P.value=11,V.value--):P.value--,B.value=L(P.value,V.value),I.value=z(g.value[B.value])}function ue(){const d=I.value+1;if(d<N.value.length){I.value=d;const q=N.value[I.value];if(q.some(he=>he.getMonth()!==P.value)){b(),I.value=0;const he=N.value[0],Oe=v(he,P.value);B.value=W(Oe);return}const ye=v(q,P.value);B.value=W(ye);return}b(),I.value=0;const T=N.value[0],F=v(T,P.value);B.value=W(F)}function xe(){const d=I.value-1;if(d>=0){I.value=d;const he=N.value[I.value];if(he.some(Ie=>Ie.getMonth()!==P.value)){Q(),I.value=N.value.length-1;const Ie=N.value[I.value],Ct=v(Ie,P.value);B.value=W(Ct);return}const Ze=v(he,P.value);B.value=W(Ze);return}Q();let T=N.value.length-1;N.value[T].some(he=>he.getMonth()!==P.value)&&T>0&&(T=T-1),I.value=T;const le=N.value[I.value],ye=v(le,P.value);B.value=W(ye)}function Se(){B.value++,(B.value>g.value.length-1||!ae(g.value[B.value]))&&b()}function Ve(){B.value--,(B.value<0||!ae(g.value[B.value]))&&Q()}function v(d,T){return d.find(F=>F.getMonth()===T)||d[0]}function L(d,T){let F=new Date(T,d+1,0);return g.value.findIndex(le=>new Date(le).toDateString()===F.toDateString())}function x(d,T){let F=new Date(T,d,1);return g.value.findIndex(le=>new Date(le).toDateString()===F.toDateString())}function W(d){return g.value.findIndex(T=>new Date(T).toDateString()===new Date(d).toDateString())}const ee=R(()=>{if(s.value==="Day"){const ye=g.value[B.value];if(ye)return de(ye).format("ddd, D MMM YYYY")}if(s.value!=="Week")return Ke(P.value,V.value);const d=N.value[I.value]||[];if(!d.length)return Ke(P.value,V.value);const T=Gt(d);if(T.length===1)return Ke(T[0].month,T[0].year);const F=Qt.map(ye=>ye.slice(0,3)),q=T[0],le=T[T.length-1];return q.year===le.year?`${F[q.month]} - ${F[le.month]} ${q.year}`:`${F[q.month]} ${q.year} - ${F[le.month]} ${le.year}`});function ae(d){return d=new Date(d),d.getMonth()===P.value}function oe(d){const T=d?new Date(d):new Date;T.toString()!=="Invalid Date"&&(V.value=T.getFullYear(),P.value=T.getMonth(),l.value=T,en(()=>{I.value=z(T);const F=W(T);F>=0?B.value=F:B.value=x(P.value,V.value)}))}return u({reloadEvents:S,currentMonthYear:ee,currentYear:V,currentMonth:P,enabledModes:Y,activeView:s,decrement:pe,increment:fe,updateActiveView:E,setCalendarDate:oe,onMonthYearChange:e,selectedMonthDate:M}),(d,T)=>(t(),m("div",Xa,[je(d.$slots,"header",at(lt({currentMonthYear:ee.value,currentYear:a(V),currentMonth:a(P),enabledModes:a(Y),activeView:a(s),decrement:pe,increment:fe,updateActiveView:E,setCalendarDate:oe,onMonthYearChange:e,selectedMonthDate:M.value})),()=>[o("div",Ja,[o("div",Ga,[k(Xe,{modelValue:M.value,"onUpdate:modelValue":T[0]||(T[0]=F=>e(F)),clearable:!1},{target:K(({togglePopover:F})=>[k(a(ke),{variant:"ghost",class:"text-lg font-medium text-ink-gray-7",label:ee.value,iconRight:"chevron-down",onClick:F},null,8,["label","onClick"])]),_:1},8,["modelValue"])]),o("div",Qa,[k(a(ke),{onClick:pe,variant:"ghost",icon:"chevron-left"}),k(a(ke),{label:"Today",onClick:T[1]||(T[1]=F=>oe()),variant:"ghost"}),k(a(ke),{onClick:fe,variant:"ghost",icon:"chevron-right"}),k(a(xt),{buttons:a(Y),class:"ml-2",modelValue:a(s),"onUpdate:modelValue":T[2]||(T[2]=F=>nt(s)?s.value=F:s=F)},null,8,["buttons","modelValue"])])])]),a(s)==="Month"?(t(),U(Ca,{key:0,events:i.value,currentMonth:a(P),currentMonthDates:a(g),config:f,onSetCurrentDate:T[3]||(T[3]=F=>we(F))},null,8,["events","currentMonth","currentMonthDates"])):a(s)==="Week"?(t(),U(Pa,{key:1,events:i.value,weeklyDates:a(N)[a(I)],config:f},null,8,["events","weeklyDates"])):a(s)==="Day"?(t(),U(Za,{key:2,events:i.value,"current-date":a(ge),config:f},{header:K(({parseDateWithDay:F,currentDate:q,fullDay:le})=>[je(d.$slots,"daily-header",at(lt({parseDateWithDay:F,currentDate:q,fullDay:le})))]),_:3},8,["events","current-date"])):H("",!0),a(C)?(t(),U(wt,{key:3,modelValue:a(C),"onUpdate:modelValue":T[4]||(T[4]=F=>nt(C)?C.value=F:null),event:a(w)},null,8,["modelValue","event"])):H("",!0)]))}},tl={},nl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function al(r,u){return t(),m("svg",nl,[...u[0]||(u[0]=[o("path",{d:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM10.75 9.5C10.0172 9.5 9.50422 9.65253 9.12793 9.84277C8.74778 10.035 8.48265 10.2774 8.24707 10.5049C8.08807 10.6584 8.00001 10.8573 8 11.0352V14C10.4873 14 12.6207 12.4863 13.5303 10.3301C12.9601 9.92399 12.0744 9.5 10.75 9.5ZM4.75 9.5C4.01981 9.5 3.50767 9.6516 3.13184 9.84082C2.85955 9.97794 2.64585 10.1409 2.45996 10.3057C3.24038 12.1787 4.94236 13.5697 7 13.915V11.0352C7.00001 10.7133 7.099 10.4099 7.25781 10.1514C6.69171 9.81028 5.88188 9.50007 4.75 9.5ZM8 2C4.68629 2 2 4.68629 2 8C2 8.43945 2.04801 8.8677 2.1377 9.28027C2.29548 9.1649 2.47567 9.05099 2.68164 8.94727C3.2047 8.68387 3.87233 8.5 4.75 8.5C6.21316 8.50007 7.25578 8.94284 7.96582 9.41309C8.16037 9.25535 8.39427 9.09305 8.67676 8.9502C9.20055 8.68539 9.86925 8.5 10.75 8.5C12.1371 8.5 13.144 8.89812 13.8477 9.33789C13.9457 8.90751 14 8.46009 14 8C14 4.68629 11.3137 2 8 2ZM10.5 5.5C11.1875 5.5 11.75 6.0625 11.75 6.75C11.75 7.4375 11.1875 8 10.5 8C9.8125 8 9.25 7.4375 9.25 6.75C9.25 6.0625 9.8125 5.5 10.5 5.5ZM6 4.5C6.825 4.5 7.5 5.175 7.5 6C7.5 6.825 6.825 7.5 6 7.5C5.175 7.5 4.5 6.825 4.5 6C4.5 5.175 5.175 4.5 6 4.5Z",fill:"currentColor"},null,-1)])])}const ll=$e(tl,[["render",al]]),ol={},sl={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function rl(r,u){return t(),m("svg",sl,[...u[0]||(u[0]=[o("path",{d:"M7.66699 12.7109C7.89499 12.7574 8.06641 12.9594 8.06641 13.2012C8.06625 13.4428 7.89489 13.6449 7.66699 13.6914L7.56641 13.7012H1.5C1.22406 13.7011 1.00018 13.4771 1 13.2012C1 12.9251 1.22395 12.7013 1.5 12.7012H7.56641L7.66699 12.7109ZM14.6006 9.24414C14.8284 9.29081 15 9.4928 15 9.73438C14.9999 9.97585 14.8283 10.178 14.6006 10.2246L14.5 10.2344H1.5C1.22403 10.2343 1.00013 10.0103 1 9.73438C1 9.4583 1.22395 9.23448 1.5 9.23438H14.5L14.6006 9.24414ZM3.56934 2.45996C3.78682 2.52747 3.96526 2.69406 4.04297 2.91699L5.2168 6.29199C5.31837 6.58437 5.10155 6.88965 4.79199 6.88965H4.77441C4.57659 6.88946 4.40241 6.75957 4.34473 6.57031L4.11133 5.80664H2.53613L2.30273 6.57129C2.24483 6.7604 2.06986 6.88965 1.87207 6.88965H1.85742C1.54804 6.88951 1.33114 6.5843 1.43262 6.29199L2.59961 2.93066C2.70432 2.62909 2.98841 2.42694 3.30762 2.42676H3.56934V2.45996ZM14.6006 5.77734C14.8283 5.82404 15 6.02602 15 6.26758C14.9999 6.50907 14.8283 6.71112 14.6006 6.75781L14.5 6.76758H7.56641C7.29038 6.7675 7.06648 6.5436 7.06641 6.26758C7.06641 5.99149 7.29033 5.76766 7.56641 5.76758H14.5L14.6006 5.77734ZM2.75 5.1084H3.89844L3.35254 3.31738H3.29688L2.75 5.1084ZM14.6006 2.31055C14.8283 2.35723 14.9999 2.55931 15 2.80078C15 3.04233 14.8283 3.24432 14.6006 3.29102L14.5 3.30078H7.56641C7.29033 3.3007 7.06641 3.07687 7.06641 2.80078C7.06651 2.52478 7.2904 2.30086 7.56641 2.30078H14.5L14.6006 2.31055Z",fill:"currentColor"},null,-1)])])}const il=$e(ol,[["render",rl]]);function kt(r){const{active:u=!0,shortcuts:h=[],ignoreTyping:n=!0,target:y=typeof window<"u"?window:null,skipWhenDialogOpen:j=!0}=r||{};function f(M){if(!n)return!1;const e=M.target;if(!e)return!1;const c=e.tagName;return e.isContentEditable||c==="INPUT"||c==="TEXTAREA"||c==="SELECT"||e.closest&&e.closest('[contenteditable="true"]')}function s(M,e){if(M.match)return M.match(e);let c=M.keys;return c?(Array.isArray(c)||(c=[c]),c.some($=>$===e.key)):!1}function E(M){if(!(!y||!(typeof u=="function"?u():a(u)))&&!f(M)&&!(j&&tn())){for(const c of h)if(c&&!(c.guard&&!c.guard(M))&&s(c,M)){c.preventDefault!==!1&&M.preventDefault(),c.stopPropagation&&M.stopPropagation(),c.action&&c.action(M);break}}}return He(()=>{y&&y.addEventListener("keydown",E)}),ft(()=>{y&&y.removeEventListener("keydown",E)}),{stop:()=>y&&y.removeEventListener("keydown",E)}}const ul={class:"rounded bg-surface-gray-7 py-1.5 px-2 text-xs text-ink-white shadow-xl"},dl={class:"flex items-center gap-1"},Be=dt({name:"ShortcutTooltip",__name:"ShortcutTooltip",props:{label:{},combo:{default:""},altCombos:{default:()=>[]},disabled:{type:Boolean,default:!1}},setup(r){const u=r,h=R(()=>{var $;if(typeof navigator>"u")return!1;const c=(($=navigator.userAgentData)==null?void 0:$.platform)||navigator.platform||"";return/Mac|iPod|iPhone|iPad/i.test(c)?!0:/Mac OS X|Macintosh|iPhone|iPad|iPod/i.test(navigator.userAgent||"")});function n(c){if(!c)return"";if(/^mod\+/i.test(c)){const $=c.split("+").slice(1).join("+");return(h.value?"Cmd":"Ctrl")+"+"+$}return c}function y(c){return(Array.isArray(c)?c:c?[c]:[]).map(n)}function j(c,$){if(!h.value)return{primary:c,alts:$};const D=[...c,...$];return D.includes("Delete")&&D.includes("Backspace")?{primary:c.filter(i=>i!=="Delete"),alts:$.filter(i=>i!=="Delete")}:{primary:c,alts:$}}const f=R(()=>y(u.combo)),s=R(()=>u.altCombos.map(n)),E=R(()=>j(f.value,s.value)),M=R(()=>E.value.primary),e=R(()=>E.value.alts);return(c,$)=>r.disabled?je(c.$slots,"default",{key:1}):(t(),U(a(yt),{key:0},{body:K(()=>[o("div",ul,[o("span",dl,[o("span",null,Z(r.label),1),(t(!0),m(J,null,se(M.value,(D,i)=>(t(),U(a(ut),{key:"prim-"+i+D,bg:"",class:"!bg-surface-gray-5 !text-ink-gray-2 px-1",combo:D},null,8,["combo"]))),128)),(t(!0),m(J,null,se(e.value,(D,i)=>(t(),U(a(ut),{key:"alt-"+i+D,bg:"",class:"!bg-surface-gray-5 !text-ink-gray-2 px-1",combo:D},null,8,["combo"]))),128))])])]),default:K(()=>[je(c.$slots,"default")]),_:3}))}}),cl={key:0,class:"flex flex-col w-[352px] text-base"},vl={class:"flex items-center justify-between p-4.5 text-ink-gray-7 text-lg font-medium"},fl={class:"flex items-center gap-x-1"},ml={key:0,class:"flex flex-col overflow-y-auto"},pl={class:"flex flex-col gap-[3px]"},yl={class:"text-ink-gray-8 font-semibold text-xl"},gl={class:"text-ink-gray-6 text-p-base"},hl={key:0,class:"mx-4.5 my-2.5 border-t border-outline-gray-1"},Dl={key:1,class:"flex items-center px-4.5 py-1 text-ink-gray-7"},xl={key:2,class:"mx-4.5 my-2.5 border-t border-outline-gray-1"},wl={key:3,class:"px-4.5 py-2"},bl={class:"flex gap-3 text-ink-gray-7 mb-3"},kl={class:"flex flex-col gap-2 -ml-1"},Cl={class:"flex flex-col justify-start items-start text-sm"},Tl={class:"text-ink-gray-5"},_l={key:4,class:"mx-4.5 my-2.5 border-t border-outline-gray-1"},Ml={key:5},El={class:"flex gap-2 items-center text-ink-gray-7 px-4.5 py-1"},$l=["innerHTML"],Sl={key:1,class:"flex flex-col overflow-y-auto"},Vl={class:"flex gap-2 items-center px-4.5 py-3"},Al={class:"flex items-center justify-center size-7 shrink-0 border border-outline-gray-2 bg-surface-white hover:border-outline-gray-3 hover:shadow-sm rounded cursor-pointer"},Ll={class:"flex justify-between py-2.5 px-4.5 text-ink-gray-6"},Fl={class:"flex items-center"},Hl={class:"ml-2"},Il={class:"flex items-center justify-between px-4.5 py-[7px] text-ink-gray-7"},Yl={class:""},Bl={class:"flex items-center gap-x-1.5"},jl={key:0,class:"flex items-center justify-between px-4.5 py-[7px] text-ink-gray-7"},Pl={class:"w-20"},Ol={class:"flex items-center gap-x-1.5"},zl={class:"flex items-center justify-between px-4.5 py-[7px] text-ink-gray-7"},Rl={class:""},Ul={class:"flex items-center gap-x-1.5"},Nl={key:1,class:"flex items-center justify-between px-4.5 py-[7px] text-ink-gray-7"},Wl={class:""},ql={class:"flex items-center gap-x-1.5"},Zl={class:"px-4.5 py-3"},Kl={class:"flex items-center gap-x-2 border rounded py-1"},Xl={key:2,class:"px-4.5 py-3"},Jl={class:"w-full"},Gl={__name:"CalendarEventPanel",props:ot({mode:{type:String,default:"details"}},{modelValue:{},modelModifiers:{},event:{},eventModifiers:{}}),emits:ot(["save","edit","delete","details","close","sync","duplicate"],["update:modelValue","update:event"]),setup(r,{expose:u,emit:h}){const n=r,y=h,j=nn(),{$dialog:f}=Dt(),s=st(r,"modelValue"),E=st(r,"event"),M=Ce("events"),e=O({}),c=R({get(){return e.value.event_participants||[]},set(p){e.value.event_participants=Tt(p),G()}}),$=R(()=>n.mode==="details"?__("Event details"):n.mode==="edit"?__("Editing event"):n.mode==="new"?__("New event"):__("Duplicate event")),D=O(null),i=O(null),S=O(!1),C=O({}),w=O(null),_=R(()=>JSON.stringify(w.value)!==JSON.stringify(e.value)),te=R(()=>S.value?c.value:c.value.slice(0,2));Ee([()=>n.mode,()=>E.value],([p,b],[Q,ue])=>{i.value=null,ne(),A(Q)},{immediate:!0});function A(p){E.value.id&&E.value.id!=="new-event"&&E.value.id!=="duplicate-event"?(C.value=an({doctype:"Event",name:E.value.id,fields:["*"],onSuccess:b=>{e.value=Je(b),w.value={...e.value}}}),C.value.doc&&!E.value.reloadEvent?(e.value=Je(C.value.doc),w.value={...e.value}):C.value.reload()):(e.value=E.value,p!==n.mode&&(w.value={...E.value}),E.value.id==="duplicate-event"&&p!=="duplicate"&&(e.value.title=e.value.title+" (Copy)")),S.value=!1}function ne(){setTimeout(()=>{var p,b;["edit","new","duplicate"].includes(n.mode)&&((b=(p=D.value)==null?void 0:p.el)==null||b.focus())},100)}function G(){y("sync",e.value.id,e.value)}function X(p){e.value.fromDate=p,e.value.toDate=p,G()}function ve(p,b=!1){i.value=null;const Q=e.value.toTime;b?(e.value.fromTime=p,(!e.value.toTime||e.value.toTime<=p)&&(e.value.toTime=Mt(p))):e.value.toTime=p;const{valid:ue,error:xe}=Ge({fromDate:e.value.fromDate,fromTime:e.value.fromTime,toTime:e.value.toTime,isFullDay:e.value.isFullDay});ue?G():(i.value=xe,e.value.toTime=Q)}function Y(){if(!_.value)return;if(i.value=null,!e.value.title){i.value=__("Title is required"),D.value.el.focus();return}const{valid:p,error:b}=Ge({fromDate:e.value.fromDate,fromTime:e.value.fromTime,toTime:e.value.toTime,isFullDay:e.value.isFullDay});if(!p){i.value=b;return}w.value={...e.value},G(),y("save",e.value)}function V(){y("edit",e.value)}function P(){_.value?I(()=>z()):y("duplicate",e.value)}function l(){y("delete",e.value.id)}function g(){_.value?I(()=>z()):y("details",e.value)}function N(){const p=()=>{s.value=!1,be.value="",y("close",e.value)};_.value?I(()=>{z(),["new-event","duplicate-event"].includes(e.value.id)&&p()}):p()}function z(){Object.assign(e.value,w.value),G()}function I(p){f({title:__("Discard unsaved changes?"),message:__("Are you sure you want to discard unsaved changes to this event?"),actions:[{label:__("Cancel"),onClick:b=>{b()}},{label:__("Discard"),variant:"solid",onClick:b=>{p(),b()}}]})}const B=R(()=>{const p=de(e.value.fromDate);if(e.value.isFullDay)return`${__("All day")} - ${p.format("ddd, D MMM YYYY")}`;const b=de(e.value.fromDate+" "+e.value.fromTime),Q=de(e.value.toDate+" "+e.value.toTime);return`${b.format("h:mm a")} - ${Q.format("h:mm a")} ${p.format("ddd, D MMM YYYY")}`}),ge=Object.keys(Me).map(p=>({label:p.charAt(0).toUpperCase()+p.slice(1),value:Me[p].color,icon:ln("div",{class:"!size-2.5 rounded-full",style:{backgroundColor:Me[p].color}}),onClick:()=>{e.value.color=Me[p].color,G()}}));function we(){if(e.value.referenceDocname){let p=e.value.referenceDoctype==="CRM Lead"?"Lead":"Deal",b=e.value.referenceDoctype=="CRM Lead"?{leadId:e.value.referenceDocname}:{dealId:e.value.referenceDocname};j.push({name:p,params:b})}}function fe(p){if(!p)return email;const b=[];return p.reference_doctype&&b.push(p.reference_doctype),p.reference_docname&&b.push(p.reference_docname),b.length?b.join(": "):email}const pe=R(()=>_t(e.value.fromTime));function me(p){Object.assign(e.value,p)}return u({updateEvent:me}),kt({active:()=>s.value,shortcuts:[{keys:"Escape",action:()=>N()},{keys:"Enter",guard:()=>["details","edit"].includes(n.mode)&&n.mode==="details",action:()=>V()},{keys:["Delete","Backspace"],guard:()=>["details","edit"].includes(n.mode),action:()=>l()},{match:p=>["details","edit"].includes(n.mode)&&(p.metaKey||p.ctrlKey)&&!p.shiftKey&&!p.altKey&&p.key.toLowerCase()==="d",action:()=>P()}]}),(p,b)=>{var L;const Q=rn,ue=Ae("Button"),xe=At,Se=Ae("FeatherIcon"),Ve=Ae("FormControl"),v=Et;return s.value?(t(),m("div",cl,[o("div",vl,[o("div",{class:ie(["flex items-center gap-x-2",r.mode=="edit"&&"cursor-pointer hover:text-ink-gray-8"]),onClick:b[0]||(b[0]=x=>r.mode=="edit"&&g())},[r.mode=="edit"?(t(),U(Q,{key:0,class:"size-4"})):H("",!0),Re(" "+Z(p.__($.value)),1)],2),o("div",fl,[r.mode=="details"?(t(),U(Be,{key:0,label:p.__("Edit event"),combo:"Enter"},{default:K(()=>[k(ue,{icon:pn,variant:"ghost",onClick:V})]),_:1},8,["label"])):H("",!0),r.mode==="edit"||r.mode==="details"?(t(),U(Be,{key:1,label:p.__("Delete event"),combo:"Delete","alt-combos":["Backspace"]},{default:K(()=>[k(ue,{icon:"trash-2",variant:"ghost",onClick:l})]),_:1},8,["label"])):H("",!0),r.mode==="edit"||r.mode==="details"?(t(),U(Be,{key:2,label:p.__("Duplicate event"),combo:"Mod+D"},{default:K(()=>[k(ue,{icon:"copy",variant:"ghost",onClick:P})]),_:1},8,["label"])):H("",!0),k(Be,{label:p.__("Close panel"),combo:"Esc"},{default:K(()=>[k(ue,{icon:"x",variant:"ghost",onClick:N})]),_:1},8,["label"])])]),r.mode=="details"?(t(),m("div",ml,[o("div",{class:"flex items-start gap-2 px-4.5 py-3 pb-0",onDblclick:V},[o("div",{class:"mx-0.5 my-[5px] size-2.5 rounded-full cursor-pointer",style:De({backgroundColor:e.value.color||"#30A66D"})},null,4),o("div",pl,[o("div",yl,Z(e.value.title||p.__("(No title)")),1),o("div",gl,Z(B.value),1)])],32),e.value.referenceDocname?(t(),m("div",hl)):H("",!0),e.value.referenceDocname?(t(),m("div",Dl,[(t(),U(Le(e.value.referenceDoctype=="CRM Lead"?fn:mn),{class:"size-4"})),k(rt,{class:"[&_button]:bg-surface-white [&_button]:select-text [&_button]:text-ink-gray-7 [&_button]:cursor-text",modelValue:e.value.referenceDocname,"onUpdate:modelValue":b[1]||(b[1]=x=>e.value.referenceDocname=x),doctype:e.value.referenceDoctype,disabled:!0},null,8,["modelValue","doctype"]),k(ue,{variant:"ghost",onClick:we},{icon:K(()=>[k(vn,{class:"size-4 text-ink-gray-7"})]),_:1})])):H("",!0),c.value.length?(t(),m("div",xl)):H("",!0),c.value.length?(t(),m("div",wl,[o("div",bl,[k(ll,{class:"size-4"}),o("div",null,Z(p.__("{0} Attendees",[c.value.length+1])),1)]),o("div",kl,[(t(),U(ue,{key:e.value.owner,variant:"ghost",theme:"gray",class:"rounded-full w-fit !h-8.5 !pr-3",tooltip:p.__("Owner: {0}",[(L=e.value.owner)==null?void 0:L.label])},{default:K(()=>{var x;return[o("div",Cl,[o("div",null,Z((x=e.value.owner)==null?void 0:x.label),1),o("div",Tl,Z(p.__("Organizer")),1)])]}),prefix:K(()=>{var x;return[k(xe,{user:(x=e.value.owner)==null?void 0:x.value,class:"-ml-1 !size-5"},null,8,["user"])]}),_:1},8,["tooltip"])),(t(!0),m(J,null,se(te.value,x=>(t(),U(ue,{key:x.email,label:x.email,variant:"ghost",theme:"gray",class:"rounded-full w-fit !text-sm",tooltip:fe(x)},{prefix:K(()=>[k(xe,{user:x.email,class:"-ml-1 !size-5"},null,8,["user"])]),_:2},1032,["label","tooltip"]))),128)),!S.value&&c.value.length>2?(t(),U(ue,{key:0,variant:"ghost",label:p.__("See all participants"),iconLeft:"more-horizontal",class:"!justify-start w-fit",onClick:b[2]||(b[2]=x=>S.value=!0)},null,8,["label"])):S.value?(t(),U(ue,{key:1,variant:"ghost",label:p.__("Show less"),iconLeft:"chevron-up",class:"!justify-start w-fit",onClick:b[3]||(b[3]=x=>S.value=!1)},null,8,["label"])):H("",!0)])])):H("",!0),e.value.description&&e.value.description!=="<p></p>"?(t(),m("div",_l)):H("",!0),e.value.description&&e.value.description!=="<p></p>"?(t(),m("div",Ml,[o("div",El,[k(il,{class:"size-4"}),Re(" "+Z(p.__("Description")),1)]),o("div",{class:"px-4.5 py-2 text-ink-gray-7 text-p-base",innerHTML:e.value.description},null,8,$l)])):H("",!0)])):(t(),m("div",Sl,[o("div",Vl,[k(a($t),{class:"ml-1",options:a(ge)},{default:K(()=>[o("div",Al,[o("div",{class:"size-2.5 rounded-full cursor-pointer",style:De({backgroundColor:e.value.color||"#30A66D"})},null,4)])]),_:1},8,["options"]),k(a(sn),{ref_key:"eventTitle",ref:D,class:"w-full",variant:"outline",modelValue:e.value.title,"onUpdate:modelValue":b[4]||(b[4]=x=>e.value.title=x),debounce:500,placeholder:p.__("Event title"),onChange:G,onKeyup:on(Y,["enter"])},null,8,["modelValue","placeholder"])]),o("div",Ll,[o("div",Fl,[k(a(St),{modelValue:e.value.isFullDay,"onUpdate:modelValue":[b[5]||(b[5]=x=>e.value.isFullDay=x),G]},null,8,["modelValue"]),o("div",Hl,Z(p.__("All day")),1)])]),o("div",Il,[o("div",Yl,Z(p.__("Date")),1),o("div",Bl,[k(a(Xe),{class:ie(["[&_input]:w-[216px]"]),variant:"outline",value:e.value.fromDate,format:"MMM D, YYYY",placeholder:p.__("May 1, 2025"),clearable:!1,"onUpdate:modelValue":b[6]||(b[6]=x=>X(x))},{suffix:K(({togglePopover:x})=>[k(Se,{name:"chevron-down",class:"h-4 w-4 cursor-pointer",onClick:x},null,8,["onClick"])]),_:1},8,["value","placeholder"])])]),e.value.isFullDay?H("",!0):(t(),m("div",jl,[o("div",Pl,Z(p.__("Time")),1),o("div",Ol,[e.value.isFullDay?H("",!0):(t(),U(a(it),{key:0,class:"max-w-[105px]",variant:"outline",modelValue:e.value.fromTime,placeholder:p.__("Start Time"),"onUpdate:modelValue":b[7]||(b[7]=x=>ve(x,!0))},null,8,["modelValue","placeholder"])),k(a(it),{class:"max-w-[105px]",variant:"outline",modelValue:e.value.toTime,options:pe.value,placeholder:p.__("End Time"),placement:"bottom-end","onUpdate:modelValue":b[8]||(b[8]=x=>ve(x))},null,8,["modelValue","options","placeholder"])])])),b[14]||(b[14]=o("div",{class:"mx-4.5 my-2.5 border-t border-outline-gray-1"},null,-1)),o("div",zl,[o("div",Rl,Z(p.__("Link")),1),o("div",Ul,[k(Ve,{class:"w-[216px]",type:"select",options:[{label:"",value:""},{label:p.__("Lead"),value:"CRM Lead"},{label:p.__("Deal"),value:"CRM Deal"}],modelValue:e.value.referenceDoctype,"onUpdate:modelValue":b[9]||(b[9]=x=>e.value.referenceDoctype=x),variant:"outline",placeholder:p.__("Add Lead or Deal"),onChange:b[10]||(b[10]=()=>{e.value.referenceDocname="",G()})},null,8,["options","modelValue","placeholder"])])]),e.value.referenceDoctype?(t(),m("div",Nl,[o("div",Wl,Z(e.value.referenceDoctype=="CRM Lead"?p.__("Lead"):p.__("Deal")),1),o("div",ql,[k(rt,{class:"w-[220px]",modelValue:e.value.referenceDocname,"onUpdate:modelValue":[b[11]||(b[11]=x=>e.value.referenceDocname=x),G],doctype:e.value.referenceDoctype,filters:e.value.referenceDoctype==="CRM Lead"?{converted:0}:{},variant:"outline"},null,8,["modelValue","doctype","filters"])])])):H("",!0),b[15]||(b[15]=o("div",{class:"mx-4.5 my-2.5 border-t border-outline-gray-1"},null,-1)),k(v,{class:"px-4.5 py-[7px]",modelValue:c.value,"onUpdate:modelValue":b[12]||(b[12]=x=>c.value=x),validate:a(Vt),"error-message":x=>p.__("{0} is an invalid email address",[x])},null,8,["modelValue","validate","error-message"]),b[16]||(b[16]=o("div",{class:"mx-4.5 my-2.5 border-t border-outline-gray-1"},null,-1)),o("div",Zl,[o("div",Kl,[k(a(yn),{"editor-class":"!prose-sm overflow-auto min-h-[22px] max-h-32 px-2.5 rounded placeholder-ink-gray-4 focus:bg-surface-white focus:ring-0 text-ink-gray-8 transition-colors",bubbleMenu:!0,content:e.value.description,onChange:b[13]||(b[13]=x=>{e.value.description=x,G()}),placeholder:p.__("Add description")},null,8,["content","placeholder"])])])])),r.mode!="details"?(t(),m("div",Xl,[k(a(ct),{class:"my-2",message:i.value},null,8,["message"]),o("div",Jl,[k(ue,{variant:"solid",class:"w-full",disabled:!_.value,loading:r.mode==="edit"?a(M).setValue.loading:a(M).insert.loading,onClick:Y},{default:K(()=>[Re(Z(r.mode==="edit"?p.__("Save"):r.mode==="duplicate"?p.__("Duplicate event"):p.__("Create event")),1)]),_:1},8,["disabled","loading"])])])):H("",!0)])):H("",!0)}}},Ql={class:"flex h-screen overflow-hidden"},eo={class:"my-4 mx-5 flex justify-between"},to={class:"flex items-center"},no={class:"flex gap-x-1"},xo={__name:"Calendar",setup(r){const{user:u}=un(),{$dialog:h}=Dt(),n=O(null),y=dn({doctype:"Event",cache:["calendar",u],fields:["name","status","subject","description","starts_on","ends_on","all_day","event_type","color","reference_doctype","reference_docname"],filters:{status:"Open",owner:u},pageLength:9999,auto:!0,transform:l=>l.map(g=>({id:g.name,title:g.subject,description:g.description,status:g.status,fromDate:de(g.starts_on).format("YYYY-MM-DD"),toDate:de(g.ends_on).format("YYYY-MM-DD"),fromTime:de(g.starts_on).format("HH:mm"),toTime:de(g.ends_on).format("HH:mm"),isFullDay:g.all_day,eventType:g.event_type,color:g.color,referenceDoctype:g.reference_doctype,referenceDocname:g.reference_docname}))});Ue("events",y);const j=O(null),f=O(!1),s=O({}),E=O(""),M=R(()=>["edit","new","duplicate"].includes(E.value)),e=new Set(["new-event","duplicate-event"]),c=l=>e.has(l);function $(){Array.isArray(y.data)&&(y.data=y.data.filter(l=>!c(l.id)))}function D(l,g,N=!1){const z=(l==null?void 0:l.calendarEvent)||l;!(z!=null&&z.id)||c(z.id)||($(),f.value=!0,s.value={id:z.id,reloadEvent:N},be.value=z.id,E.value=g)}function i(l){if(!(l!=null&&l.id)||c(l.id))return C(l);w(l)}function S(l){return{subject:l.title,description:l.description,starts_on:`${l.fromDate} ${l.fromTime}`,ends_on:`${l.toDate} ${l.toTime}`,all_day:l.isFullDay||!1,event_type:l.eventType,color:l.color,reference_doctype:l.referenceDoctype,reference_docname:l.referenceDocname,event_participants:l.event_participants}}function C(l){l!=null&&l.title&&y.insert.submit(S(l),{onSuccess:async g=>{await y.reload(),A({id:g.name})}})}async function w(l,g=!1){if(l.id){if(l.fromTime=de(l.fromTime,"HH:mm").format("HH:mm"),l.toTime=de(l.toTime,"HH:mm").format("HH:mm"),["duplicate","new"].includes(E.value)&&!["duplicate-event","new-event"].includes(l.id)&&g&&(s.value={id:l.id},be.value=l.id,E.value="details"),E.value=="edit"&&g){j.value.updateEvent({fromDate:l.fromDate,toDate:l.toDate,fromTime:l.fromTime,toTime:l.toTime});return}!E.value||E.value=="edit"||E.value==="details"?(Array.isArray(l.event_participants)&&l.event_participants.length&&(l.event_participants=await P(l.event_participants)),y.setValue.submit({name:l.id,...S(l)},{onSuccess:async N=>{await y.reload(),f.value&&A({id:N.name},!0)}})):s.value={...l}}}function _(l){l&&h({title:__("Delete"),message:__("Are you sure you want to delete this event?"),actions:[{label:__("Delete"),variant:"solid",theme:"red",onClick:g=>{y.delete.submit(l,{onSuccess:()=>y.reload()}),f.value=!1,s.value={},be.value="",E.value="",g()}}]})}function te(l,g){l&&Object.assign(y.data.filter(N=>N.id===l)[0],g)}He(()=>{be.value="",E.value="",f.value=!1}),kt({shortcuts:[{match:l=>(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey&&l.key.toLowerCase()==="e",guard:()=>!M.value,action:()=>X({date:de().format("YYYY-MM-DD"),time:de().format("HH:mm"),isFullDay:!1})}]});function A(l,g=!1){D(l,"details",g)}function ne(l){D(l,"edit")}function G(l,g){return{id:g?"duplicate-event":"new-event",title:l.title,description:l.description||"",date:l.fromDate,fromDate:l.fromDate,toDate:l.toDate,fromTime:l.fromTime,toTime:l.toTime,isFullDay:l.isFullDay||!1,eventType:l.eventType||"Public",color:l.color||"green",referenceDoctype:l.referenceDoctype,referenceDocname:l.referenceDocname,event_participants:l.event_participants||[]}}function X(l={},g=!1){$();let N={...l};if(!g){const[z,I]=V(l.time),B=de(l.date).format("YYYY-MM-DD");N={...N,fromDate:B,toDate:B,fromTime:z,toTime:I,isFullDay:l.isFullDay}}s.value=G(N,g),y.data.push(s.value),f.value=!0,be.value=s.value.id,E.value=g?"duplicate":"new"}function ve(l){X(l,!0)}function Y(){f.value=!1,s.value={},be.value="",E.value="",$()}function V(l){const g=fe=>String(fe).padStart(2,"0");let N=de(),z=N.hour(),I=Math.floor(N.minute()/15)*15,B=z,ge=I;if(l){if(/am|pm/i.test(l)){const fe=l.trim().replace(" ",""),pe=fe.slice(-2).toLowerCase();let me=parseInt(fe.slice(0,-2));pe==="pm"&&me<12&&(me+=12),pe==="am"&&me===12&&(me=0),B=me,ge=0}else if(/^\d{1,2}:?\d{0,2}$/.test(l)){const[fe,pe="00"]=l.split(":");B=parseInt(fe),ge=parseInt(pe)||0}}const we=(B+1)%24;return[`${g(B)}:${g(ge)}`,`${g(we)}:${g(ge)}`]}async function P(l){if(!Array.isArray(l)||!l.length)return l;const g=[];for(const N of l){const z={...N};try{if(z.reference_doctype==="Contact"&&(!z.reference_docname||z.reference_docname==="new")&&z.email){const I=z.email.split("@")[0]||z.email,B=await cn("frappe.client.insert",{doc:{doctype:"Contact",first_name:I,email_ids:[{email_id:z.email,is_primary:1}]}});B!=null&&B.name&&(z.reference_docname=B.name)}}catch(I){console.error("Failed creating contact for participant",z.email,I)}g.push(z)}return g}return(l,g)=>{const N=Ae("FeatherIcon"),z=Ae("Button");return t(),m(J,null,[k(hn,null,{"left-header":K(()=>[k(gn,{routeName:"Calendar"})]),"right-header":K(()=>[k(Be,{label:l.__("Create event"),combo:"Mod+E"},{default:K(()=>[k(z,{variant:"solid",label:l.__("Create"),disabled:M.value,onClick:X},{prefix:K(()=>[k(N,{name:"plus",class:"h-4"})]),_:1},8,["label","disabled"])]),_:1},8,["label"])]),_:1}),o("div",Ql,[k(a(el),{class:"flex-1 overflow-hidden",ref_key:"calendar",ref:n,config:{defaultMode:"Week",isEditMode:!0,eventIcons:{},allowCustomClickEvents:!0,enableShortcuts:!1,noBorder:!0},events:a(y).data,onCreate:g[0]||(g[0]=I=>C(I)),onUpdate:g[1]||(g[1]=I=>w(I,!0)),onDelete:g[2]||(g[2]=I=>_(I)),onClick:A,onDblClick:ne,onCellClick:X},{header:K(({currentMonthYear:I,enabledModes:B,activeView:ge,selectedMonthDate:we,decrement:fe,increment:pe,updateActiveView:me,onMonthYearChange:p,setCalendarDate:b})=>[o("div",eo,[o("div",to,[k(a(Xe),{modelValue:we,"onUpdate:modelValue":Q=>p(Q),clearable:!1},{target:K(({togglePopover:Q})=>[k(z,{variant:"ghost",class:"text-lg font-medium text-ink-gray-7",label:I,iconRight:"chevron-down",onClick:Q},null,8,["label","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),o("div",no,[k(z,{onClick:fe,variant:"ghost",icon:"chevron-left"},null,8,["onClick"]),k(z,{label:l.__("Today"),variant:"ghost",onClick:Q=>b()},null,8,["label","onClick"]),k(z,{onClick:pe,variant:"ghost",icon:"chevron-right"},null,8,["onClick"]),k(a(xt),{buttons:B,class:"ml-2",modelValue:ge,"onUpdate:modelValue":Q=>me(Q)},null,8,["buttons","modelValue","onUpdate:modelValue"])])])]),_:1},8,["events"]),o("div",{class:ie(["overflow-hidden flex-none transition-all duration-300 ease-in-out flex flex-col",f.value?"w-[352px] border-l bg-surface-white":"w-0 border-l-0"])},[f.value?(t(),U(Gl,{key:0,ref_key:"eventPanel",ref:j,modelValue:f.value,"onUpdate:modelValue":g[3]||(g[3]=I=>f.value=I),event:s.value,"onUpdate:event":g[4]||(g[4]=I=>s.value=I),mode:E.value,onNew:X,onSave:i,onEdit:ne,onDelete:_,onDuplicate:ve,onDetails:A,onClose:Y,onSync:te},null,8,["modelValue","event","mode"])):H("",!0)],2)])],64)}}};export{xo as default};
//# sourceMappingURL=Calendar-66201856.js.map
